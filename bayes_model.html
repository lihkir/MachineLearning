
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Clasificador Bayesiano &#8212; Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=b4b7a797" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=530fe47d" />
    <link rel="stylesheet" type="text/css" href="_static/.ipynb_checkpoints/custom-checkpoint.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'bayes_model';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/custom.js?v=14184634"></script>
    <script src="_static/.ipynb_checkpoints/custom-checkpoint.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Random Forest y XGBoost" href="decisiontree_model.html" />
    <link rel="prev" title="3. Regresión Ridge y Lasso" href="linear_model.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fotolihki.jpg" class="logo__image only-light" alt="Machine Learning - Home"/>
    <script>document.write(`<img src="_static/fotolihki.jpg" class="logo__image only-dark" alt="Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Profesor: Dr. Lihki Rubio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="supervised_intro.html">1. Aprendizaje supervisado</a></li>
<li class="toctree-l1"><a class="reference internal" href="knn_model.html">2. <span class="math notranslate nohighlight">\(k\)</span>-vecinos más cercanos</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_model.html">3. Regresión Ridge y Lasso</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Clasificador Bayesiano</a></li>
<li class="toctree-l1"><a class="reference internal" href="decisiontree_model.html">5. Random Forest y XGBoost</a></li>
<li class="toctree-l1"><a class="reference internal" href="svm_model.html">6. Máquinas de vectores de soporte</a></li>
<li class="toctree-l1"><a class="reference internal" href="ann_model.html">7. Redes Neuronales y Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="practical_pca.html">8. Análisis de Componentes Principales</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_evaluation.html">9. Evaluación de modelos</a></li>
<li class="toctree-l1"><a class="reference internal" href="chains_pipelines.html">10. Cadenas de Algoritmos y Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">11. Apéndice</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercises_sols.html">12. Soluciones a ejercicios</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">13. Bibliografía</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/bayes_model.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Clasificador Bayesiano</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formulacion">4.1. Formulación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-titanic-dataset">4.2. Aplicación: Titanic Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-de-variables-categoricas">4.3. Codificación de Variables Categóricas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-de-variables-categoricas-onehotencoder-vs-get-dummies-en-machine-learning">4.3.1. Codificación de Variables Categóricas: <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> vs <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> en Machine Learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-get-dummies">4.3.2. <code class="docutils literal notranslate"><span class="pre">pandas.get_dummies</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sklearn-preprocessing-onehotencoder">4.3.3. <code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.OneHotEncoder</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recomendacion-para-validacion-cruzada-con-pipelines">4.3.4. Recomendación para Validación Cruzada con Pipelines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-basico-con-pipeline">4.3.5. Ejemplo Básico con <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">4.3.6. Conclusión</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#onehotencoder-con-gpu-vs-pd-get-dummies">4.3.7. <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> con GPU vs <code class="docutils literal notranslate"><span class="pre">pd.get_dummies</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proyecto-integrador-de-aprendizaje-automatico">4.4. Proyecto Integrador de Aprendizaje Automático</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-enfermedades-cardiacas-con-modelos-bayesianos">4.4.1. Clasificación de enfermedades cardíacas con modelos bayesianos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-general">4.4.1.1. Objetivo general</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#contexto-aplicado">4.4.1.2. Contexto aplicado</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-sugerido">4.4.1.3. Dataset sugerido</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-disponibles-ejemplo">4.4.1.4. Variables disponibles (ejemplo)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tareas">4.4.1.5. Tareas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#restricciones-didacticas">4.4.1.6. Restricciones didácticas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#herramientas-sugeridas">4.4.1.7. Herramientas sugeridas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resultado-esperado">4.4.1.8. Resultado esperado</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#diseno-sugerido-del-notebook">4.4.1.9. Diseño sugerido del notebook</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen">4.4.1.10. Resumen</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="clasificador-bayesiano">
<h1><span class="section-number">4. </span>Clasificador Bayesiano<a class="headerlink" href="#clasificador-bayesiano" title="Link to this heading">#</a></h1>
<div class="admonition-observacion admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p><em><strong>Naive Bayes</strong></em> es una familia de <em><strong>clasificadores similares a los modelos lineales</strong></em>, pero <em><strong>más rápidos en entrenamiento</strong></em>, aunque con <em><strong>menor rendimiento de generalización que LogisticRegression y LinearSVC</strong></em>.</p></li>
<li><p>Son eficientes porque aprenden los parámetros observando cada característica individualmente. <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> ofrece tres variantes:</p>
<ul>
<li><p><strong>GaussianNB</strong> asume que las variables explicativas siguen una distribución normal.</p></li>
<li><p><strong>BernoulliNB</strong> se usa cuando las variables explicativas son binarias (0 o 1).</p></li>
<li><p><strong>MultinomialNB</strong> se aplica cuando las variables explicativas representan conteos enteros (como frecuencia de palabras en texto).</p></li>
</ul>
</li>
<li><p>En <code class="docutils literal notranslate"><span class="pre">BernoulliNB</span></code>, “frecuencia de características distintas de cero” significa que se considera cuántas veces una característica binaria es <strong>1</strong> en cada clase.</p></li>
</ul>
</div>
<section id="formulacion">
<h2><span class="section-number">4.1. </span>Formulación<a class="headerlink" href="#formulacion" title="Link to this heading">#</a></h2>
<p>En la clasificación mediante el <em><strong>enfoque Bayesiano</strong></em>, el concepto básico está plasmado en el <em><strong>Teorema de Bayes</strong></em>. Como ejemplo, <em><strong>supongamos que hemos observado la aparición de un síntoma en un determinado paciente en forma de fiebre y necesitamos evaluar si ha sido causado por un resfriado o por la inﬂuenza</strong></em>. <strong>Si la probabilidad de que un resfriado sea la causa de la fiebre es mayor que la de la inﬂuenza, entonces podemos atribuir, al menos tentativamente, la fiebre de este paciente a un resfriado</strong>.</p>
<p>Este es el concepto subyacente de la <em><strong>clasificación de Bayes</strong></em>. El <em><strong>Teorema de Bayes</strong></em> da la <em><strong>relación entre la probabilidad condicional de un evento basado en la información adquirida</strong></em>, que en este caso puede <em><strong>describirse de la siguiente manera</strong></em></p>
<p>En primer lugar, denotamos la probabilidad de <em><strong>fiebre</strong></em> (<span class="math notranslate nohighlight">\(D\)</span>) como síntoma de un <em><strong>resfriado</strong></em> (<span class="math notranslate nohighlight">\(G1\)</span> ) y de la <em><strong>inﬂuenza</strong></em> (<span class="math notranslate nohighlight">\(G2\)</span>) por</p>
<div class="math notranslate nohighlight">
\[
P(D|G_{1})=\frac{P(D\cap G_{1})}{P(G_{1})},\quad P(D|G_{2})=\frac{P(D\cap G_{2})}{P(G_{2})},
\]</div>
<p>respectivamente. <span class="math notranslate nohighlight">\(P(D|G_{1})\)</span> y <span class="math notranslate nohighlight">\(P(D|G_{2})\)</span> representan las <em><strong>probabilidades de que la fiebre sea el resultado de un resfriado y de la inﬂuenza, respectivamente, y se denominan probabilidades condicionales</strong></em>. Aquí, <span class="math notranslate nohighlight">\(P(G_{1})\)</span> y <span class="math notranslate nohighlight">\(P(G_{2})\)</span> <span class="math notranslate nohighlight">\((P(G_{1})+P(G_{2}) =
1)\)</span>, son las <em><strong>incidencias relativas de los resfriados y la inﬂuenza</strong></em>, y se denominan probabilidades a priori. Se supone que estas <em><strong>probabilidades condicionales y a priori pueden estimarse a partir de las observaciones y de la información acumulada</strong></em>. Entonces la probabilidad <span class="math notranslate nohighlight">\(P(D)\)</span> viene dada por</p>
<div class="math notranslate nohighlight" id="equation-eq-prob-total">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-eq-prob-total" title="Link to this equation">#</a></span>\[
P(D)=P(G_{1})P(D|G_{1})+P(G_{2})P(D|G_{2}),
\]</div>
<p>la <em><strong>probabilidad de que la fiebre sea el resultado de un resfriado o de la inﬂuenza</strong></em>, llamada la ley de la <em><strong>probabilidad total</strong></em>.</p>
<p>En nuestro ejemplo, <em><strong>queremos conocer las probabilidades de que la fiebre que se ha producido, haya sido causada por un resfriado o por la inﬂuenza, respectivamente, representadas por las probabilidades condicionales</strong></em> <span class="math notranslate nohighlight">\(P(G_{1}|D)\)</span> y <span class="math notranslate nohighlight">\(P(G_{2}|D)\)</span>. El <em><strong>Teorema de Bayes</strong></em> proporciona estas probabilidades sobre la base de las probabilidades concocidas a priori <span class="math notranslate nohighlight">\(P(G_{i})\)</span> y las probabilidades condicionales <span class="math notranslate nohighlight">\(P(D|G_{i})\)</span>. Es decir, las <em><strong>probabilidades condicionales</strong></em> <span class="math notranslate nohighlight">\(P(G_{i}|D)\)</span> vienen dadas por</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
P(G_{i}|D)&amp;=\frac{P(G_{i}\cap D)}{P(D)}\\
&amp;=\frac{P(G_{i})P(D|G_{i})}{P(G_{1})P(D|G_{1})+P(G_{1})P(D|G_{2})},\quad i=1,2,
\end{align*}
\end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\(P(D)\)</span> es la <em><strong>probabilidad total</strong></em> Ecuación <a class="reference internal" href="#equation-eq-prob-total">(4.1)</a>. Tras la aparición del resultado <span class="math notranslate nohighlight">\(D\)</span>, las probabilidades condicionales <span class="math notranslate nohighlight">\(P(G_{i}|D)\)</span> se convierten en <em><strong>probabilidades posteriores</strong></em>. En general, el <em><strong>Teorema de Bayes</strong></em> se formula como sigue.</p>
<div class="proof theorem admonition" id="bayes_theorem">
<p class="admonition-title"><span class="caption-number">Theorem 4.1 </span> (Teorema de Bayes)</p>
<section class="theorem-content" id="proof-content">
<p>Suponga que el espacio muestral <span class="math notranslate nohighlight">\(\Omega\)</span> es divido en <span class="math notranslate nohighlight">\(r\)</span> <em><strong>eventos mutuamente disyuntos</strong></em> <span class="math notranslate nohighlight">\(G_{j}\)</span> como <span class="math notranslate nohighlight">\(\Omega=G_{1}\cup G_{2}\cup\cdots\cup G_{r}~(G_{i}\cap G_{j}=\emptyset)\)</span>. Entonces, para cualquier evento <span class="math notranslate nohighlight">\(D\)</span>, la <em><strong>probabilidad condicional</strong></em> <span class="math notranslate nohighlight">\(P(G_{i}|D)\)</span> esta dada por</p>
<div class="math notranslate nohighlight" id="equation-eq-bayes-theorem">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-eq-bayes-theorem" title="Link to this equation">#</a></span>\[
P(G_{i}|D)=\frac{P(G_{i}\cap D)}{P(D)}=\frac{P(G_{i})P(D|G_{i})}{\displaystyle{\sum_{j=1}^{r}P(G_{j})P(D|G_{j})}},~i=1,2,\dots,r,
\]</div>
<p>donde <span class="math notranslate nohighlight">\(~\displaystyle{\sum_{j=1}^{r}P(G_{j})=1}\)</span>.</p>
</section>
</div><p>En esta sección, el propósito es realizar <em><strong>clasificación para la asignación de clases de datos</strong></em> <span class="math notranslate nohighlight">\(p\)</span><em><strong>-dimensionales recién observados, basándose en la probabilidad posterior de su pertenencia a cada clase</strong></em>. Discutimos la aplicación del <em><strong>Teorema de Bayes</strong></em> y la expresión de la probabilidad posterior mediante un modelo de de probabilidad, y el método de formulación de <em><strong>análisis discriminante y cuadrático</strong></em>, para la asignación de clases.</p>
<div class="admonition-distribuciones-de-probabilidad-y-verosimilitud admonition">
<p class="admonition-title">Distribuciones de probabilidad y verosimilitud</p>
<p>Supongamos que tenemos <span class="math notranslate nohighlight">\(n_{1}\)</span> datos <span class="math notranslate nohighlight">\(p\)</span>-dimensionales de la clase <span class="math notranslate nohighlight">\(G_{1}\)</span> y <span class="math notranslate nohighlight">\(n_{2}\)</span> datos <span class="math notranslate nohighlight">\(p\)</span>-dimensionales de la clase <span class="math notranslate nohighlight">\(G_{2}\)</span>, y representamos el total <span class="math notranslate nohighlight">\(n=(n_{1}+n_{2})\)</span> <em><strong>datos de entrenamiento</strong></em> como</p>
<div class="math notranslate nohighlight">
\[
G_{1}:~\boldsymbol{x}_{1}^{(1)}, \boldsymbol{x}_{2}^{(1)},\dots, \boldsymbol{x}_{n_{1}}^{(1)},\quad G_{2}:~\boldsymbol{x}_{1}^{(2)}, \boldsymbol{x}_{2}^{(2)},\dots, \boldsymbol{x}_{n_{2}}^{(2)}
\]</div>
<p>Supongamos que los datos de entrenamiento para las clases <span class="math notranslate nohighlight">\(G_{i}~(i=1,2)\)</span> han sido <em><strong>observados de acuerdo a una distribución normal</strong></em> <span class="math notranslate nohighlight">\(p\)</span>-dimensional <span class="math notranslate nohighlight">\(N_{p}(\boldsymbol{\mu}_{i},\Sigma_{i})\)</span> con vector de medias <span class="math notranslate nohighlight">\(\boldsymbol{\mu}_{i}\)</span> y matrices de varianza-covarianza <span class="math notranslate nohighlight">\(\Sigma_{i}\)</span> como sigue:</p>
<div class="math notranslate nohighlight" id="equation-eq-mean-cov-bayes">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-eq-mean-cov-bayes" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
G_{1}&amp;: N_{p}(\boldsymbol{\mu}_{1}, \Sigma_{1})\sim\boldsymbol{x}_{1}^{(1)},\boldsymbol{x}_{2}^{(1)},\dots, \boldsymbol{x}_{n_{1}}^{(1)},\\
G_{2}&amp;: N_{p}(\boldsymbol{\mu}_{2}, \Sigma_{2})\sim\boldsymbol{x}_{1}^{(2)},\boldsymbol{x}_{2}^{(2)},\dots, \boldsymbol{x}_{n_{2}}^{(1)}.
\end{align*}
\end{split}\]</div>
<p>Dado este tipo de modelo de distribución de probabilidad, entonces, si suponemos que cierto dato <span class="math notranslate nohighlight">\(\boldsymbol{x}_{0}\)</span> pertenece a la clase <span class="math notranslate nohighlight">\(G_{1}\)</span> o <span class="math notranslate nohighlight">\(G_{2}\)</span>, el <em><strong>nivel relativo de ocurrencia</strong></em> de ese dato en cada clase (la <em><strong>verosimilitud</strong></em> o grado de certeza) puede ser cuantificado por <span class="math notranslate nohighlight">\(f(\boldsymbol{x}_{0}|\boldsymbol{\mu}_{i},\Sigma_{i})\)</span>, usando la <em><strong>distribución normal</strong></em> <span class="math notranslate nohighlight">\(p\)</span><em><strong>-dimensional</strong></em>. Esta corresponde a la probabilidad condicional <span class="math notranslate nohighlight">\(P(D|G_{i})\)</span> descrita por el <em><strong>Teorema de Bayes</strong></em> y puede ser denominada la <em><strong>verosimilitud</strong></em> del dato <span class="math notranslate nohighlight">\(\boldsymbol{x}_{0}\)</span>.</p>
</div>
<p>Por ejemplo, consideremos una observación, extraida de una distribución normal <span class="math notranslate nohighlight">\(N(170, 6^2)\)</span> asociada con <em><strong>alturas de hombres</strong></em>. Entonces, usando la función de densidad de probabilidad, el <em><strong>nivel relativo de ocurrencia de hombres de 178 cm de altura</strong></em>, puede ser determinado como <span class="math notranslate nohighlight">\(f(178|170, 6^2)\)</span> (ver <a class="reference internal" href="#fig-heights-bayes"><span class="std std-numref">Fig. 4.1</span></a>).</p>
<figure class="align-center" id="fig-heights-bayes">
<a class="reference internal image-reference" href="_images/heights_bayes.png"><img alt="_images/heights_bayes.png" src="_images/heights_bayes.png" style="width: 405.20000000000005px; height: 310.8px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Nivel relativo de ocurrencia <span class="math notranslate nohighlight">\(f(178|170, 6^{2})\)</span>. Fuente <span id="id1">[<a class="reference internal" href="biblio.html#id20" title="S. Konishi. Introduction to Multivariate Analysis: Linear and Nonlinear Modeling. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis, 2014. ISBN 9781466567283. URL: https://books.google.com.co/books?id=fcuuAwAAQBAJ.">Konishi, 2014</a>]</span>.</span><a class="headerlink" href="#fig-heights-bayes" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Para obtener los datos de verosimilitud, reemplazamos los <em><strong>parametros desconocidos</strong></em>, <span class="math notranslate nohighlight">\(\boldsymbol{\mu}_{i}\)</span> y <span class="math notranslate nohighlight">\(\Sigma_{i}\)</span> en Eq. <a class="reference internal" href="#equation-eq-mean-cov-bayes">(4.3)</a> con sus respectivas <em><strong>estimaciones de máxima verosimilitud</strong></em></p>
<div class="math notranslate nohighlight">
\[
\overline{\boldsymbol{x}}_{i}=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\boldsymbol{x}_{j}^{(i)},\quad
S_{i}=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}(\boldsymbol{x}_{j}^{(i)}-\overline{\boldsymbol{x}}_{i})(\boldsymbol{x}_{j}^{(i)}-\overline{\boldsymbol{x}}_{i})^{T},\quad i=1,2,
\]</div>
<p>respectivamente. Aplicando el <em><strong>Teorema de Bayes</strong></em> y utilizando la probabilidad posterior, expresada como una distribución de probabilidad, formulamos la <em><strong>clasificación Bayesiana</strong></em> y derivamos las <em><strong>funciones de discriminación cuadrática y lineal, para la asignación de clases</strong></em>.</p>
<div class="admonition-funciones-discriminantes admonition">
<p class="admonition-title">Funciones discriminantes</p>
<p>El proposito esencial del <strong>análisis discriminante</strong> es <em><strong>construir una regla de clasificación basada en datos de entrenamiento, y predecir la pertenencia de datos futuros</strong></em> <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> <em><strong>a dos o mas clases predeterminadas</strong></em>.</p>
</div>
<p>Pongamos ahora esto en un <em><strong>marco Bayesiano</strong></em> considerando las dos clases <span class="math notranslate nohighlight">\(G_{1}\)</span> y <span class="math notranslate nohighlight">\(G_{2}\)</span>. Nuestro objetivo es obtener la <em><strong>probabilidad posterior</strong></em> <span class="math notranslate nohighlight">\(P(G_{i}|D) = P(G_{i}|x)\)</span> cuando el dato <span class="math notranslate nohighlight">\(D = \{x\}\)</span> es observado. Para ello, aplicamos el <em><strong>Teorema de Bayes</strong></em> para obtener la probabilidad posterior, y <em><strong>asignamos los datos futuros</strong></em> <span class="math notranslate nohighlight">\(x\)</span> <em><strong>a la clase con la probabilidad más alta</strong></em>. Así, realizamos una <em><strong>clasificación Bayesiana</strong></em> basada en la <em><strong>razón de las probabilidades posteriores</strong></em></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{P(G_{1}|\boldsymbol{x})}{P(G_{2}|\boldsymbol{x})}\quad
\begin{cases}
\geq 1 &amp; \Rightarrow~\boldsymbol{x}\in G_{1}\\
&lt; 1 &amp; \Rightarrow~\boldsymbol{x}\in G_{2}.
\end{cases}
\end{split}\]</div>
<p>Tomando <em><strong>logaritmo</strong></em> en ambos lados obtenemos</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\log\frac{P(G_{1}|\boldsymbol{x})}{P(G_{2}|\boldsymbol{x})}\quad
\begin{cases}
\geq 0 &amp; \Rightarrow~\boldsymbol{x}\in G_{1}\\
&lt; 0 &amp; \Rightarrow~\boldsymbol{x}\in G_{2}.
\end{cases}
\end{split}\]</div>
<p>Por el <em><strong>Teorema de Bayes</strong></em> Eq. <a class="reference internal" href="#equation-eq-bayes-theorem">(4.2)</a>, las probabilidades posteriores están dadas por</p>
<div class="math notranslate nohighlight" id="equation-eq-bayes-normal">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-eq-bayes-normal" title="Link to this equation">#</a></span>\[
P(G_{i}|\boldsymbol{x})=\frac{P(G_{i})P(\boldsymbol{x}|G_{i})}{P(G_{1})P(\boldsymbol{x}|G_{1})+P(G_{1})P(\boldsymbol{x}|G_{2})},\quad i=1,2.
\]</div>
<p>Usando las <em><strong>distribuciones normales</strong></em> <span class="math notranslate nohighlight">\(p\)</span><em><strong>-dimensionales estimadas</strong></em> <span class="math notranslate nohighlight">\(f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{i}, S_{i})~(i=1,2)\)</span>, la <em><strong>probabilidad condicional</strong></em> puede ser escrita como</p>
<div class="math notranslate nohighlight">
\[
P(\boldsymbol{x}|G_{i})=\frac{f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{i}, S_{i})}{f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{1}, S_{1})+f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{2}, S_{2})},\quad i=1,2,
\]</div>
<p>(ver <a class="reference internal" href="#fig-bayes-normal"><span class="std std-numref">Fig. 4.2</span></a>) representación del <em><strong>nivel relativo de ocurrencia</strong></em>.</p>
<figure class="align-center" id="fig-bayes-normal">
<a class="reference internal image-reference" href="_images/bayes_normal.png"><img alt="_images/bayes_normal.png" src="_images/bayes_normal.png" style="width: 394.0px; height: 303.6px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text"><span class="math notranslate nohighlight">\(P(\boldsymbol{x}|G_{i})\)</span>. Nivel relativo de ocurrencia del dato <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> en cada clase. Fuente <span id="id2">[<a class="reference internal" href="biblio.html#id20" title="S. Konishi. Introduction to Multivariate Analysis: Linear and Nonlinear Modeling. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis, 2014. ISBN 9781466567283. URL: https://books.google.com.co/books?id=fcuuAwAAQBAJ.">Konishi, 2014</a>]</span>.</span><a class="headerlink" href="#fig-bayes-normal" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Sustituyendo estas ecuaciones en <a class="reference internal" href="#equation-eq-bayes-normal">(4.4)</a>, el radio de <em><strong>probabilidades posteriores</strong></em> es expresado como</p>
<div class="math notranslate nohighlight">
\[
\frac{P(G_1 \mid \mathbf{x})}{P(G_2 \mid \mathbf{x})} = \frac{\displaystyle{\frac{P(G_1) P(\mathbf{x} \mid G_1)}{P(\mathbf{x})}}}{\displaystyle{\frac{P(G_2) P(\mathbf{x} \mid G_2)}{P(\mathbf{x})}}} = \frac{P(G_1) P(\mathbf{x} \mid G_1)}{P(G_2) P(\mathbf{x} \mid G_2)}
\]</div>
<p>Como se <strong>asume que las clases <span class="math notranslate nohighlight">\(G_1\)</span> y <span class="math notranslate nohighlight">\(G_2\)</span> siguen una distribución normal multivariada</strong> con media estimada <span class="math notranslate nohighlight">\(\bar{\mathbf{x}}_i\)</span> y covarianza estimada <span class="math notranslate nohighlight">\(S_i\)</span>, entonces <span class="math notranslate nohighlight">\(P(\mathbf{x} \mid G_i) = f(\mathbf{x} \mid \bar{\mathbf{x}}_i, S_i)\)</span>. Por lo tanto</p>
<div class="math notranslate nohighlight">
\[
\frac{P(G_1) P(\mathbf{x} \mid G_1)}{P(G_2) P(\mathbf{x} \mid G_2)} = \frac{P(G_1) f(\mathbf{x} \mid \bar{\mathbf{x}}_1, S_1)}{P(G_2) f(\mathbf{x} \mid \bar{\mathbf{x}}_2, S_2)}
\]</div>
<p><em><strong>Tomando el logaritmo</strong></em> de esta expresión, <em><strong>bajo el supuesto de que las probabilidades a priori son iguales</strong></em>, obtenemos la <em><strong>clasificación Bayesiana</strong></em> basada en la distribución de probabilidad</p>
<div class="math notranslate nohighlight" id="equation-bayes-class-rule">
<span class="eqno">(4.5)<a class="headerlink" href="#equation-bayes-class-rule" title="Link to this equation">#</a></span>\[\begin{split}
h(\boldsymbol{x})=\log\frac{f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{1}, S_{1})}{f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{2}, S_{2})}\quad
\begin{cases}
\geq 0 &amp;\Rightarrow~\boldsymbol{x}\in G_{1}\\
&lt; 0 &amp;\Rightarrow~\boldsymbol{x}\in G_{2}
\end{cases}
\end{split}\]</div>
<p>Dada la <em><strong>distribución normal</strong></em> <span class="math notranslate nohighlight">\(p-\)</span>dimensional estimada <span class="math notranslate nohighlight">\(N_{p}(\overline{\boldsymbol{x}}_{i}, S_{i})~(i=1,2)\)</span>, se tiene que:</p>
<div class="math notranslate nohighlight">
\[
f(\boldsymbol{x}|\boldsymbol{x}_{i}, S_{i})=\frac{1}{(2\pi)^{p/2}|S_{i}|^{1/2}}\exp\left[-\frac{1}{2}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{i})^{T}S_{i}^{-1}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{i})\right]
\]</div>
<p>Entonces, la <em><strong>función discriminante</strong></em> <span class="math notranslate nohighlight">\(h(\boldsymbol{x})\)</span> esta dada por:</p>
<div class="math notranslate nohighlight" id="equation-quad-disc-eq">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-quad-disc-eq" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
h(\boldsymbol{x})&amp;=\log f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{1}, S_{1})-\log f(\boldsymbol{x}|\overline{\boldsymbol{x}}_{2}, S_{2})\\[2mm]
&amp;=\log\left\{\left[(2\pi)^{p}|S_{1}|\right]^{-1/2}\right\}+\log\left\{\exp\left[-\frac{1}{2}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{1})^{T}S_{1}^{-1}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{1})\right]\right\}\\
&amp;-\log\left\{\left[(2\pi)^{p}|S_{2}|\right]^{-1/2}\right\}-\log\left\{\exp\left[-\frac{1}{2}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{2})^{T}S_{2}^{-1}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{2})\right]\right\}\\
&amp;=\frac{1}{2}\left\{(\boldsymbol{x}-\overline{\boldsymbol{x}}_{2})^{T}S_{2}^{-1}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{2})-(\boldsymbol{x}-\overline{\boldsymbol{x}}_{1})^{T}S_{1}^{-1}(\boldsymbol{x}-\overline{\boldsymbol{x}}_{1})-\log\left(\frac{|S_{1}|}{|S_{2}|}\right)\right\}.
\end{align*}
\end{split}\]</div>
<p>La función <span class="math notranslate nohighlight">\(h(\boldsymbol{x})\)</span> de la Eq. <a class="reference internal" href="#equation-quad-disc-eq">(4.6)</a> es conocida como <em><strong>función discriminante cuadratica</strong></em>. Reemplazando <span class="math notranslate nohighlight">\(S_{i}\)</span> con la <em><strong>matriz de varianza-covarianza de la muestra conjunta</strong></em> <span class="math notranslate nohighlight">\(S=(n_{1}S_{1}+n_{2}S_{2})/(n_{1}+n_{2})\)</span>, la función discriminante es además reducida a la <em><strong>función discriminante lineal</strong></em> (<em>verifíquelo</em>)</p>
<div class="math notranslate nohighlight">
\[
h(\mathbf{x}) = \frac{1}{2}(\mathbf{x} - \mathbf{x}_2)^T S^{-1} (\mathbf{x} - \mathbf{x}_2) - \frac{1}{2}(\mathbf{x} - \mathbf{x}_1)^T S^{-1} (\mathbf{x} - \mathbf{x}_1)
\]</div>
<p>Expandamos cada término:</p>
<div class="math notranslate nohighlight">
\[
(\mathbf{x} - \mathbf{x}_2)^T S^{-1} (\mathbf{x} - \mathbf{x}_2) =
\mathbf{x}^T S^{-1} \mathbf{x} - 2 \mathbf{x}_2^T S^{-1} \mathbf{x} + \mathbf{x}_2^T S^{-1} \mathbf{x}_2
\]</div>
<div class="math notranslate nohighlight">
\[
(\mathbf{x} - \mathbf{x}_1)^T S^{-1} (\mathbf{x} - \mathbf{x}_1) =
\mathbf{x}^T S^{-1} \mathbf{x} - 2 \mathbf{x}_1^T S^{-1} \mathbf{x} + \mathbf{x}_1^T S^{-1} \mathbf{x}_1
\]</div>
<p>Sustituyendo en la función discriminante dentro de la resta:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
h(\mathbf{x}) &amp;= \frac{1}{2} \left( \mathbf{x}^T S^{-1} \mathbf{x} - 2 \mathbf{x}_2^T S^{-1} \mathbf{x} + \mathbf{x}_2^T S^{-1} \mathbf{x}_2 \right) \\
&amp;\quad - \frac{1}{2} \left( \mathbf{x}^T S^{-1} \mathbf{x} - 2 \mathbf{x}_1^T S^{-1} \mathbf{x} + \mathbf{x}_1^T S^{-1} \mathbf{x}_1 \right)
\end{aligned}
\end{split}\]</div>
<p>Los términos <span class="math notranslate nohighlight">\(\mathbf{x}^T S^{-1} \mathbf{x}\)</span> se cancelan entre sí, ya que aparecen con el mismo signo y factor. Entonces queda:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
h(\mathbf{x}) &amp;= \frac{1}{2} \left( -2 \mathbf{x}_2^T S^{-1} \mathbf{x} + \mathbf{x}_2^T S^{-1} \mathbf{x}_2 
+ 2 \mathbf{x}_1^T S^{-1} \mathbf{x} - \mathbf{x}_1^T S^{-1} \mathbf{x}_1 \right) \\
&amp;= \left( \mathbf{x}_1^T S^{-1} - \mathbf{x}_2^T S^{-1} \right) \mathbf{x} + \frac{1}{2} \left( \mathbf{x}_2^T S^{-1} \mathbf{x}_2 - \mathbf{x}_1^T S^{-1} \mathbf{x}_1 \right)
\end{aligned}
\end{split}\]</div>
<p>La expresión anterior se puede reescribir como:</p>
<div class="math notranslate nohighlight">
\[
h(\mathbf{x}) = \mathbf{w}^T \mathbf{x} + w_0
\]</div>
<p>donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{w} = S^{-1} (\mathbf{x}_1 - \mathbf{x}_2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(w_0 = \frac{1}{2} \left( \mathbf{x}_2^T S^{-1} \mathbf{x}_2 - \mathbf{x}_1^T S^{-1} \mathbf{x}_1 \right)\)</span></p></li>
</ul>
<p>Por lo tanto,</p>
<div class="math notranslate nohighlight">
\[
h(\mathbf{x}) = (\mathbf{x}_1 - \mathbf{x}_2)^T S^{-1} \mathbf{x} - \frac{1}{2} \left( \mathbf{x}_1^T S^{-1} \mathbf{x}_1 - \mathbf{x}_2^T S^{-1} \mathbf{x}_2 \right).
\]</div>
<p>De esta forma, obtenemos la <em><strong>regla de clasificación de Bayes</strong></em> <a class="reference internal" href="#equation-bayes-class-rule">(4.5)</a> basada en el <em><strong>signo del logaritmo de la razón entre la distribución de probabilidad estimada que caracteriza la clase</strong></em>. La función <span class="math notranslate nohighlight">\(h(\boldsymbol{x})\)</span> expresada por la distribución normal <span class="math notranslate nohighlight">\(p\)</span>-dimensional entrega las <em><strong>funciones discriminantes, lineales y cuadráticas</strong></em>.</p>
</section>
<section id="aplicacion-titanic-dataset">
<h2><span class="section-number">4.2. </span>Aplicación: Titanic Dataset<a class="headerlink" href="#aplicacion-titanic-dataset" title="Link to this heading">#</a></h2>
<figure class="align-center" id="titanic-pic-fig">
<img alt="_images/titanic_pic.jpeg" src="_images/titanic_pic.jpeg" />
</figure>
<ul class="simple">
<li><p>El <em><strong>Titanic</strong></em>, barco británico de la <em><strong>White Star Line</strong></em>, se hundió en el <em><strong>Atlántico Norte el 15 de abril de 1912</strong></em> después de <em><strong>golpear un iceberg</strong></em> en su <em><strong>viaje de Southampton a Nueva York</strong></em>. A bordo había <em><strong>2,224 personas</strong></em>, incluyendo pasajeros y tripulación, y <em><strong>1,514 murieron</strong></em>.</p></li>
<li><p>El Titanic tenía <em><strong>16 botes salvavidas de madera y cuatro plegables, suficientes para solo 1,178 personas</strong></em>, un tercio de su capacidad total y el <em><strong>53% de los pasajeros reales</strong></em>. En ese momento, <em><strong>los botes salvavidas se usaban para trasladar a los sobrevivientes a otros barcos</strong></em>, no para mantener a flote o llevar a todos a la costa.</p></li>
<li><p>La pregunta principal es <strong><code class="docutils literal notranslate"><span class="pre">¿quiénes</span> <span class="pre">tenían</span> <span class="pre">más</span> <span class="pre">probabilidades</span> <span class="pre">de</span> <span class="pre">sobrevivir</span> <span class="pre">en</span> <span class="pre">esta</span> <span class="pre">tragedia?</span></code></strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span><span class="p">,</span> <span class="n">BernoulliNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/train_titanic.csv&#39;</span><span class="p">)</span>
<span class="n">test_data</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/test_titanic.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">]</span>
<span class="n">all_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All data shape: &#39;</span><span class="p">,</span> <span class="n">all_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">all_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All data shape:  (1309, 12)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.0</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.0</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><strong>Análisis Exploratorio de Datos (EDA)</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>3</td>
      <td>Kelly, Mr. James</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>3</td>
      <td>Wilkes, Mrs. James (Ellen Needs)</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>2</td>
      <td>Myles, Mr. Thomas Francis</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>3</td>
      <td>Wirz, Mr. Albert</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>3</td>
      <td>Hirvonen, Mrs. Alexander (Helga E Lindqvist)</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 418 entries, 0 to 417
Data columns (total 11 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  418 non-null    int64  
 1   Pclass       418 non-null    int64  
 2   Name         418 non-null    object 
 3   Sex          418 non-null    object 
 4   Age          332 non-null    float64
 5   SibSp        418 non-null    int64  
 6   Parch        418 non-null    int64  
 7   Ticket       418 non-null    object 
 8   Fare         417 non-null    float64
 9   Cabin        91 non-null     object 
 10  Embarked     418 non-null    object 
dtypes: float64(2), int64(4), object(5)
memory usage: 36.0+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>418.000000</td>
      <td>418.000000</td>
      <td>332.000000</td>
      <td>418.000000</td>
      <td>418.000000</td>
      <td>417.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1100.500000</td>
      <td>2.265550</td>
      <td>30.272590</td>
      <td>0.447368</td>
      <td>0.392344</td>
      <td>35.627188</td>
    </tr>
    <tr>
      <th>std</th>
      <td>120.810458</td>
      <td>0.841838</td>
      <td>14.181209</td>
      <td>0.896760</td>
      <td>0.981429</td>
      <td>55.907576</td>
    </tr>
    <tr>
      <th>min</th>
      <td>892.000000</td>
      <td>1.000000</td>
      <td>0.170000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>996.250000</td>
      <td>1.000000</td>
      <td>21.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.895800</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1100.500000</td>
      <td>3.000000</td>
      <td>27.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1204.750000</td>
      <td>3.000000</td>
      <td>39.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1309.000000</td>
      <td>3.000000</td>
      <td>76.000000</td>
      <td>8.000000</td>
      <td>9.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Identifiquemos si existen <code class="docutils literal notranslate"><span class="pre">datos</span> <span class="pre">faltantes</span> <span class="pre">en</span> <span class="pre">el</span> <span class="pre">dataset</span></code>. Antes, veamos una breve descripción de cada variable</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">PassengerId</span></code>: identificador único</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Survived</span></code>: 0=No, 1=Yes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pclass</span></code>: Clase de tiquete. <em>1 = 1st: Upper,  2 = 2nd: Middle,  3 = 3rd: Lower</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Name</span></code>: nombre completo con un título</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sex</span></code>: genero</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Age</span></code>: la edad es una fracción si es inferior a 1. Si la edad es estimada, es en forma de xx.5</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sibsp</span></code>: número de hermanos / cónyuges a bordo del Titanic. El conjunto de datos define las relaciones familiares de esta manera:</p>
<ul>
<li><p>Sibling = hermano, hermana, hermanastro, hermanastra</p></li>
<li><p>Spouse = marido, mujer (se ignoraba a las amantes y prometidas)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Parch</span></code>: Número de padres / hijos a bordo del Titanic. El conjunto de datos define las relaciones familiares de esta manera:</p>
<ul>
<li><p>Parent = madre, padre</p></li>
<li><p>Child =  hija, hijo, hijastra, hijastro</p></li>
<li><p>Algunos niños viajaban sólo con niñera, por lo que <code class="docutils literal notranslate"><span class="pre">parch=0</span></code> para ellos.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Ticket</span></code>: número del tiquete</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fare</span></code>: tarifa del pasajero</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cabin</span></code>: numero de cabina</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Embarked</span></code>: puerto de embarque</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Comprobamos si hay datos faltantes, <code class="docutils literal notranslate"><span class="pre">NA</span> <span class="pre">en</span> <span class="pre">el</span> <span class="pre">conjunto</span> <span class="pre">de</span> <span class="pre">datos</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_data_NA</span> <span class="o">=</span> <span class="n">all_data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">train_NA</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">test_NA</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_NA</span><span class="p">,</span> <span class="n">test_NA</span><span class="p">,</span> <span class="n">all_data_NA</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Train NA&#39;</span><span class="p">,</span> <span class="s1">&#39;Test NA&#39;</span><span class="p">,</span> <span class="s1">&#39;All NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Train NA</th>
      <th>Test NA</th>
      <th>All NA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PassengerId</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Survived</th>
      <td>0</td>
      <td>NaN</td>
      <td>418</td>
    </tr>
    <tr>
      <th>Pclass</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Name</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Sex</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Age</th>
      <td>177</td>
      <td>86.0</td>
      <td>263</td>
    </tr>
    <tr>
      <th>SibSp</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Parch</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Ticket</th>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Fare</th>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cabin</th>
      <td>687</td>
      <td>327.0</td>
      <td>1014</td>
    </tr>
    <tr>
      <th>Embarked</th>
      <td>2</td>
      <td>0.0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>En total faltan <strong>263 valores de Edad, 1 de Tarifa, 1014 NA en la variable Cabina y 2 en la variable Embarcado</strong>. <strong>418 NA en la variable Survived</strong> debido a la <strong>ausencia de esta información en el conjunto de datos de prueba</strong>.</p></li>
<li><p>En este ejemplo, no imputaremos estas pérdidas. Técnicas de imputación de datos serán estudiadas en el curso <code class="docutils literal notranslate"><span class="pre">Visualización</span> <span class="pre">de</span> <span class="pre">Datos</span> <span class="pre">para</span> <span class="pre">la</span> <span class="pre">Toma</span> <span class="pre">de</span> <span class="pre">Decisiones</span></code>.</p></li>
</ul>
<ul class="simple">
<li><p>Calculemos y visualicemos la <code class="docutils literal notranslate"><span class="pre">distribución</span> <span class="pre">de</span> <span class="pre">nuestra</span> <span class="pre">variable</span> <span class="pre">objetivo</span></code>: <code class="docutils literal notranslate"><span class="pre">'Survived'</span></code>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived
0.0    549
1.0    342
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;drowned&#39;</span><span class="p">,</span> <span class="s1">&#39;survived&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Overall survival (training dataset)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Passenger status after the tragedy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of passengers&#39;</span><span class="p">);</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/643b21f6def103581edac289b33459b9df67b84b915c74ec37fd087857aedb7b.png" src="_images/643b21f6def103581edac289b33459b9df67b84b915c74ec37fd087857aedb7b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Survived
0.0    0.616162
1.0    0.383838
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Tenemos <code class="docutils literal notranslate"><span class="pre">891</span> <span class="pre">pasajeros</span> <span class="pre">en</span> <span class="pre">el</span> <span class="pre">conjunto</span> <span class="pre">de</span> <span class="pre">datos,</span> <span class="pre">549</span> <span class="pre">(61,6%)</span> <span class="pre">de</span> <span class="pre">ellos</span> <span class="pre">se</span> <span class="pre">ahogaron</span> <span class="pre">y</span> <span class="pre">sólo</span> <span class="pre">342</span> <span class="pre">(38,4%)</span> <span class="pre">sobrevivieron</span></code>. Pero sabemos que los <code class="docutils literal notranslate"><span class="pre">botes</span> <span class="pre">salvavidas</span> <span class="pre">podían</span> <span class="pre">transportar</span> <span class="pre">al</span> <span class="pre">53%</span> <span class="pre">del</span> <span class="pre">total</span> <span class="pre">de</span> <span class="pre">pasajeros</span></code>. Veamos la <code class="docutils literal notranslate"><span class="pre">distribución</span> <span class="pre">de</span> <span class="pre">las</span> <span class="pre">edades</span></code>. Usamos para estimar la distribución de probabilidad el método no paramétrico KDE (ver <a class="reference external" href="https://en.wikipedia.org/wiki/Kernel_density_estimation#Further_reading">Kernel density estimation
</a>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">all_data</span><span class="p">[(</span><span class="n">all_data</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">Age</span><span class="p">,</span> <span class="n">kde_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lw&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distrubution of passengers age (all data)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/378da6a8ed013c518acf4623f3a1ff678234755d2a0da64775f6a3457908f448.png" src="_images/378da6a8ed013c518acf4623f3a1ff678234755d2a0da64775f6a3457908f448.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age_distr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="n">age_distr</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Age</th>
      <td>1046.0</td>
      <td>29.881138</td>
      <td>14.413493</td>
      <td>0.17</td>
      <td>21.0</td>
      <td>28.0</td>
      <td>39.0</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>La distribución de la <code class="docutils literal notranslate"><span class="pre">edad</span> <span class="pre">está</span> <span class="pre">ligeramente</span> <span class="pre">sesgada</span> <span class="pre">a</span> <span class="pre">la</span> <span class="pre">derecha</span></code>. La edad <code class="docutils literal notranslate"><span class="pre">varía</span> <span class="pre">entre</span> <span class="pre">0.17</span> <span class="pre">y</span> <span class="pre">80</span> <span class="pre">años</span></code>, con una <code class="docutils literal notranslate"><span class="pre">media</span> <span class="pre">=</span> <span class="pre">29.88</span></code>. <code class="docutils literal notranslate"><span class="pre">¿Influyó</span> <span class="pre">mucho</span> <span class="pre">la</span> <span class="pre">edad</span> <span class="pre">en</span> <span class="pre">las</span> <span class="pre">posibilidades</span> <span class="pre">de</span> <span class="pre">sobrevivir?</span></code> Visualizamos dos distribuciones de edad, agrupadas por estatus de supervivencia.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">],</span> <span class="n">fliersize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">],</span> <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;drowned&#39;</span><span class="p">,</span> <span class="s1">&#39;survived&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Age distribution grouped by surviving status (train data)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Passenger status after the tragedy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/feb5b351102ef9db0347fd5e8847c958895409f2cdd81a0ddf6d843eb37c4865.png" src="_images/feb5b351102ef9db0347fd5e8847c958895409f2cdd81a0ddf6d843eb37c4865.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Survived&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>424.0</td>
      <td>30.626179</td>
      <td>14.172110</td>
      <td>1.00</td>
      <td>21.0</td>
      <td>28.0</td>
      <td>39.0</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>290.0</td>
      <td>28.343690</td>
      <td>14.950952</td>
      <td>0.42</td>
      <td>19.0</td>
      <td>28.0</td>
      <td>36.0</td>
      <td>80.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>La media de edad de los <code class="docutils literal notranslate"><span class="pre">pasajeros</span> <span class="pre">supervivientes</span> <span class="pre">es</span> <span class="pre">de</span> <span class="pre">28,34</span> <span class="pre">años,</span> <span class="pre">2,28</span> <span class="pre">menos</span> <span class="pre">que</span> <span class="pre">la</span> <span class="pre">media</span> <span class="pre">de</span> <span class="pre">edad</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">pasajeros</span> <span class="pre">ahogados</span></code> (los únicos de los que conocemos su estado de supervivencia). La <code class="docutils literal notranslate"><span class="pre">edad</span> <span class="pre">mínima</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">pasajeros</span> <span class="pre">ahogados</span> <span class="pre">es</span> <span class="pre">de</span> <span class="pre">1</span> <span class="pre">año,</span> <span class="pre">lo</span> <span class="pre">que</span> <span class="pre">es</span> <span class="pre">muy</span> <span class="pre">triste</span></code>. La <code class="docutils literal notranslate"><span class="pre">edad</span> <span class="pre">máxima</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">pasajeros</span> <span class="pre">ahogados</span> <span class="pre">es</span> <span class="pre">de</span> <span class="pre">80</span> <span class="pre">años</span></code>. Verifiquemos si existe un error.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_data</span><span class="p">[</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>630</th>
      <td>631</td>
      <td>1.0</td>
      <td>1</td>
      <td>Barkworth, Mr. Algernon Henry Wilson</td>
      <td>male</td>
      <td>80.0</td>
      <td>0</td>
      <td>0</td>
      <td>27042</td>
      <td>30.0</td>
      <td>A23</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Sr.</span> <span class="pre">Algernon</span> <span class="pre">Henry</span> <span class="pre">Barkworth</span> <span class="pre">nació</span> <span class="pre">el</span> <span class="pre">4</span> <span class="pre">de</span> <span class="pre">junio</span> <span class="pre">de</span> <span class="pre">1864</span></code>, tenía <strong>48 años en 1912</strong> y <code class="docutils literal notranslate"><span class="pre">murió</span> <span class="pre">en</span> <span class="pre">1945</span> <span class="pre">a</span> <span class="pre">los</span> <span class="pre">80</span> <span class="pre">años</span></code> (ver <a class="reference external" href="https://www.wikitree.com/wiki/Barkworth-2">Algernon Henry Wilson Barkworth (1864 - 1945)</a>).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">631</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">48</span>
<span class="n">all_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">631</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">48</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Survived&#39;</span><span class="p">)[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>424.0</td>
      <td>30.626179</td>
      <td>14.172110</td>
      <td>1.00</td>
      <td>21.0</td>
      <td>28.0</td>
      <td>39.0</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>290.0</td>
      <td>28.233345</td>
      <td>14.684091</td>
      <td>0.42</td>
      <td>19.0</td>
      <td>28.0</td>
      <td>36.0</td>
      <td>63.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>La <code class="docutils literal notranslate"><span class="pre">media</span> <span class="pre">de</span> <span class="pre">edad</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">pasajeros</span> <span class="pre">supervivientes</span> <span class="pre">es</span> <span class="pre">de</span> <span class="pre">28,23</span> <span class="pre">años</span></code>, <code class="docutils literal notranslate"><span class="pre">2,39</span> <span class="pre">menos</span> <span class="pre">que</span> <span class="pre">la</span> <span class="pre">media</span> <span class="pre">de</span> <span class="pre">edad</span> <span class="pre">de</span> <span class="pre">los</span> <span class="pre">pasajeros</span> <span class="pre">ahogados</span></code>(los únicos de los que conocemos el estado de supervivencia). Parece que <code class="docutils literal notranslate"><span class="pre">hay</span> <span class="pre">más</span> <span class="pre">posibilidades</span> <span class="pre">de</span> <span class="pre">sobrevivir</span> <span class="pre">para</span> <span class="pre">los</span> <span class="pre">jóvenes</span></code>.</p></li>
</ul>
<ul class="simple">
<li><p>Podemos ahora, verificar cuantos <code class="docutils literal notranslate"><span class="pre">pasajeros</span> <span class="pre">existen</span> <span class="pre">por</span> <span class="pre">cada</span> <span class="pre">clase</span> <span class="pre">(Pclass)</span></code>, y además, identificar frecuencia y proporción de ahogados, por cada una de las tres clases</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">],</span> <span class="n">palette</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#eed4d0&#39;</span><span class="p">,</span> <span class="s1">&#39;#cda0aa&#39;</span><span class="p">,</span> <span class="s1">&#39;#a2708e&#39;</span><span class="p">],</span> 
                   <span class="n">order</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">all_data</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Passengers distribution by family size&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of passengers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">all_data</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">],</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;No. Survived/drowned passengers by class&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of passengers&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span> <span class="s1">&#39;Drowned&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.04</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">all_data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Pclass&#39;</span><span class="p">)[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Proportion of survived/drowned passengers by class&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span> <span class="s1">&#39;Drowned&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.04</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f842568175750205ca0b232ea001dc59f064c51a152d27543b8b88c5321c05fb.png" src="_images/f842568175750205ca0b232ea001dc59f064c51a152d27543b8b88c5321c05fb.png" />
</div>
</div>
<ul class="simple">
<li><p>El <code class="docutils literal notranslate"><span class="pre">Titanic</span></code> tenía <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">puntos</span> <span class="pre">de</span> <span class="pre">embarque</span></code> antes de que el buque iniciara su <code class="docutils literal notranslate"><span class="pre">ruta</span> <span class="pre">hacia</span> <span class="pre">Nueva</span> <span class="pre">York</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Southampton</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cherbourg</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Queenstown</span></code></p></li>
</ul>
</li>
</ul>
<figure class="align-center" id="embarkation-map-fig">
<img alt="_images/embarkation_map.jpeg" src="_images/embarkation_map.jpeg" />
</figure>
<figure class="align-center" id="titanic-sank-fig">
<img alt="_images/titanic_sank.jpg" src="_images/titanic_sank.jpg" />
</figure>
<ul class="simple">
<li><p>Este análisis explotario se puede extender aún mas, y estudiar por ejemplo, <em>ditribución de pasajeros por títulos, ubicación de las cabinas en el barco, tamaño de las familias, cantidad de pasajeros por clase, genero</em> entre otros. Queda como <em><strong>ejercicio para el estudiante, extender el análisis de cada uno de estos casos</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Creamos <em><strong>dos nuevos dataframe, df_train_ml y df_test_ml</strong></em> sólo tendrán <em><strong>características ordinales</strong></em> y no tendrán <em><strong>datos faltantes</strong></em>. Para que puedan ser <em><strong>utilizados por los algoritmos de ML</strong></em>, realizamos <em><strong>conversión de categórico a numérico mediante pd.get_dummies</strong></em> <em><strong>eliminando todas las características que no parezcan útiles para la predicción</strong></em>. A continuación, utilizamos el <em><strong>escalador estándar</strong></em> y aplicamos la división <em><strong>train/test</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span> <span class="o">=</span> <span class="n">train_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_test_ml</span>  <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_train_ml</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>1</td>
      <td>male</td>
      <td>54.0</td>
      <td>0</td>
      <td>0</td>
      <td>51.8625</td>
      <td>S</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>2.0</td>
      <td>3</td>
      <td>1</td>
      <td>21.0750</td>
      <td>S</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>27.0</td>
      <td>0</td>
      <td>2</td>
      <td>11.1333</td>
      <td>S</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>2</td>
      <td>female</td>
      <td>14.0</td>
      <td>1</td>
      <td>0</td>
      <td>30.0708</td>
      <td>C</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>16.7000</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_ml</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_test_ml</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_ml</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>7.8292</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.0000</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>9.6875</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.6625</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>12.2875</td>
      <td>S</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>male</td>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
      <td>9.2250</td>
      <td>S</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>female</td>
      <td>30.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.6292</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>male</td>
      <td>26.0</td>
      <td>1</td>
      <td>1</td>
      <td>29.0000</td>
      <td>S</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>female</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.2292</td>
      <td>C</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3</td>
      <td>male</td>
      <td>21.0</td>
      <td>2</td>
      <td>0</td>
      <td>24.1500</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Con el objetivo de evitar (<em><strong>dummy variable trap</strong></em>), <em><strong>eliminamos la primera columna</strong></em> (<em>puede ser cualquier otra</em>).</p></li>
</ul>
<div class="tip dropdown admonition">
<p class="admonition-title">Dummy variable trap</p>
<ul class="simple">
<li><p>La <em><strong>trampa de la variable dummy</strong></em> es un escenario en el que hay <em><strong>atributos que están muy correlacionados</strong></em> (multicolineales) y <em><strong>una variable predice el valor de otras</strong></em>. Cuando utilizamos la codificación de una sola variable para tratar los datos categóricos, <em><strong>una variable dummy (atributo) puede predecirse con la ayuda de otras variables dummy</strong></em>.</p></li>
<li><p>La <em><strong>utilización de todas las variables dummies en modelos de ML conduce a una trampa de variables dummy</strong></em>. Por lo tanto, los modelos de ML deben diseñarse para <em><strong>excluir una variable dummy</strong></em>.</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">,</span> <span class="s1">&#39;Pclass&#39;</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_train_ml</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_train_ml</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Sex_male</th>
      <th>Embarked_Q</th>
      <th>Embarked_S</th>
      <th>Pclass_2</th>
      <th>Pclass_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>54.0</td>
      <td>0</td>
      <td>0</td>
      <td>51.8625</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0</td>
      <td>2.0</td>
      <td>3</td>
      <td>1</td>
      <td>21.0750</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>27.0</td>
      <td>0</td>
      <td>2</td>
      <td>11.1333</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>14.0</td>
      <td>1</td>
      <td>0</td>
      <td>30.0708</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>4.0</td>
      <td>1</td>
      <td>1</td>
      <td>16.7000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_test_ml</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_columns</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_test_ml</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_ml</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>Sex_male</th>
      <th>Embarked_Q</th>
      <th>Embarked_S</th>
      <th>Pclass_2</th>
      <th>Pclass_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>7.8292</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.0000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>9.6875</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.6625</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>12.2875</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>14.0</td>
      <td>0</td>
      <td>0</td>
      <td>9.2250</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>30.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.6292</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>26.0</td>
      <td>1</td>
      <td>1</td>
      <td>29.0000</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.2292</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>21.0</td>
      <td>2</td>
      <td>0</td>
      <td>24.1500</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_ml</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 712 entries, 0 to 890
Data columns (total 10 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   Survived    712 non-null    int64  
 1   Age         712 non-null    float64
 2   SibSp       712 non-null    int64  
 3   Parch       712 non-null    int64  
 4   Fare        712 non-null    float64
 5   Sex_male    712 non-null    int64  
 6   Embarked_Q  712 non-null    int64  
 7   Embarked_S  712 non-null    int64  
 8   Pclass_2    712 non-null    int64  
 9   Pclass_3    712 non-null    int64  
dtypes: float64(2), int64(8)
memory usage: 61.2 KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test_ml</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 331 entries, 0 to 415
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   Age         331 non-null    float64
 1   SibSp       331 non-null    int64  
 2   Parch       331 non-null    int64  
 3   Fare        331 non-null    float64
 4   Sex_male    331 non-null    int64  
 5   Embarked_Q  331 non-null    int64  
 6   Embarked_S  331 non-null    int64  
 7   Pclass_2    331 non-null    int64  
 8   Pclass_3    331 non-null    int64  
dtypes: float64(2), int64(7)
memory usage: 25.9 KB
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Calculemos ahora <code class="docutils literal notranslate"><span class="pre">matriz</span> <span class="pre">de</span> <span class="pre">correlación</span></code>, para el conjunto de entrenamiento <code class="docutils literal notranslate"><span class="pre">df_train_ml</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">df_train_ml</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">1.5</span> <span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;.2f&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b491d1043db1e724ad51c5deb4525a2e3d4b944cfe108108aa5f6f9f21102447.png" src="_images/b491d1043db1e724ad51c5deb4525a2e3d4b944cfe108108aa5f6f9f21102447.png" />
</div>
</div>
<ul class="simple">
<li><p>Dividimos nuestro dataset <code class="docutils literal notranslate"><span class="pre">df_train_ml</span></code> en, conjunto de entrenamiento y de prueba. Posteriormente, <strong>escalamos la partición de entrenamiento</strong> usando <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">StandardScaler</a>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df_train_ml</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Survived&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_train_ml</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.7757
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_sc</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_sc</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_sc</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6588785046728972
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code></strong> Es el modelo recomendado para este problema, por las siguientes razones:</p>
<ul>
<li><p>Úsalo cuando <strong>tienes variables numéricas continuas</strong>, como <code class="docutils literal notranslate"><span class="pre">Age</span></code>, <code class="docutils literal notranslate"><span class="pre">Fare</span></code>.</p></li>
<li><p>Funciona bien con mezclas de variables numéricas y discretas.</p></li>
<li><p>Las variables categóricas deben ser convertidas (por ejemplo, con <code class="docutils literal notranslate"><span class="pre">OneHotEncoding</span></code> o <code class="docutils literal notranslate"><span class="pre">LabelEncoding</span></code>).</p></li>
<li><p>Es <strong>el más adecuado</strong> para el dataset Titanic después de preprocesar.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s1">&#39;clf&#39;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.7757
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_sc</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GaussianNB()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">GaussianNB</label><div class="sk-toggleable__content"><pre>GaussianNB()</pre></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test_sc</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_sc</span><span class="p">)</span>
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7757009345794392
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">accuracy_score</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/train_titanic.csv&#39;</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticket&#39;</span><span class="p">,</span> <span class="s1">&#39;Cabin&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Survived&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span>

<span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Embarked&quot;</span><span class="p">,</span> <span class="s2">&quot;Pclass&quot;</span><span class="p">]</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span> <span class="s2">&quot;SibSp&quot;</span><span class="p">,</span> <span class="s2">&quot;Parch&quot;</span><span class="p">,</span> <span class="s2">&quot;Fare&quot;</span><span class="p">]</span>

<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span><span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">,</span> <span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="n">categorical_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numerical_cols</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;preprocessing&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="n">GaussianNB</span><span class="p">())</span>
<span class="p">])</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>

<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor precisión en validación cruzada: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor modelo: </span><span class="si">{</span><span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reporte de clasificación sobre datos de entrenamiento:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor precisión en validación cruzada: 0.8059
Mejor modelo: Pipeline(steps=[(&#39;preprocessing&#39;,
                 ColumnTransformer(transformers=[(&#39;cat&#39;,
                                                  OneHotEncoder(drop=&#39;first&#39;,
                                                                handle_unknown=&#39;ignore&#39;),
                                                  [&#39;Sex&#39;, &#39;Embarked&#39;,
                                                   &#39;Pclass&#39;]),
                                                 (&#39;num&#39;, StandardScaler(),
                                                  [&#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;,
                                                   &#39;Fare&#39;])])),
                (&#39;classifier&#39;, GaussianNB())])

Reporte de clasificación sobre datos de entrenamiento:
              precision    recall  f1-score   support

           0       0.80      0.85      0.83       424
           1       0.76      0.69      0.72       288

    accuracy                           0.79       712
   macro avg       0.78      0.77      0.77       712
weighted avg       0.78      0.79      0.78       712
</pre></div>
</div>
</div>
</div>
</section>
<section id="codificacion-de-variables-categoricas">
<h2><span class="section-number">4.3. </span>Codificación de Variables Categóricas<a class="headerlink" href="#codificacion-de-variables-categoricas" title="Link to this heading">#</a></h2>
<section id="codificacion-de-variables-categoricas-onehotencoder-vs-get-dummies-en-machine-learning">
<h3><span class="section-number">4.3.1. </span>Codificación de Variables Categóricas: <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> vs <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> en Machine Learning<a class="headerlink" href="#codificacion-de-variables-categoricas-onehotencoder-vs-get-dummies-en-machine-learning" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>En los modelos de <em>Machine Learning</em>, es común encontrarse con variables categóricas, las cuales deben transformarse en valores numéricos antes de ser utilizadas por los algoritmos de aprendizaje. Una de las estrategias más utilizadas para ello es la <strong>codificación one-hot</strong>, que convierte cada categoría en una columna binaria. <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> y <code class="docutils literal notranslate"><span class="pre">pandas</span></code> ofrecen dos formas populares de realizar esta transformación:</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> (de <code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> (de <code class="docutils literal notranslate"><span class="pre">pandas</span></code>)</p></li>
</ul>
<ul class="simple">
<li><p>A continuación, se describen ambos enfoques, sus diferencias y recomendaciones para su uso en el contexto de validación cruzada y pipelines.</p></li>
</ul>
</section>
<section id="pandas-get-dummies">
<h3><span class="section-number">4.3.2. </span><code class="docutils literal notranslate"><span class="pre">pandas.get_dummies</span></code><a class="headerlink" href="#pandas-get-dummies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>La función <code class="docutils literal notranslate"><span class="pre">get_dummies()</span></code> de <code class="docutils literal notranslate"><span class="pre">pandas</span></code> realiza una codificación one-hot de manera simple y directa. *<em>Cada categoría de una variable se transforma en una columna con valores 0 o 1. Es útil para análisis exploratorio</em> o modelos simples que no requieren un flujo automatizado.</p></li>
<li><p><strong>Ventajas:</strong></p></li>
</ul>
<ul class="simple">
<li><p>Sencillo de aplicar.</p></li>
<li><p>Integra automáticamente las columnas generadas en el mismo <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p></li>
</ul>
<p><strong>Desventajas:</strong></p>
<ul class="simple">
<li><p>No se integra fácilmente con pipelines de <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code>.</p></li>
<li><p>No guarda información sobre las categorías aprendidas durante el ajuste, lo que puede generar errores si aparecen nuevas categorías en datos futuros.</p></li>
</ul>
</section>
<section id="sklearn-preprocessing-onehotencoder">
<h3><span class="section-number">4.3.3. </span><code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.OneHotEncoder</span></code><a class="headerlink" href="#sklearn-preprocessing-onehotencoder" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> es una clase de <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> que permite realizar la misma transformación, pero de forma más controlada y compatible con flujos de trabajo avanzados como los pipelines y la validación cruzada.</p></li>
</ul>
<p><strong>Ventajas:</strong></p>
<ul class="simple">
<li><p>Compatible con <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> y <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>.</p></li>
<li><p>Permite configurar qué hacer con categorías desconocidas (<code class="docutils literal notranslate"><span class="pre">handle_unknown='ignore'</span></code>).</p></li>
<li><p>Aprende las categorías durante el ajuste (<code class="docutils literal notranslate"><span class="pre">fit</span></code>) y las reutiliza en el proceso de predicción (<code class="docutils literal notranslate"><span class="pre">transform</span></code>).</p></li>
<li><p>Ideal para procesos reproducibles y despliegue en producción.</p></li>
</ul>
<p><strong>Desventajas:</strong></p>
<ul class="simple">
<li><p>Requiere pasos adicionales para integrarse al flujo de datos (por ejemplo, seleccionar columnas específicas).</p></li>
</ul>
</section>
<section id="recomendacion-para-validacion-cruzada-con-pipelines">
<h3><span class="section-number">4.3.4. </span>Recomendación para Validación Cruzada con Pipelines<a class="headerlink" href="#recomendacion-para-validacion-cruzada-con-pipelines" title="Link to this heading">#</a></h3>
<p>Cuando se trabaja con <strong>validación cruzada</strong>, es fundamental que <strong>la transformación de las variables categóricas esté incluida dentro del pipeline</strong>. Esto garantiza que <strong>no haya fuga de datos</strong> entre los conjuntos de entrenamiento y validación. Por esta razón, se recomienda utilizar: <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> junto con <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> y <code class="docutils literal notranslate"><span class="pre">ColumnTransformer</span></code>. Este enfoque permite mantener un flujo completo y seguro del preprocesamiento, evitando fugas de información y facilitando la automatización del modelo.</p>
</section>
<section id="ejemplo-basico-con-pipeline">
<h3><span class="section-number">4.3.5. </span>Ejemplo Básico con <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code><a class="headerlink" href="#ejemplo-basico-con-pipeline" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># Variables numéricas y categóricas</span>
<span class="n">num_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Fare&#39;</span><span class="p">]</span>
<span class="n">cat_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="s1">&#39;Embarked&#39;</span><span class="p">]</span>

<span class="c1"># Preprocesamiento</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">num_vars</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">),</span> <span class="n">cat_vars</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Pipeline completo</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;preprocessing&#39;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="n">RandomForestClassifier</span><span class="p">())</span>
<span class="p">])</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h3><span class="section-number">4.3.6. </span>Conclusión<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Para modelos productivos, reproducibles y validados correctamente mediante <em>cross-validation</em>, se recomienda preferir <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> sobre <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code>. Aunque <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> es útil en etapas exploratorias, no garantiza la integridad del flujo de datos en esquemas complejos.</p></li>
</ul>
</section>
<section id="onehotencoder-con-gpu-vs-pd-get-dummies">
<h3><span class="section-number">4.3.7. </span><code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> con GPU vs <code class="docutils literal notranslate"><span class="pre">pd.get_dummies</span></code><a class="headerlink" href="#onehotencoder-con-gpu-vs-pd-get-dummies" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Label1&#39;</span><span class="p">,</span> <span class="s1">&#39;Label4&#39;</span><span class="p">,</span> <span class="s1">&#39;Label2&#39;</span><span class="p">,</span> <span class="s1">&#39;Label2&#39;</span><span class="p">,</span> <span class="s1">&#39;Label1&#39;</span><span class="p">,</span> <span class="s1">&#39;Label3&#39;</span><span class="p">,</span> <span class="s1">&#39;Label3&#39;</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Label1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Label4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Label2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Label2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Label1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Label3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Label3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0.]
 [0. 0. 0. 1.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [1. 0. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&#39;Label1&#39;]
 [&#39;Label4&#39;]
 [&#39;Label2&#39;]
 [&#39;Label2&#39;]
 [&#39;Label1&#39;]
 [&#39;Label3&#39;]
 [&#39;Label3&#39;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label_Label1</th>
      <th>label_Label2</th>
      <th>label_Label3</th>
      <th>label_Label4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label_Label2</th>
      <th>label_Label3</th>
      <th>label_Label4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&#39;Label1&#39;],
       [&#39;Label4&#39;],
       [&#39;Label2&#39;],
       [&#39;Label2&#39;],
       [&#39;Label1&#39;],
       [&#39;Label3&#39;],
       [&#39;Label3&#39;]], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">argmax</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-08 12:58:58.127877: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-08-08 12:58:58.813544: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-08-08 12:58:58.813642: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-08-08 12:58:58.921612: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-08-08 12:58:59.132198: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-08-08 12:59:00.366004: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 3 1 1 0 2 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoded</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0.]
 [0. 0. 0. 1.]
 [0. 1. 0. 0.]
 [0. 1. 0. 0.]
 [1. 0. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 1. 0.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">inverted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inverted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 3 1 1 0 2 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">le</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">inverted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Label1&#39;, &#39;Label4&#39;, &#39;Label2&#39;, &#39;Label2&#39;, &#39;Label1&#39;, &#39;Label3&#39;,
       &#39;Label3&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>A partir del gráfico KDE de <em>Age</em>, se observa una distribución aproximadamente normal, lo que sugiere que el modelo <strong>GaussianNB</strong> podría ser adecuado. Este se emplea principalmente con datos de alta dimensión, mientras que <strong>MultinomialNB</strong> y <strong>BernoulliNB</strong> son más comunes en datos de texto dispersos. Entre ellos, <em>MultinomialNB</em> suele superar a <em>BernoulliNB</em> cuando hay muchas características no nulas.</p></li>
<li><p>Los modelos bayesianos, al igual que los modelos lineales, destacan por su <strong>rapidez en entrenamiento y predicción</strong>, facilidad de interpretación y <strong>buen rendimiento con datos dispersos de alta dimensión</strong>. Además, son <strong>robustos a los hiperparámetros</strong> y resultan especialmente útiles en <strong>conjuntos de datos muy grandes</strong>, donde entrenar modelos más complejos puede ser computacionalmente costoso.</p></li>
</ul>
</div>
</section>
</section>
<section id="proyecto-integrador-de-aprendizaje-automatico">
<h2><span class="section-number">4.4. </span>Proyecto Integrador de Aprendizaje Automático<a class="headerlink" href="#proyecto-integrador-de-aprendizaje-automatico" title="Link to this heading">#</a></h2>
<section id="clasificacion-de-enfermedades-cardiacas-con-modelos-bayesianos">
<h3><span class="section-number">4.4.1. </span>Clasificación de enfermedades cardíacas con modelos bayesianos<a class="headerlink" href="#clasificacion-de-enfermedades-cardiacas-con-modelos-bayesianos" title="Link to this heading">#</a></h3>
<section id="objetivo-general">
<h4><span class="section-number">4.4.1.1. </span>Objetivo general<a class="headerlink" href="#objetivo-general" title="Link to this heading">#</a></h4>
<p>Aplicar un modelo supervisado de clasificación basado en la <strong>probabilidad bayesiana</strong> (<code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code>) para predecir la <strong>presencia o ausencia de enfermedad cardíaca</strong> en pacientes a partir de indicadores clínicos. El objetivo es:</p>
<ol class="arabic simple">
<li><p>Construir un pipeline de preprocesamiento y clasificación usando <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code>.</p></li>
<li><p>Evaluar el desempeño del modelo usando métricas estándar y visualizaciones.</p></li>
<li><p>Analizar el impacto de cada variable en la predicción desde la perspectiva probabilística.</p></li>
</ol>
</section>
<section id="contexto-aplicado">
<h4><span class="section-number">4.4.1.2. </span>Contexto aplicado<a class="headerlink" href="#contexto-aplicado" title="Link to this heading">#</a></h4>
<p>Los sistemas de salud buscan modelos interpretables para apoyar el diagnóstico temprano de enfermedades. Uno de los problemas más frecuentes es el diagnóstico de enfermedad cardíaca, donde se tienen múltiples mediciones clínicas, y se requiere estimar el riesgo de forma transparente. Los clasificadores bayesianos son una herramienta adecuada por su rapidez, simplicidad e interpretabilidad.</p>
</section>
<section id="dataset-sugerido">
<h4><span class="section-number">4.4.1.3. </span>Dataset sugerido<a class="headerlink" href="#dataset-sugerido" title="Link to this heading">#</a></h4>
<p><strong>Heart Disease UCI Dataset</strong></p>
<ul class="simple">
<li><p>Fuente: UCI Machine Learning Repository</p></li>
<li><p>Registros: 303 pacientes</p></li>
<li><p>Enlace: <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Heart+Disease">https://archive.ics.uci.edu/ml/datasets/Heart+Disease</a></p></li>
</ul>
</section>
<section id="variables-disponibles-ejemplo">
<h4><span class="section-number">4.4.1.4. </span>Variables disponibles (ejemplo)<a class="headerlink" href="#variables-disponibles-ejemplo" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Tipo</p></th>
<th class="head"><p>Variables principales</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Demográficas</p></td>
<td><p>Edad, sexo</p></td>
</tr>
<tr class="row-odd"><td><p>Clínicas</p></td>
<td><p>Presión arterial, colesterol, frecuencia cardíaca máxima</p></td>
</tr>
<tr class="row-even"><td><p>Síntomas</p></td>
<td><p>Dolor torácico, angina inducida por ejercicio, nivel de azúcar en sangre</p></td>
</tr>
<tr class="row-odd"><td><p>Diagnóstico</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">target</span></code> (1 = enfermedad presente, 0 = ausencia de enfermedad)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="tareas">
<h4><span class="section-number">4.4.1.5. </span>Tareas<a class="headerlink" href="#tareas" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Preprocesamiento</strong></p>
<ul class="simple">
<li><p>Limpieza de valores faltantes o codificación de valores especiales</p></li>
<li><p>Codificación de variables categóricas (<code class="docutils literal notranslate"><span class="pre">ChestPain</span></code>, <code class="docutils literal notranslate"><span class="pre">Thal</span></code>, etc.)</p></li>
<li><p>Escalado si se combina con otras técnicas comparativas</p></li>
<li><p>División de datos con <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code></p></li>
</ul>
</li>
<li><p><strong>Modelado</strong></p>
<ul class="simple">
<li><p>Implementar un <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> con preprocesamiento y <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code></p></li>
<li><p>(Opcional) Comparar con <code class="docutils literal notranslate"><span class="pre">BernoulliNB</span></code> o <code class="docutils literal notranslate"><span class="pre">MultinomialNB</span></code> si hay discretización</p></li>
<li><p>Realizar validación cruzada para estimar la robustez del clasificador</p></li>
</ul>
</li>
<li><p><strong>Evaluación</strong></p>
<ul class="simple">
<li><p>Métricas: matriz de confusión, accuracy, precision, recall, F1-score</p></li>
<li><p>Curva ROC y cálculo de AUC</p></li>
<li><p>Gráficos de distribución de predicciones y probabilidad condicional</p></li>
<li><p>Comparar desempeño con otros clasificadores si se desea (por ejemplo <code class="docutils literal notranslate"><span class="pre">LogisticRegression</span></code>)</p></li>
</ul>
</li>
<li><p><strong>Análisis y reporte</strong></p>
<ul class="simple">
<li><p>Analizar cuáles variables son más relevantes según su efecto en las probabilidades</p></li>
<li><p>Discutir fortalezas y limitaciones del modelo bayesiano (asunción de independencia)</p></li>
<li><p>Reflexión sobre interpretabilidad y aplicabilidad médica</p></li>
</ul>
</li>
</ol>
</section>
<section id="restricciones-didacticas">
<h4><span class="section-number">4.4.1.6. </span>Restricciones didácticas<a class="headerlink" href="#restricciones-didacticas" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Se debe usar <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> de <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code></p></li>
<li><p>No se permite el uso de GridSearchCV (ya que GaussianNB no tiene hiperparámetros principales)</p></li>
<li><p>El trabajo debe estar documentado, reproducible y visualmente explicado</p></li>
<li><p>Se debe justificar el uso del modelo bayesiano en el contexto médico</p></li>
</ul>
</section>
<section id="herramientas-sugeridas">
<h4><span class="section-number">4.4.1.7. </span>Herramientas sugeridas<a class="headerlink" href="#herramientas-sugeridas" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>, <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">seaborn</span></code></p></li>
<li><p>Jupyter Notebook o Google Colab</p></li>
</ul>
</section>
<section id="resultado-esperado">
<h4><span class="section-number">4.4.1.8. </span>Resultado esperado<a class="headerlink" href="#resultado-esperado" title="Link to this heading">#</a></h4>
<p>Un cuaderno de trabajo completo que incluya:</p>
<ul class="simple">
<li><p>Preprocesamiento y exploración de los datos</p></li>
<li><p>Implementación del clasificador bayesiano con <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></p></li>
<li><p>Evaluación del modelo con métricas apropiadas</p></li>
<li><p>Análisis crítico de resultados y visualizaciones</p></li>
<li><p>Conclusiones orientadas a aplicaciones médicas o clínicas</p></li>
</ul>
</section>
<section id="diseno-sugerido-del-notebook">
<h4><span class="section-number">4.4.1.9. </span>Diseño sugerido del notebook<a class="headerlink" href="#diseno-sugerido-del-notebook" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p>Carga y análisis exploratorio del dataset</p></li>
<li><p>Preprocesamiento y codificación</p></li>
<li><p>Definición del pipeline con <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code></p></li>
<li><p>Evaluación de resultados y visualizaciones</p></li>
<li><p>Reflexión crítica y conclusiones</p></li>
</ol>
</section>
<section id="resumen">
<h4><span class="section-number">4.4.1.10. </span>Resumen<a class="headerlink" href="#resumen" title="Link to this heading">#</a></h4>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Tarea</p></th>
<th class="head"><p>Tamaño</p></th>
<th class="head"><p>Ventajas clave</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UCI Heart Disease</p></td>
<td><p>Clasificación</p></td>
<td><p>303</p></td>
<td><p>Real, médico, ideal para modelos interpretables</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "tf"
        },
        kernelOptions: {
            name: "tf",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'tf'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="linear_model.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Regresión Ridge y Lasso</p>
      </div>
    </a>
    <a class="right-next"
       href="decisiontree_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Random Forest y XGBoost</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formulacion">4.1. Formulación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-titanic-dataset">4.2. Aplicación: Titanic Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-de-variables-categoricas">4.3. Codificación de Variables Categóricas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-de-variables-categoricas-onehotencoder-vs-get-dummies-en-machine-learning">4.3.1. Codificación de Variables Categóricas: <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> vs <code class="docutils literal notranslate"><span class="pre">get_dummies</span></code> en Machine Learning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-get-dummies">4.3.2. <code class="docutils literal notranslate"><span class="pre">pandas.get_dummies</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sklearn-preprocessing-onehotencoder">4.3.3. <code class="docutils literal notranslate"><span class="pre">sklearn.preprocessing.OneHotEncoder</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recomendacion-para-validacion-cruzada-con-pipelines">4.3.4. Recomendación para Validación Cruzada con Pipelines</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-basico-con-pipeline">4.3.5. Ejemplo Básico con <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">4.3.6. Conclusión</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#onehotencoder-con-gpu-vs-pd-get-dummies">4.3.7. <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> con GPU vs <code class="docutils literal notranslate"><span class="pre">pd.get_dummies</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proyecto-integrador-de-aprendizaje-automatico">4.4. Proyecto Integrador de Aprendizaje Automático</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-enfermedades-cardiacas-con-modelos-bayesianos">4.4.1. Clasificación de enfermedades cardíacas con modelos bayesianos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-general">4.4.1.1. Objetivo general</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#contexto-aplicado">4.4.1.2. Contexto aplicado</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-sugerido">4.4.1.3. Dataset sugerido</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-disponibles-ejemplo">4.4.1.4. Variables disponibles (ejemplo)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tareas">4.4.1.5. Tareas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#restricciones-didacticas">4.4.1.6. Restricciones didácticas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#herramientas-sugeridas">4.4.1.7. Herramientas sugeridas</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resultado-esperado">4.4.1.8. Resultado esperado</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#diseno-sugerido-del-notebook">4.4.1.9. Diseño sugerido del notebook</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen">4.4.1.10. Resumen</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lihki Rubio, Ph.D.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>Lihki Rubio, Ph.D. All rights reserved.</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>