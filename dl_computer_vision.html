
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Deep Learning para Visión por Computadora &#8212; Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=530fe47d" />
    <link rel="stylesheet" type="text/css" href="_static/.ipynb_checkpoints/custom-checkpoint.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dl_computer_vision';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/custom.js?v=14184634"></script>
    <script src="_static/.ipynb_checkpoints/custom-checkpoint.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Análisis de Componentes Principales" href="practical_pca.html" />
    <link rel="prev" title="Redes Neuronales y Deep Learning" href="ann_model.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fotolihki.jpg" class="logo__image only-light" alt="Machine Learning - Home"/>
    <script>document.write(`<img src="_static/fotolihki.jpg" class="logo__image only-dark" alt="Machine Learning - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Profesor: Dr. Lihki Rubio
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="supervised_intro.html">Aprendizaje supervisado</a></li>
<li class="toctree-l1"><a class="reference internal" href="knn_model.html"><span class="math notranslate nohighlight">\(k\)</span>-vecinos más cercanos</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear_model.html">Regresión Ridge y Lasso</a></li>
<li class="toctree-l1"><a class="reference internal" href="bayes_model.html">Clasificador Bayesiano</a></li>
<li class="toctree-l1"><a class="reference internal" href="decisiontree_model.html">Random Forest y XGBoost</a></li>

<li class="toctree-l1"><a class="reference internal" href="svm_model.html">Máquinas de vectores de soporte</a></li>
<li class="toctree-l1"><a class="reference internal" href="ann_model.html">Redes Neuronales y Deep Learning</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Deep Learning para Visión por Computadora</a></li>




<li class="toctree-l1"><a class="reference internal" href="practical_pca.html">Análisis de Componentes Principales</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_evaluation.html">Evaluación de modelos</a></li>
<li class="toctree-l1"><a class="reference internal" href="chains_pipelines.html">Cadenas de Algoritmos y Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Apéndice</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">Bibliografía</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/dl_computer_vision.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Deep Learning para Visión por Computadora</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Deep Learning para Visión por Computadora</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion">Clasificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-o-localizacion-y-segmentacion">Detección o localización y segmentación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aprendizaje-de-similitud">Aprendizaje de Similitud</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#etiquetado-de-imagenes">Etiquetado de imágenes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-generativos">Modelos Generativos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-video">Análisis de Video</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-instalacion-de-paquetes-de-software">La instalación de paquetes de software</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-imagenes">Clasificación de imagenes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-del-modelo-mnist-en-tensorflow">Entrenamiento del modelo <code class="docutils literal notranslate"><span class="pre">MNIST</span></code> en <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#las-bases-de-datos-mnist">Las bases de datos <code class="docutils literal notranslate"><span class="pre">MNIST</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-los-datos-mnist">Carga de los datos <code class="docutils literal notranslate"><span class="pre">MNIST</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamentos-de-vision-por-computadora">Fundamentos de Visión por Computadora</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-bordes-mediante-el-uso-de-hashing-de-imagenes-y-filtrado">Detección de bordes mediante el uso de hashing de imágenes y filtrado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-uso-de-un-filtro-bayer-para-la-formacion-de-patrones-de-color">El uso de un filtro Bayer para la formación de patrones de color</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creando-vector-de-imagen">Creando Vector de Imagen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformaciones-geometricas">Transformaciones geométricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#traslacion">Traslación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#escalado">Escalado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotacion">Rotación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-homogenea">Transformación Homogénea</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convolucion-2d-y-filtro-lineal">Convolución 2D y Filtro Lineal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizado-de-imagen">Suavizado de imagen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtros-lineales">Filtros Lineales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-filtro-kernel">El filtro Kernel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-del-filtro">Aplicación del Filtro</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-gaussiano">Filtro Gaussiano</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-de-la-mediana">Filtro de la mediana</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrado-de-imagenes-con-opencv">Filtrado de imágenes con OpenCV</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-bordes-basada-en-gradientes">Detección de bordes basada en gradientes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivadas-parciales-y-el-gradiente">Derivadas Parciales y el Gradiente</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivadas-direccionales-y-mascaras-2d">Derivadas Direccionales y Máscaras 2D</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extraccion-de-caracteristicas-de-una-imagen">Extracción de características de una imagen</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-facial-con-opencv-y-cnn">Detección Facial con OpenCV y CNN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaboost-de-viola-jones-y-clasificador-haar-cascade-para-el-reconocimiento-facial">AdaBoost de Viola-Jones y clasificador Haar Cascade para el reconocimiento facial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-code">Full code</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#aprendizaje-profundo-en-imagenes">Aprendizaje Profundo en Imágenes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comprendiendo-las-redes-neuronales-convolucionales-cnn-y-sus-parametros">Comprendiendo las Redes Neuronales Convolucionales (CNN) y sus Parámetros</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="deep-learning-para-vision-por-computadora">
<h1>Deep Learning para Visión por Computadora<a class="headerlink" href="#deep-learning-para-vision-por-computadora" title="Link to this heading">#</a></h1>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>La visión por computadora es difícil de definir debido a que se encuentra en la intersección de varios campos de investigación y desarrollo, como la <em><strong>informática (algoritmos, procesamiento de datos y gráficos)</strong></em>, la <em><strong>física (óptica y sensores)</strong></em>, las <em><strong>matemáticas (cálculo y teoría de la información)</strong></em> y la <em><strong>biología (estímulos visuales y procesamiento neural)</strong></em>. En esencia, la visión por computadora se resume como la extracción automatizada de información a partir de imágenes digitales.</p></li>
<li><p>Nuestro cerebro realiza maravillas en cuanto a la visión, permitiéndonos identificar y distinguir objetos de manera instantánea y reconocer rostros con facilidad. Para las computadoras, las imágenes son simplemente matrices de valores rojo-verde-azul sin significado. <em><strong>El objetivo de la visión por computadora es enseñar a las máquinas a interpretar estos píxeles de manera similar a los humanos, o incluso mejor</strong></em>. Con el avance del aprendizaje profundo, la visión por computadora ha alcanzado un rendimiento superior al humano en tareas como la <em><strong>verificación de rostros y el reconocimiento de texto manuscrito</strong></em>.</p></li>
<li><p>Las técnicas de <em><strong><code class="docutils literal notranslate"><span class="pre">computer</span> <span class="pre">vision</span></code></strong></em> permiten <em><strong>replicar las propiedades de la visión humana en un dispositivo electrónico</strong></em>. Este dispositivo puede ser un teléfono inteligente, drones, cámaras de vigilancia (CCTV), escáneres de resonancia magnética (MRI), entre otros, equipados con diversos sensores para la percepción. Estos sensores generan imágenes en formato digital que deben ser interpretadas por el dispositivo. El fundamento básico de esta interpretación o inteligencia se explicará en la siguiente sección. <em><strong>Los diferentes problemas que surgen en el ámbito de la visión por computadora pueden resolverse de manera efectiva mediante técnicas de aprendizaje profundo</strong></em>.</p></li>
</ul>
</div>
<section id="clasificacion">
<h2>Clasificación<a class="headerlink" href="#clasificacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La clasificación de imágenes consiste en <em><strong>etiquetar una imagen completa con un objeto o concepto con certeza</strong></em>. Las aplicaciones incluyen la <em><strong>clasificación de género</strong></em> a partir de la imagen de un rostro, la <em><strong>identificación del tipo de mascota</strong></em>, el <em><strong>etiquetado de fotos</strong></em>, entre otras. El siguiente es un ejemplo del resultado de una tarea de clasificación</p></li>
</ul>
<figure class="align-center" id="image-classification-example-fig">
<a class="reference internal image-reference" href="_images/image_classification_example.png"><img alt="_images/image_classification_example.png" src="_images/image_classification_example.png" style="width: 641.6px; height: 458.40000000000003px;" /></a>
</figure>
<ul class="simple">
<li><p>El Capítulo <em><strong>“Clasificación de Imágenes”</strong></em>, detalla los <em><strong>métodos para tareas de clasificación</strong></em>, mientras que en el Capítulo <em><strong>“Recuperación de Imágenes”</strong></em>, se utilizan estos modelos para <em><strong>visualizar modelos de aprendizaje profundo y recuperar imágenes similares</strong></em>.</p></li>
</ul>
</section>
<section id="deteccion-o-localizacion-y-segmentacion">
<h2>Detección o localización y segmentación<a class="headerlink" href="#deteccion-o-localizacion-y-segmentacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La <em><strong>detección</strong></em> o <em><strong>localización</strong></em> es una tarea que <em><strong>identifica un objeto en una imagen y lo delimita con un cuadro de contorno</strong></em>. Esta tarea tiene numerosas aplicaciones, como la <em><strong>identificación de peatones y señales para vehículos autónomos</strong></em>. La siguiente imagen es una ilustración de la detección</p></li>
</ul>
<figure class="align-center" id="segmentation-detection-example-fig">
<img alt="_images/segmentation_detection_example.png" src="_images/segmentation_detection_example.png" />
</figure>
<ul class="simple">
<li><p>La segmentación es la tarea de <em><strong>clasificar cada píxel de una imagen</strong></em>, lo que permite una <em><strong>separación precisa de los objetos</strong></em>. Esta técnica es especialmente útil en el procesamiento de <em><strong>imágenes médicas y de imágenes satelitales</strong></em>. En las secciones <em><strong>“Detección de Objetos”</strong></em> y <em><strong>“Segmentación de Imágenes”</strong></em> se abordarán más detalles.</p></li>
</ul>
</section>
<section id="aprendizaje-de-similitud">
<h2>Aprendizaje de Similitud<a class="headerlink" href="#aprendizaje-de-similitud" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El aprendizaje de similitud es el proceso de <em><strong>determinar cuán similares son dos imágenes</strong></em>. Se puede calcular una puntuación entre dos imágenes basada en su significado semántico, tal como se muestra en la imagen siguiente</p></li>
</ul>
<figure class="align-center" id="similarity-learning-fig">
<img alt="_images/similarity_learning.png" src="_images/similarity_learning.png" />
</figure>
<ul class="simple">
<li><p>Existen diversas aplicaciones de esta metodología, que van desde la <em><strong>identificación de productos similares hasta el reconocimiento facial</strong></em>. El Capítulo <em><strong>“Aprendizaje de similitud”</strong></em>, aborda las técnicas de aprendizaje de similitud.</p></li>
</ul>
</section>
<section id="etiquetado-de-imagenes">
<h2>Etiquetado de imágenes<a class="headerlink" href="#etiquetado-de-imagenes" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El etiquetado de imágenes es la tarea de <em><strong>describir una imagen utilizando texto</strong></em>, como se muestra a continuación</p></li>
</ul>
<figure class="align-center" id="image-captioning-fig">
<img alt="_images/image_captioning.png" src="_images/image_captioning.png" />
</figure>
<ul class="simple">
<li><p>El Capítulo <em><strong>“Descripción de Imágenes”</strong></em>, aborda detalladamente la tarea de <em><strong>generar descripciones para imágenes</strong></em>. Este caso particular requiere la combinación de técnicas de <em>procesamiento del lenguaje natural</em> (NLP) y <em>visión por computadora</em>.</p></li>
</ul>
</section>
<section id="modelos-generativos">
<h2>Modelos Generativos<a class="headerlink" href="#modelos-generativos" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los modelos generativos son de gran interés debido a su capacidad para <strong>generar imágenes</strong>. A continuación, se presenta un ejemplo de una aplicación de transferencia de estilo, donde <em><strong>se crea una imagen que combina el contenido de una imagen con el estilo de otras imágenes</strong></em></p></li>
</ul>
<figure class="align-center" id="generative-imgs-fig">
<img alt="_images/generative_imgs.png" src="_images/generative_imgs.png" />
</figure>
<ul class="simple">
<li><p>Las imágenes pueden ser creadas con diversos fines, como la <em><strong>generación de nuevos ejemplos de entrenamiento o la obtención de imágenes de superresolución</strong></em>. El Capítulo <em><strong>Modelos Generativos</strong></em>, explora en profundidad estos modelos.</p></li>
</ul>
</section>
<section id="analisis-de-video">
<h2>Análisis de Video<a class="headerlink" href="#analisis-de-video" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El análisis de video <em><strong>procesa un video en su totalidad, en contraposición al procesamiento de imágenes individuales</strong></em> como en los casos anteriores. Este tipo de análisis tiene diversas aplicaciones, incluyendo el <em><strong>seguimiento deportivo, la detección de intrusiones y las cámaras de vigilancia</strong></em>. El Capítulo <em><strong>Clasificación de Video</strong></em>, aborda aplicaciones específicas de video. La nueva dimensión de los datos temporales abre la puerta a numerosas aplicaciones interesantes.</p></li>
</ul>
</section>
<section id="la-instalacion-de-paquetes-de-software">
<h2>La instalación de paquetes de software<a class="headerlink" href="#la-instalacion-de-paquetes-de-software" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><em><strong>Para implementar modelos de aprendizaje profundo entrenados, se requieren diversas librerías</strong></em>. Instalaremos los siguientes paquetes y discutiremos las razones por las cuales se seleccionaron estos en lugar de otros competidores:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Python</span></code> y sus dependencias,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OpenCV</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Keras</span></code></p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Para realizar la instalación adecuada de <code class="docutils literal notranslate"><span class="pre">Python,</span> <span class="pre">TensorFlow,</span> <span class="pre">Keras</span></code> en un entorno virtual de <code class="docutils literal notranslate"><span class="pre">miniconda</span></code> puede seguir el siguiente tutorial, el cual ha sido preparado con este fin (ver <a class="reference external" href="https://www.youtube.com/watch?v=jzTWjXm8hsc&amp;amp;ab_channel=LihkiJoseRubioOrtega">Tensorflow Environment</a>).</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OpenCV</span></code> es una conocida <em><strong>biblioteca de visión por computadora ampliamente reconocida</strong></em>. Esta biblioteca ofrece diversas <em><strong>rutinas de procesamiento de imágenes que son de gran utilidad</strong></em>. Para instalar <code class="docutils literal notranslate"><span class="pre">OpenCV</span></code> siga los siguientes pasos:</p></li>
</ul>
<ol class="arabic">
<li><p>Abra la consola de comando de <code class="docutils literal notranslate"><span class="pre">miniconda</span></code>: <code class="docutils literal notranslate"><span class="pre">Anaconda</span> <span class="pre">Powershell</span> <span class="pre">Prompt</span></code></p></li>
<li><p>Desde la consola, ejecute alguna de las siguientes ordenes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">opencv</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">opencv</span><span class="o">-</span><span class="n">python</span>
</pre></div>
</div>
</li>
<li><p>En su <code class="docutils literal notranslate"><span class="pre">Notebook</span></code> de <code class="docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">Lab</span></code>, verifique que la instalación fue realizada correctamente, agregando la siguiente librería en el preámbulo de su <code class="docutils literal notranslate"><span class="pre">notebook</span></code>. Tenga en cuenta que debe tener activado el ambiente donde instaló <code class="docutils literal notranslate"><span class="pre">OpenCV</span></code> y <code class="docutils literal notranslate"><span class="pre">TensorFlow,</span> <span class="pre">Keras</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<ul>
<li><p>Necesitará contar también con la instalación de los siguientes paquetes: <code class="docutils literal notranslate"><span class="pre">Pillow</span></code> útil para la <em><strong>carga de imágenes y operaciones básicas en el procesamiento de imágenes</strong></em>. <code class="docutils literal notranslate"><span class="pre">H5py</span></code> el cual proporciona una interfaz en <code class="docutils literal notranslate"><span class="pre">Python</span></code> para el <em><strong>formato binario</strong></em> <code class="docutils literal notranslate"><span class="pre">HDF5</span></code>, utilizado como formato estándar para <em><strong>almacenar modelos entrenados con</strong></em> <code class="docutils literal notranslate"><span class="pre">Keras</span></code>. Para instalarlas usar la siguiente orden</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">pip3</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">scipy</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span> <span class="n">pillow</span> <span class="n">h5py</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="clasificacion-de-imagenes">
<h1>Clasificación de imagenes<a class="headerlink" href="#clasificacion-de-imagenes" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>La clasificación de imágenes consiste en <em><strong>asignar una única etiqueta a una imagen completa</strong></em>. Por ejemplo, en una tarea de clasificación de imágenes se podría <em>etiquetar una imagen como “perro” o “gato”, determinando si la imagen representa uno u otro</em>. En este capítulo, exploraremos cómo utilizar <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code> para <em><strong>construir modelos de clasificación de imágenes</strong></em> y aprenderemos técnicas para mejorar la precisión. Los temas que abordaremos incluyen:</p></li>
</ul>
<ol class="arabic simple">
<li><p>Entrenamiento del modelo <code class="docutils literal notranslate"><span class="pre">MNIST</span></code> en <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>.</p></li>
<li><p>Entrenamiento del modelo <code class="docutils literal notranslate"><span class="pre">MNIST</span></code> en <code class="docutils literal notranslate"><span class="pre">Keras</span></code>.</p></li>
<li><p>Otros conjuntos de datos populares para pruebas de imágenes.</p></li>
<li><p>Modelos más grandes de aprendizaje profundo.</p></li>
<li><p>Entrenamiento de un modelo para distinguir entre gatos y perros.</p></li>
<li><p>Desarrollo de aplicaciones del mundo real.</p></li>
</ol>
</div>
<section id="entrenamiento-del-modelo-mnist-en-tensorflow">
<h2>Entrenamiento del modelo <code class="docutils literal notranslate"><span class="pre">MNIST</span></code> en <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code><a class="headerlink" href="#entrenamiento-del-modelo-mnist-en-tensorflow" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>En esta sección, exploraremos la base de datos del <em><strong>Instituto Nacional de Normas y Tecnología Modificada</strong></em> (<code class="docutils literal notranslate"><span class="pre">MNIST</span></code>, por sus siglas en inglés) y <em><strong>construiremos un modelo sencillo de clasificación</strong></em>. El propósito principal es familiarizarnos con el marco general del aprendizaje profundo y utilizar <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code> para este fin. Comenzaremos construyendo un <em><strong>modelo de perceptrón</strong></em> o <em><strong>regresión logística</strong></em>. Posteriormente, entrenaremos una <em><strong>Red Neuronal Convolucional (CNN)</strong></em> para lograr una precisión superior. Además, examinaremos cómo <code class="docutils literal notranslate"><span class="pre">TensorBoard</span></code> ayuda a <em><strong>visualizar el proceso de entrenamiento y comprender los parámetros implicados</strong></em></p></li>
</ul>
</section>
<section id="las-bases-de-datos-mnist">
<h2>Las bases de datos <code class="docutils literal notranslate"><span class="pre">MNIST</span></code><a class="headerlink" href="#las-bases-de-datos-mnist" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los datos de <code class="docutils literal notranslate"><span class="pre">MNIST</span></code> contienen <em><strong>dígitos escritos a mano del 0 al 9</strong></em>, con <em><strong>60,000 imágenes para entrenamiento</strong></em> y <em><strong>10,000 imágenes para pruebas</strong></em>. Esta base de datos es <em><strong>ampliamente utilizada para evaluar algoritmos con un mínimo de preprocesamiento</strong></em>. Constituye una base de datos idónea y concisa <em><strong>para aprender algoritmos de aprendizaje automático</strong></em>. Es la base de datos más reconocida para problemas de clasificación de imágenes. A continuación se muestran algunos ejemplos</p></li>
</ul>
</section>
<section id="carga-de-los-datos-mnist">
<h2>Carga de los datos <code class="docutils literal notranslate"><span class="pre">MNIST</span></code><a class="headerlink" href="#carga-de-los-datos-mnist" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para cargar los datos de <code class="docutils literal notranslate"><span class="pre">MNIST</span></code>, se utiliza la función proporcionada por <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code> para acceder directamente a ellos. Se asume que el lector está ejecutando el código desde un editor con <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code> importado como <code class="docutils literal notranslate"><span class="pre">tf</span></code>. A continuación se muestra el fragmento de código para cargar <code class="docutils literal notranslate"><span class="pre">MNIST_data</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número de ejemplos de entrenamiento: </span><span class="si">{</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimensiones de las imágenes de entrenamiento: </span><span class="si">{</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número de clases: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de ejemplos de entrenamiento: 60000
Dimensiones de las imágenes de entrenamiento: (28, 28)
Número de clases: 10
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bd4742cb461daddf64063a5cfbe2a6923212b6f3208131d846fc12a9994e2aaf.png" src="_images/bd4742cb461daddf64063a5cfbe2a6923212b6f3208131d846fc12a9994e2aaf.png" />
</div>
</div>
<ul class="simple">
<li><p>Como se puede observar en la figura anterior, hay <em><strong>10 etiquetas para estos caracteres escritos a mano</strong></em>. Las imágenes se <em><strong>normalizan al tamaño de 28 píxeles por 28 píxeles</strong></em>, se <em><strong>convierten a escala de grises</strong></em> y se <em><strong>centran a un tamaño fijo</strong></em>. Este es un conjunto de datos pequeño que permite probar rápidamente un algoritmo.</p></li>
<li><p>Para obtener estadísticos descriptivos usando por ejemplo la función <code class="docutils literal notranslate"><span class="pre">.describe()</span></code> de <code class="docutils literal notranslate"><span class="pre">Python</span></code> es necesario convertir cada imagen a un tensor <code class="docutils literal notranslate"><span class="pre">Pandas</span></code> en el que contaremos con 6000 filas correspondientes a la cantidad de imágenes y 784 columnas correspondientes al tensor representante de cada imagen.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train_flatten</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_train_flatten</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(60000, 784)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_images</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x_train_flatten</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">df_train_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_images</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>59990</th>
      <th>59991</th>
      <th>59992</th>
      <th>59993</th>
      <th>59994</th>
      <th>59995</th>
      <th>59996</th>
      <th>59997</th>
      <th>59998</th>
      <th>59999</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>...</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
      <td>784.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>35.108418</td>
      <td>39.661990</td>
      <td>24.799745</td>
      <td>21.855867</td>
      <td>29.609694</td>
      <td>37.756378</td>
      <td>22.507653</td>
      <td>45.748724</td>
      <td>13.869898</td>
      <td>27.938776</td>
      <td>...</td>
      <td>23.460459</td>
      <td>27.838010</td>
      <td>20.607143</td>
      <td>16.674745</td>
      <td>12.279337</td>
      <td>32.910714</td>
      <td>34.802296</td>
      <td>28.229592</td>
      <td>26.056122</td>
      <td>26.683673</td>
    </tr>
    <tr>
      <th>std</th>
      <td>79.699674</td>
      <td>83.940709</td>
      <td>65.621613</td>
      <td>66.121069</td>
      <td>74.418792</td>
      <td>81.156460</td>
      <td>67.884941</td>
      <td>90.074068</td>
      <td>52.648776</td>
      <td>71.603894</td>
      <td>...</td>
      <td>64.205497</td>
      <td>70.117821</td>
      <td>60.056710</td>
      <td>52.439956</td>
      <td>47.490993</td>
      <td>75.785219</td>
      <td>79.436267</td>
      <td>71.545007</td>
      <td>66.457310</td>
      <td>67.610442</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>...</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>254.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
      <td>255.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 60000 columns</p>
</div></div></div>
</div>
<ul class="simple">
<li><p>Como se puede observar, el tensor que representa cada imagen cuenta con <em><strong>píxeles en la escala de grises</strong></em> donde <em><strong>0 (valor mínimo) corresponde a negro absoluto y 255 (valor máximo) a blanco absoluto</strong></em>. Cada tensor representa una imagen de tamaño (28, 28) la cual podemos visualizar usando <code class="docutils literal notranslate"><span class="pre">plt.imshow</span></code> como se hizo previamente para visualizar 40 imágenes.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_labels</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>60000.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4.453933</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.889270</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;tab10&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">colors</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frecuencia de datos repetidos en MNIST&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dígito&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c992c6df55fc0c4b60b3e937fdb3cb56f370a582a82cb697048f5b6db4c8af1f.png" src="_images/c992c6df55fc0c4b60b3e937fdb3cb56f370a582a82cb697048f5b6db4c8af1f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flatten_pixels</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Histogramas de Valores de Píxeles por Clase en MNIST&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  

<span class="k">for</span> <span class="n">digit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">digit</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">digit</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">digit</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pixels_digit</span> <span class="o">=</span> <span class="n">flatten_pixels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pixels_digit</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">digit</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">digit</span><span class="p">))</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dígito </span><span class="si">{</span><span class="n">digit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de Píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dígito&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6c0b64ce84e2a0eeb06b5882d83d59c5b2eff0e575945c781641eafde41bca87.png" src="_images/6c0b64ce84e2a0eeb06b5882d83d59c5b2eff0e575945c781641eafde41bca87.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pixel_intensity_by_digit</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">digit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">images_digit</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[</span><span class="n">y_train</span> <span class="o">==</span> <span class="n">digit</span><span class="p">]</span>
    <span class="n">intensity_digit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">images_digit</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">pixel_intensity_by_digit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">intensity_digit</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">24</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Histogramas de Intensidad de Píxeles por Dígito en MNIST&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">tab10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">digit</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">digit</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">digit</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pixel_intensity_by_digit</span><span class="p">[</span><span class="n">digit</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">digit</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">digit</span><span class="p">))</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dígito </span><span class="si">{</span><span class="n">digit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Intensidad Media de Píxeles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dígito&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.92</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e74d0550eaca8e1e126756ff1fbb35bbfbaee9d18272a66e55341e1e01ed9664.png" src="_images/e74d0550eaca8e1e126756ff1fbb35bbfbaee9d18272a66e55341e1e01ed9664.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train_images</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>

<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x_train_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_train_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x_train_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MNIST en 2D usando PCA&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Componente Principal 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Componente Principal 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1a57ac9fd21713faa992262c17df5884a58842013919b2a685de54182dd92a8f.png" src="_images/1a57ac9fd21713faa992262c17df5884a58842013919b2a685de54182dd92a8f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="n">tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x_train_tsne</span> <span class="o">=</span> <span class="n">tsne</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_train_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x_train_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;tab10&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;MNIST en 2D usando t-SNE&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Dimensión t-SNE 1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dimensión t-SNE 2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a0240e512197fa45cc8bc06bf18841b6330acf54109126096b7196632f1e9199.png" src="_images/a0240e512197fa45cc8bc06bf18841b6330acf54109126096b7196632f1e9199.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fundamentos-de-vision-por-computadora">
<h1>Fundamentos de Visión por Computadora<a class="headerlink" href="#fundamentos-de-vision-por-computadora" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>La <em><strong>visión por computadora</strong></em> está expandiéndose rápidamente en numerosas aplicaciones gracias a que las <em><strong>técnicas tradicionales, como la umbralización de imágenes, el filtrado y la detección de bordes, han sido mejoradas con métodos de <code class="docutils literal notranslate"><span class="pre">Deep</span> <span class="pre">Learning</span> <span class="pre">(DL)</span></code></strong></em>. <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>, una potente <em><strong>herramienta de aprendizaje automático creada por Google</strong></em>, se utiliza ampliamente. Esta herramienta <em><strong>ofrece <code class="docutils literal notranslate"><span class="pre">APIs</span></code> configurables por el usuario para entrenar y construir modelos complejos de redes neuronales tanto en un PC local como en la nube</strong></em>, y permite optimizar y desplegar a gran escala en dispositivos de borde.</p></li>
<li><p>En este capítulo, <em><strong>se presentarán conceptos avanzados de visión por computadora utilizando</strong></em> <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>, fundamentales en los capítulos posteriores de estas notas de clase. Exploraremos <em><strong>cómo realizar el hashing y el filtrado de imágenes</strong></em>, aprenderemos sobre diversos <em><strong>métodos de extracción de características y recuperación de imágenes</strong></em>. Luego, analizaremos la <em><strong>búsqueda visual en aplicaciones, sus métodos y los desafíos que podríamos enfrentar</strong></em>. También proporcionaremos una visión general del software de alto nivel <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code> y sus diferentes componentes y subsistemas.</p></li>
<li><p>Los temas que abordaremos en este capítulo son los siguientes:</p>
<ul>
<li><p><em><strong>Detección de bordes utilizando hashing y filtrado de imágenes</strong></em></p></li>
<li><p><em><strong>Extracción de características de una imagen</strong></em></p></li>
<li><p><em><strong>Detección de objetos usando contornos y el detector HOG</strong></em></p></li>
<li><p><em><strong>Visión general de <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code>, su ecosistema e instalación</strong></em></p></li>
</ul>
</li>
</ul>
</div>
<section id="deteccion-de-bordes-mediante-el-uso-de-hashing-de-imagenes-y-filtrado">
<h2>Detección de bordes mediante el uso de hashing de imágenes y filtrado<a class="headerlink" href="#deteccion-de-bordes-mediante-el-uso-de-hashing-de-imagenes-y-filtrado" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El <em><strong>hash de imágenes</strong></em> es un método utilizado para <em><strong>encontrar similitudes entre imágenes</strong></em>. Consiste en <em><strong>transformar una imagen de entrada en un vector binario de tamaño fijo</strong></em>. Existen varios algoritmos para el hash de imágenes que emplean diferentes transformaciones, tales como:</p>
<ul>
<li><p><em><strong>Perceptual hash (<code class="docutils literal notranslate"><span class="pre">phash</span></code>)</strong></em>: Utiliza una transformación coseno.</p></li>
<li><p><em><strong>Difference hash (<code class="docutils literal notranslate"><span class="pre">dhash</span></code>)</strong></em>: Calcula la diferencia entre píxeles adyacentes.</p></li>
</ul>
</li>
<li><p><em><strong>Después de aplicar una transformación de hash, las imágenes pueden compararse rápidamente utilizando la distancia de Hamming</strong></em>. Una <em><strong>distancia de Hamming de 0 indica que las imágenes son idénticas</strong></em> (duplicadas), mientras que una <em><strong>distancia mayor indica diferencias entre las imágenes</strong></em>. El siguiente fragmento de código importa paquetes de <code class="docutils literal notranslate"><span class="pre">Python</span></code>, como <code class="docutils literal notranslate"><span class="pre">PIL,</span> <span class="pre">imagehash</span></code> y <code class="docutils literal notranslate"><span class="pre">distance</span></code>. <code class="docutils literal notranslate"><span class="pre">imagehash</span></code> es un paquete de <code class="docutils literal notranslate"><span class="pre">Python</span></code> que soporta varios tipos de algoritmos de hashing. <code class="docutils literal notranslate"><span class="pre">PIL</span></code> es una biblioteca de imágenes de <code class="docutils literal notranslate"><span class="pre">Python</span></code>, y <code class="docutils literal notranslate"><span class="pre">distance</span></code> es un paquete de <code class="docutils literal notranslate"><span class="pre">Python</span></code> que calcula la distancia de Hamming entre dos imágenes hasheadas:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">imagehash</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">distance</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image1_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/rs3.jpg&#39;</span>
<span class="n">image2_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/gt3rs.jpg&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response1</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image1_url</span><span class="p">)</span>
<span class="n">image_bytes1</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response1</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">image_array1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes1</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image1</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array1</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">image1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">image1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">image_pil1</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">hash1</span> <span class="o">=</span> <span class="n">imagehash</span><span class="o">.</span><span class="n">phash</span><span class="p">(</span><span class="n">image_pil1</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se pudo cargar la primera imagen.&quot;</span><span class="p">)</span>
    <span class="n">image1</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response2</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image2_url</span><span class="p">)</span>
<span class="n">image_bytes2</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response2</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
<span class="n">image_array2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes2</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image2</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array2</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">image2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">image2</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">image_pil2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image2</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">hash2</span> <span class="o">=</span> <span class="n">imagehash</span><span class="o">.</span><span class="n">phash</span><span class="p">(</span><span class="n">image_pil2</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No se pudo cargar la segunda imagen.&quot;</span><span class="p">)</span>
    <span class="n">image2</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">image1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">image2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">hamming_dist</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">hamming</span><span class="p">(</span><span class="n">hash1</span><span class="o">.</span><span class="n">hash</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">hash2</span><span class="o">.</span><span class="n">hash</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distancia de Hamming: </span><span class="si">{</span><span class="n">hamming_dist</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen 1&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Ocultar los ejes</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image2</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen 2&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Ocultar los ejes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distancia de Hamming: 0.5
</pre></div>
</div>
<img alt="_images/24c28a60a45aa8c1d1f75135120cd3ba40b8dd2080b5b4a69260d249deff5fbc.png" src="_images/24c28a60a45aa8c1d1f75135120cd3ba40b8dd2080b5b4a69260d249deff5fbc.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El filtrado de imágenes es una operación fundamental en la visión por computadora que <em><strong>modifica la imagen de entrada mediante la aplicación de un núcleo o filtro a cada píxel</strong></em>. Los pasos involucrados en el proceso de filtrado de imágenes, desde la entrada de la luz en la cámara hasta la imagen transformada final, son los siguientes:</p>
<ul>
<li><p>Uso de un <em><strong>filtro de Bayer para la formación de patrones de color</strong></em>.</p></li>
<li><p>Creación de un <em><strong>vector de imagen</strong></em>.</p></li>
<li><p><em><strong>Transformación de la imagen</strong></em>.</p></li>
<li><p><em><strong>Filtrado lineal</strong></em> mediante <em><strong>convolución con kernels</strong></em>.</p></li>
<li><p>Combinación de <em><strong>filtros gaussianos y laplacianos</strong></em>.</p></li>
<li><p><em><strong>Detección de bordes</strong></em> en la imagen.</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="el-uso-de-un-filtro-bayer-para-la-formacion-de-patrones-de-color">
<h2>El uso de un filtro Bayer para la formación de patrones de color<a class="headerlink" href="#el-uso-de-un-filtro-bayer-para-la-formacion-de-patrones-de-color" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Un <em><strong>filtro Bayer transforma una imagen en bruto en una imagen procesada en color natural mediante la aplicación de un algoritmo de desmosaico</strong></em>. El sensor de imagen consta de fotodiodos, los cuales generan fotones eléctricamente cargados en proporción a la intensidad de la luz. Los fotodiodos son naturalmente en escala de grises. Los <em><strong>filtros Bayer se emplean para convertir la imagen en escala de grises a color</strong></em>. La imagen en color obtenida del filtro Bayer se somete a un <em><strong>Procesamiento de Señal de Imagen (ISP)</strong></em>, que implica varias semanas de ajustes manuales de diversos parámetros <em><strong>para lograr la calidad de imagen deseada para la visión humana</strong></em>.</p></li>
<li><p>Actualmente, se están llevando a cabo varios trabajos de investigación para <em><strong>sustituir el ISP manual por un procesamiento basado en CNN para generar una imagen, y luego combinar la CNN con un modelo de clasificación de imágenes o detección de objetos</strong></em> para crear un único pipeline de red neuronal coherente que tome una imagen en color Bayer y detecte objetos con cuadros delimitadores. Detalles de tales trabajos pueden encontrarse en el artículo de <em>2019 de Sivalogeswaran Ratnasingam titulado “Deep Camera: A Fully Convolutional Neural Network for Image Signal Processing”</em>.</p></li>
</ul>
<figure class="align-center" id="bayer-pattern-on-sensor-profile-fig">
<img alt="_images/bayer_pattern_on_sensor_profile.png" src="_images/bayer_pattern_on_sensor_profile.png" />
</figure>
<figure class="align-center" id="bayer-pattern-on-sensor-fig">
<img alt="_images/bayer_pattern_on_sensor.png" src="_images/bayer_pattern_on_sensor.png" />
</figure>
<ul class="simple">
<li><p>En el diagrama anterior, observamos lo siguiente:</p>
<ul>
<li><p>El <em><strong>filtro Bayer está compuesto por canales Rojo (R), Verde (G) y Azul (B) dispuestos en un patrón predefinido</strong></em>, con el <em><strong>doble de canales G en comparación con B y R</strong></em>.</p></li>
<li><p>Los <em><strong>canales G, R y B se distribuyen alternadamente</strong></em>, mayormente en combinaciones como RGGB, GRGB o RGBG.</p></li>
<li><p><em><strong>Cada canal permite pasar solo un color específico</strong></em>, y la <em><strong>combinación de colores de diferentes canales produce un patrón</strong></em> como se muestra en la imagen anterior.</p></li>
</ul>
</li>
</ul>
</section>
<section id="creando-vector-de-imagen">
<h2>Creando Vector de Imagen<a class="headerlink" href="#creando-vector-de-imagen" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para crear un <em><strong>vector de imagen</strong></em>, las imágenes en color se componen de los <em>canales R (rojo), G (verde) y B (azul)</em>, cada uno representando <em><strong>intensidades que varían de 0 a 255</strong></em>. Por lo tanto, cada imagen se puede <em><strong>visualizar como un cubo tridimensional, donde los ejes x e y representan el ancho y alto, respectivamente, y el eje z representa el tercer canal de color (R, G, B), que indican la intensidad de cada color</strong></em>. <code class="docutils literal notranslate"><span class="pre">OpenCV</span></code> es una biblioteca que proporciona funciones integradas para <code class="docutils literal notranslate"><span class="pre">Python</span></code> y <code class="docutils literal notranslate"><span class="pre">C++</span></code>, diseñada para <em><strong>procesamiento de imágenes y detección de objetos</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p>Comenzaremos escribiendo el siguiente código en <code class="docutils literal notranslate"><span class="pre">Python</span></code> para importar una imagen, y luego veremos <em><strong>cómo la imagen puede descomponerse en un array de <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> de vectores con valores RGB</strong></em>. Posteriormente, <em><strong>convertiremos la imagen a escala de grises y observaremos cómo se ve la imagen al extraer solo un componente de color de la misma</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/rs3.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">color_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
<span class="n">gray_image</span>  <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">color_image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">color_image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen a color&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen en escala de grises&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/46d8459ff550c563a28b3bd3e2d207217b3f13097c7207980e1fe62ae6348822.png" src="_images/46d8459ff550c563a28b3bd3e2d207217b3f13097c7207980e1fe62ae6348822.png" />
</div>
</div>
<ul class="simple">
<li><p>A continuación, presentamos el código <code class="docutils literal notranslate"><span class="pre">Python</span></code> que utilizaremos para <em><strong>convertir la imagen en sus componentes de color R, G y B</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">color_image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Canal Rojo&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">color_image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Canal Verde&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">color_image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Canal Azul&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/caa6debc657e9f3134836daddcfab6fcd436fd4ebd6f1fc53c636246fc53ea5e.png" src="_images/caa6debc657e9f3134836daddcfab6fcd436fd4ebd6f1fc53c636246fc53ea5e.png" />
</div>
</div>
<ul class="simple">
<li><p>La figura anterior se puede representar como un <em><strong>volumen tridimensional con los siguientes ejes</strong></em>:</p>
<ul>
<li><p>El <em><strong>eje x, que representa el ancho</strong></em>.</p></li>
<li><p>El <em><strong>eje y, que representa la altura</strong></em>.</p></li>
<li><p>Cada <em><strong>canal de color representa la profundidad de la imagen</strong></em>.</p></li>
</ul>
</li>
<li><p>A continuación podemos visualizar los valores de <em><strong>píxeles R, G y B para la imagen del coche en diferentes coordenadas x e y como un volumen tridimensional</strong></em>; un valor más alto indica una imagen más brillante.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[181, 182, 183, ..., 168, 168, 166],
       [181, 181, 182, ..., 167, 167, 166],
       [179, 180, 181, ..., 166, 166, 166],
       ...,
       [ 63,  72,  84, ...,  46,  41,  42],
       [ 52,  61,  68, ...,  35,  43,  43],
       [ 62,  68,  70, ...,  37,  39,  39]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[210, 211, 212, ..., 165, 165, 163],
       [210, 210, 211, ..., 164, 164, 163],
       [208, 209, 210, ..., 163, 163, 163],
       ...,
       [ 63,  72,  84, ...,  47,  42,  43],
       [ 52,  61,  68, ...,  36,  44,  44],
       [ 62,  68,  70, ...,  38,  40,  40]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_image</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[215, 216, 217, ..., 137, 137, 135],
       [215, 215, 216, ..., 136, 136, 135],
       [212, 213, 214, ..., 135, 135, 135],
       ...,
       [ 57,  66,  78, ...,  45,  40,  41],
       [ 46,  55,  62, ...,  34,  42,  42],
       [ 56,  62,  64, ...,  36,  38,  38]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
</section>
<section id="transformaciones-geometricas">
<h2>Transformaciones geométricas<a class="headerlink" href="#transformaciones-geometricas" title="Link to this heading">#</a></h2>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>En el ámbito del procesamiento de imágenes, la teoría de las transformaciones geométricas es fundamental. Esta teoría es esencial para <em><strong>comprender el modelo de formación de imágenes en cámaras, impresoras o proyectores</strong></em>. Las transformaciones geométricas <em><strong>corrigen las distorsiones que ocurren durante la adquisición de imágenes</strong></em>, causadas por lentes o movimientos irregulares del sensor.</p></li>
<li><p>En aplicaciones de teledetección, es necesario comparar imágenes tomadas desde diferentes puntos de vista y en distintos momentos, lo cual requiere una transformación geométrica previa. Para <em><strong>inspeccionar cambios a lo largo del tiempo, primero se realiza una transformación geométrica y luego se resta una imagen de la otra</strong></em>. La transformación geométrica es también crucial en la registración de imágenes.</p></li>
<li><p>En esta sección se discuten <em><strong>tres transformaciones geométricas principales en detalle</strong></em>. Aunque el enfoque es el procesamiento de señales e imágenes en 2D, también se aborda la generalización a 3D. Se ilustra el uso de la transformación homogénea con ejemplos de concatenación de matrices de transformaciones básicas.</p></li>
</ul>
</div>
</section>
<section id="traslacion">
<h2>Traslación<a class="headerlink" href="#traslacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La <em><strong>traslación</strong></em> se define como la <em><strong>primera transformación geométrica básica</strong></em>. Como se ilustra en la <a class="reference internal" href="#translation-2d-fig"><span class="std std-numref">Fig. 70</span></a>, el punto <span class="math notranslate nohighlight">\(P\)</span> con coordenadas cartesianas <span class="math notranslate nohighlight">\((x, y)\)</span> se mueve a otro punto <span class="math notranslate nohighlight">\(P'\)</span> mediante una traslación de <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>. Si la coordenada final del punto <span class="math notranslate nohighlight">\(P'\)</span> después de la traslación es <span class="math notranslate nohighlight">\((x', y')\)</span>, la relación entre la posición inicial y final del vector del punto se puede expresar fácilmente como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
x'=x+x_0,\quad y'=y+y_0
\]</div>
<figure class="align-center" id="translation-2d-fig">
<a class="reference internal image-reference" href="_images/translation_2D.png"><img alt="_images/translation_2D.png" src="_images/translation_2D.png" style="width: 360.0px; height: 341.52px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 70 </span><span class="caption-text">Traslación de un punto <span class="math notranslate nohighlight">\(P\)</span> en un sistema de coordenadas 2D.</span><a class="headerlink" href="#translation-2d-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Para representar las dos ecuaciones anteriores en <em><strong>forma matricial</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-2d-translation">
<span class="eqno">(69)<a class="headerlink" href="#equation-2d-translation" title="Link to this equation">#</a></span>\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0\\
0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
+
\begin{bmatrix}
x_{0}\\
y_{0}
\end{bmatrix}
\Longrightarrow
P'=IP+T
\end{split}\]</div>
<ul class="simple">
<li><p>La misma relación de transformación puede <em><strong>generalizarse en un sistema de coordenadas cartesianas 3D</strong></em> como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'\\
z'
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
z
\end{bmatrix}
+
\begin{bmatrix}
x_{0}\\
y_{0}\\
z_{0}
\end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>De manera similar, <em><strong>un objeto completo en un sistema de coordenadas cartesianas puede ser trasladado</strong></em>, como se muestra en la <a class="reference internal" href="#translation-2d-fig"><span class="std std-numref">Fig. 70</span></a>. En este caso, es necesario <em><strong>trasladar cada punto del objeto aplicando la regla de transformación</strong></em> definida en la Ecuación <a class="reference internal" href="#equation-2d-translation">(69)</a>.</p></li>
<li><p>El tratamiento de los elementos cercanos a los bordes de la imagen varía según la implementación. La <em><strong>traslación se utiliza para mejorar la visualización de una imagen</strong></em> y también actúa como un <em><strong>preprocesador en aplicaciones que requieren la registración de dos o más imágenes</strong></em>.</p></li>
</ul>
<figure class="align-center" id="translation-2d-example-fig">
<a class="reference internal image-reference" href="_images/translation_2D_example.png"><img alt="_images/translation_2D_example.png" src="_images/translation_2D_example.png" style="width: 450.0px; height: 263.55px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 71 </span><span class="caption-text">Traslación en un sistema de coordenadas cartesianas.</span><a class="headerlink" href="#translation-2d-example-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="escalado">
<h2>Escalado<a class="headerlink" href="#escalado" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El <em><strong>escalado es una transformación geométrica básica utilizada para reducir o ampliar el tamaño de una imagen</strong></em>, parte de una imagen, o un objeto. La reducción de imágenes, conocida como subsampling, se realiza mediante la sustitución o interpolación de píxeles en un vecindario local.</p></li>
<li><p>El <em>zoom</em> de imágenes se logra <em>replicando píxeles o mediante interpolación</em>. El <em><strong>escalado se emplea para cambiar la apariencia visual de una imagen</strong></em>, modificar la cantidad de información almacenada en una representación de escena, o como <em><strong>preprocesador en cadenas de procesamiento de imágenes</strong></em> que operan sobre características de una escala particular.</p></li>
<li><p>La operación de <em><strong>escalado respecto al origen</strong></em> se ilustra en la <a class="reference internal" href="#scaling-2d-example-fig"><span class="std std-numref">Fig. 72</span></a>. Antes de aplicar la transformación, la coordenada de la esquina superior derecha del trapecio <span class="math notranslate nohighlight">\(P\)</span> es <span class="math notranslate nohighlight">\((x, y)\)</span>. Al aplicar la transformación <span class="math notranslate nohighlight">\(S\)</span>, la posición del punto <span class="math notranslate nohighlight">\(P\)</span> (y de todos los puntos en el objeto trapecio) cambia a <span class="math notranslate nohighlight">\((x', y')\)</span>. La posición final se indica como <span class="math notranslate nohighlight">\(P'\)</span>. Si el escalado en las direcciones <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span> son <span class="math notranslate nohighlight">\(S_{x}\)</span> y <span class="math notranslate nohighlight">\(S_{y}\)</span> respectivamente, <em><strong>la coordenada final se puede determinar como</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
x'=xS_{x},\quad y'=yS_{y}
\]</div>
<div class="math notranslate nohighlight" id="equation-scaling-2d">
<span class="eqno">(70)<a class="headerlink" href="#equation-scaling-2d" title="Link to this equation">#</a></span>\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
S_{x} &amp; 0\\
0 &amp; S_{y}
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
\Longrightarrow
P'=SP
\end{split}\]</div>
<ul class="simple">
<li><p><em><strong>Escalamiento uniforme vs nouniforme</strong></em>:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(S_{x}=S_{y}\Longrightarrow\)</span> escalamiento uniforme</p></li>
<li><p><span class="math notranslate nohighlight">\(S_{x}\neq S_{y}\Longrightarrow\)</span> escalamiento nouniforme</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p><em><strong>Efecto del factor de escala</strong></em></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(S_{x}, S_{y}&lt;1\Longrightarrow\)</span> tamaño del objeto es reducido</p></li>
<li><p><span class="math notranslate nohighlight">\(S_{x}, S_{y}&lt;1\Longrightarrow\)</span> tamaño del objeto es aumentado</p></li>
<li><p><span class="math notranslate nohighlight">\(S_{x}=S_{y}=1\Longrightarrow\)</span> tamaño del objeto no cambia</p></li>
</ul>
</li>
</ul>
<figure class="align-center" id="scaling-2d-example-fig">
<a class="reference internal image-reference" href="_images/scaling_2D_example.png"><img alt="_images/scaling_2D_example.png" src="_images/scaling_2D_example.png" style="width: 600.0px; height: 350.40000000000003px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 72 </span><span class="caption-text">Escalamiento de un objeto en un sistema de coordenadas 2D.</span><a class="headerlink" href="#scaling-2d-example-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>En un <em><strong>sistema de coordenadas 3D, la transformación</strong></em> ilustrada en la Ecuación <a class="reference internal" href="#equation-scaling-2d">(70)</a> se puede generalizar como</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'\\
z'
\end{bmatrix}
=
\begin{bmatrix}
S_{x} &amp; 0 &amp; 0\\
0 &amp; S_{y} &amp; 0\\
0 &amp; 0 &amp; S_{z}\\
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
z
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="rotacion">
<h2>Rotación<a class="headerlink" href="#rotacion" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>La tercera transformación básica, <em><strong>la rotación, realiza un cambio geométrico que mapea la posición</strong></em> <span class="math notranslate nohighlight">\((x, y)\)</span> <em><strong>de un píxel</strong></em> <span class="math notranslate nohighlight">\(P\)</span> en una imagen de entrada a otro punto <span class="math notranslate nohighlight">\(P'\)</span> con posición <span class="math notranslate nohighlight">\((x', y')\)</span> en una imagen de salida, <em><strong>girándolo a través de un ángulo especificado por el usuario</strong></em> respecto al origen del sistema de coordenadas cartesianas.</p></li>
<li><p>La <em><strong>rotación se utiliza comúnmente para mejorar la apariencia visual de una imagen</strong></em> o como <em><strong>preproceso en aplicaciones que involucran operadores direccionales</strong></em>. Una de estas aplicaciones se discute en la sección actual. Consideremos que la posición inicial del punto <span class="math notranslate nohighlight">\(P\)</span> es <span class="math notranslate nohighlight">\((x, y)\)</span> y forma un ángulo <span class="math notranslate nohighlight">\(\theta\)</span> con el eje <span class="math notranslate nohighlight">\(x\)</span>, como se muestra en la <a class="reference internal" href="#rotation-2d-example-fig"><span class="std std-numref">Fig. 73</span></a>. Del triángulo <span class="math notranslate nohighlight">\(OPB\)</span>, se tiene que <span class="math notranslate nohighlight">\(OB = x\)</span> y <span class="math notranslate nohighlight">\(PB = y\)</span>.</p></li>
</ul>
<figure class="align-center" id="rotation-2d-example-fig">
<a class="reference internal image-reference" href="_images/rotation_2D_example.png"><img alt="_images/rotation_2D_example.png" src="_images/rotation_2D_example.png" style="width: 450.0px; height: 390.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 73 </span><span class="caption-text">Rotación de un punto <span class="math notranslate nohighlight">\(P\)</span> en un sistema de coordenadas 2D.</span><a class="headerlink" href="#rotation-2d-example-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
x &amp;= r\cos\theta\\
y &amp;= r\sin\theta
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>El punto <span class="math notranslate nohighlight">\(P\)</span> no se transforma por la rotación de <span class="math notranslate nohighlight">\(\phi\)</span> en dirección anti-horaria respecto al origen. La coordenada final del punto <span class="math notranslate nohighlight">\(P'\)</span> es <span class="math notranslate nohighlight">\((x', y')\)</span>. Por lo tanto, del triángulo <span class="math notranslate nohighlight">\(OP'A\)</span>, se tiene que <span class="math notranslate nohighlight">\(OA = x'\)</span> y <span class="math notranslate nohighlight">\(P'A = y'\)</span>. Por lo tanto,</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-rotation-2d-equation">
<span class="eqno">(71)<a class="headerlink" href="#equation-rotation-2d-equation" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
x' &amp;= r\cos(\theta+\phi)\\
&amp;= r\cos(\theta)\cos(\phi)-r\sin(\theta)\sin(\phi)\\
&amp;= x\cos(\phi)-y\sin(\phi).
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Similarmente, <span class="math notranslate nohighlight">\(y'=y\cos(\phi)-x\sin(\phi)\)</span>. En forma matricial</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
\cos(\phi) &amp; -\sin(\phi)\\
\sin(\phi) &amp; \cos(\phi)
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
P'=R_{\phi}P
\]</div>
<ul class="simple">
<li><p>La matriz de rotación para la rotación en la dirección opuesta (en el sentido de las agujas del reloj) se obtiene reemplazando <span class="math notranslate nohighlight">\(R_{\phi}\)</span> por <span class="math notranslate nohighlight">\(R_{-\phi}\)</span> en la Ecuación <a class="reference internal" href="#equation-rotation-2d-equation">(71)</a>, como se muestra a continuación</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
P''=R_{-\phi}P
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\begin{bmatrix}
x''\\
y''
\end{bmatrix}
&amp;=
\begin{bmatrix}
\cos(-\phi) &amp; -\sin(-\phi)\\
\sin(-\phi) &amp; \cos(-\phi)
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}\\[2mm]
&amp;=
\begin{bmatrix}
\cos(\phi) &amp; \sin(\phi)\\
-\sin(\phi) &amp; \cos(\phi)
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
\end{align*}
\end{split}\]</div>
<figure class="align-center" id="rotation-2d-picture-fig">
<a class="reference internal image-reference" href="_images/rotation_2D_picture.png"><img alt="_images/rotation_2D_picture.png" src="_images/rotation_2D_picture.png" style="width: 450.0px; height: 390.75px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 74 </span><span class="caption-text">Rotación de un punto en un sistema de coordenadas cartesianas 3D.</span><a class="headerlink" href="#rotation-2d-picture-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>La generalización de la <em><strong>rotación en un sistema de coordenadas 3D</strong></em> se ilustra en la <a class="reference internal" href="#rotation-2d-picture-fig"><span class="std std-numref">Fig. 74</span></a>. Si el ángulo de rotación del punto <span class="math notranslate nohighlight">\(P(x, y)\)</span> con respecto a los ejes <span class="math notranslate nohighlight">\(X, Y\)</span> y <span class="math notranslate nohighlight">\(Z\)</span> es <span class="math notranslate nohighlight">\(\alpha, \beta\)</span> y <span class="math notranslate nohighlight">\(\theta\)</span>, respectivamente, en sentido horario, las matrices de rotación se formarán de la siguiente forma</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{\theta}=
\begin{bmatrix}
\cos(\theta) &amp; \sin(\theta) &amp; 0 &amp; 0\\
-\sin(\theta) &amp; \cos(\theta) &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{\theta}=
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; \cos(\alpha) &amp; \sin(\alpha) &amp; 0\\
0 &amp; -\sin(\alpha) &amp; \cos(\alpha) &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
R_{\theta}=
\begin{bmatrix}
\cos(\beta) &amp; 0 &amp; \sin(\beta) &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
-\sin(\beta) &amp; 0 &amp; \cos(\beta) &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1\\
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="transformacion-homogenea">
<h2>Transformación Homogénea<a class="headerlink" href="#transformacion-homogenea" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Las tres <em><strong>transformaciones básicas pueden expresarse en forma de matriz</strong></em>. La traslación incluye multiplicación y adición de matrices, mientras que la escala y la rotación solo requieren multiplicación de matrices. En la mayoría de las <em><strong>aplicaciones prácticas, es esencial la concatenación o combinación de matrices de transformaciones básicas</strong></em>, como se muestra en la siguiente sección. Para abordar estos problemas, se necesita una <em><strong>forma común de matriz de transformación</strong></em>. Si comenzamos solo con la “traslación”, la transformación se define (Ecuación <a class="reference internal" href="#equation-2d-translation">(69)</a>) como:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0\\
0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
+
\begin{bmatrix}
x_{0}\\
y_{0}
\end{bmatrix}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
P'=T_{1}P+T_{2}
\]</div>
<ul class="simple">
<li><p>Donde <span class="math notranslate nohighlight">\(P'\)</span> y <span class="math notranslate nohighlight">\(P\)</span> representan vectores columna (<em><strong>posición inicial y final del píxel</strong></em>). <span class="math notranslate nohighlight">\(T_{1}\)</span> es la matriz 2x2 que contiene <em><strong>factores multiplicativos (matriz identidad)</strong></em> y <span class="math notranslate nohighlight">\(T_{2}\)</span> es la matriz columna de 2 elementos que <em><strong>contiene términos de traslación</strong></em>. Podemos combinar <span class="math notranslate nohighlight">\(T_{1}\)</span> y <span class="math notranslate nohighlight">\(T_{2}\)</span> en una única matriz, como se muestra en la siguiente ecuación</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0 &amp; x_{0}\\
0 &amp; 1 &amp; y_{0}
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
1
\end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>Como se observa, la <em><strong>matriz de transformación combinada para la traslación no es una matriz cuadrada</strong></em>. Para hacerla cuadrada, <em><strong>representamos la transformación con una matriz de 3 por 3</strong></em> en lugar de una de 2 por 3. En esta nueva expresión, <em><strong>cada posición de coordenadas cartesianas</strong></em> <span class="math notranslate nohighlight">\((x, y)\)</span> <em><strong>se representa con el triplete de coordenadas homogéneas</strong></em> <span class="math notranslate nohighlight">\((x_{h}, y_{h}, k)\)</span> o <span class="math notranslate nohighlight">\((kx, ky, k)\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p><em><strong>Coordenada cartesiana</strong></em> <span class="math notranslate nohighlight">\(\Longrightarrow\)</span> <em><strong>Coordenada homogénea</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
W=
\begin{bmatrix}
X\\
Y
\end{bmatrix}
\Longrightarrow
W_{h}=
\begin{bmatrix}
kX\\
kY\\
k
\end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>En geometría 2D, se considera que la constante arbitraria <span class="math notranslate nohighlight">\(k\)</span> igual a 1. Por lo tanto, las <em><strong>tres transformaciones básicas pueden expresarse en el sistema de coordenadas homogéneas</strong></em> de la siguiente manera</p></li>
</ul>
<ul class="simple">
<li><p><em><strong>Traslación</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0 &amp; x_{0}\\
0 &amp; 1 &amp; y_{0}\\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
1
\end{bmatrix}
\Longrightarrow
P'=T_{x_{0},y_{0}}P
\end{split}\]</div>
<ul class="simple">
<li><p><em><strong>Escalado</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
S_{x} &amp; 0\\
0 &amp; S_{y}
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
\Longrightarrow
\begin{bmatrix}
x'\\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
S_{x} &amp; 0 &amp; 0\\
0 &amp; S_{y} &amp; 0\\
0 &amp; 0 &amp; 1\\
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
1
\end{bmatrix}
\Longrightarrow
P'=S_{S_{x},S_{y}}P
\end{split}\]</div>
<ul class="simple">
<li><p><em><strong>Rotación</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
x'\\
y'
\end{bmatrix}
=
\begin{bmatrix}
\cos(\phi) &amp; -\sin(\phi)\\
\sin(\phi) &amp; \cos(\phi)
\end{bmatrix}
\begin{bmatrix}
x\\
y
\end{bmatrix}
\Longrightarrow
\begin{bmatrix}
x'\\
y'\\
1
\end{bmatrix}
=
\begin{bmatrix}
\cos(\phi) &amp; -\sin(\phi) &amp; 0\\
\sin(\phi) &amp; \cos(\phi) &amp; 0\\
0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
1
\end{bmatrix}
\Longrightarrow
\begin{bmatrix}
x\\
y\\
1
\end{bmatrix}
\Longrightarrow
P'=R_{\phi}P
\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Transformaciones</span> <span class="pre">Homogéneas</span></code></strong>: Al utilizar <em><strong>coordenadas homogéneas, se pueden representar todas las transformaciones geométricas mediante multiplicación de matrices</strong></em>, lo cual es <em><strong>computacionalmente eficiente y conveniente para los algoritmos de visión por computadora</strong></em>. Facilitan la combinación de múltiples transformaciones en una sola operación mediante la multiplicación de matrices.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Transformación</span> <span class="pre">Cuadradas</span></code></strong>: Las <em><strong>matrices de transformación cuadradas preservan la dimensionalidad del espacio de entrada</strong></em>, garantizando que la imagen transformada permanezca en el mismo espacio de coordenadas. <em><strong>Se utilizan para rotaciones y escalados</strong></em>, ajustando la orientación y tamaño de los objetos en una imagen. Además, sus <em><strong>propiedades matemáticas, como la invertibilidad, son útiles para revertir transformaciones</strong></em> y realizar <em><strong>análisis matemático en el procesamiento de imágenes</strong></em>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>La <em><strong>transformación de imágenes es fundamental en la visión por computadora para obtener diversas imágenes a partir de una misma imagen</strong></em>. Esto permite que el <em><strong>modelo de red neuronal sea robusto a la traslación, rotación y cizalladura</strong></em>. Por ejemplo, si durante la fase de entrenamiento solo se utiliza una <em><strong>imagen frontal de un coche en la red neuronal convolucional (CNN)</strong></em>, el modelo <em><strong>no podrá detectar la imagen de un coche girado 90 grados en la fase de prueba</strong></em>. A continuación, discutiremos la mecánica de la <em><strong>operación de convolución</strong></em> y cómo se aplican los filtros para transformar una imagen.</p></li>
</ul>
</section>
<section id="convolucion-2d-y-filtro-lineal">
<h2>Convolución 2D y Filtro Lineal<a class="headerlink" href="#convolucion-2d-y-filtro-lineal" title="Link to this heading">#</a></h2>
<ul>
<li><p>La <em><strong>convolución en 2D</strong></em> se utiliza frecuentemente en el procesamiento de imágenes <em><strong>para operaciones como suavizado, realce y detección de bordes</strong></em>. En este contexto, también se le llama <em><strong>“operación de filtrado”</strong></em>. La <em><strong>convolución en 2D es una extensión de la convolución en 1D</strong></em>, aplicando la máscara tanto en direcciones horizontales como verticales en el espacio 2D.</p></li>
<li><p>La convolución en visión por computadora es una <em><strong>operación de álgebra lineal entre dos matrices</strong></em> (<em>una imagen y una matriz pequeña</em>) que <em><strong>produce una matriz de imagen filtrada con una forma diferente a la matriz original</strong></em>. La convolución es <em><strong>acumulativa y asociativa</strong></em>, y se puede representar matemáticamente de la siguiente manera, entre dos matrices, <span class="math notranslate nohighlight">\(H\in R^{m\times m}\)</span> e <span class="math notranslate nohighlight">\(I\in\mathbb{R}^{l\times l}\)</span></p>
<div class="math notranslate nohighlight">
\[
    O(i, j)=\sum_{t=1}^{m}\sum_{r=1}^{m}h(t, r)I(i+t-1, j+r-1),~\text{donde en este caso}~m&lt;l.
    \]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(I(i, j)\)</span> es la imagen original</p></li>
<li><p><span class="math notranslate nohighlight">\(O(i, j)\)</span> es la imagen filtrada</p></li>
<li><p><span class="math notranslate nohighlight">\(H=(h(t, r))_{1\leq t, r\leq m}\)</span> es la matriz kernel</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Dependiendo del tipo de kernel <span class="math notranslate nohighlight">\(H\)</span>, la imagen resultante variará. El código en <code class="docutils literal notranslate"><span class="pre">Python</span></code> para la conversión es el siguiente</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/rs3.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kernel:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">kernel</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">3d</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">row</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kernel:
 -1  -1  -1
  2   2   2
 -1  -1  -1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blurimg</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blurimg</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Filtrada&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/872c2ab87fa3de148b78750b5168d7e9348ec652a1069b5654944d88d3409ef2.png" src="_images/872c2ab87fa3de148b78750b5168d7e9348ec652a1069b5654944d88d3409ef2.png" />
</div>
</div>
<ul class="simple">
<li><p>En la línea de código anterior, podemos interpretar la función <code class="docutils literal notranslate"><span class="pre">cv2.filter2D(gray,</span> <span class="pre">-1,</span> <span class="pre">kernel)</span></code> de la siguiente forma</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.filter2D(src,</span> <span class="pre">ddepth,</span> <span class="pre">kernel)</span></code>: Aplica un <em><strong>filtro convolucional a una imagen</strong></em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>: <em><strong>Imagen de entrada</strong></em> sobre la cual se aplica la convolución. En este caso, es la imagen en escala de grises <code class="docutils literal notranslate"><span class="pre">gray</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ddepth</span></code>: <em><strong>Profundidad deseada de la imagen de destino</strong></em>. Aquí se usa -1, lo que indica que la <em><strong>profundidad de la imagen de destino será la misma que la de la imagen de entrada</strong></em>. Otras opciones: <code class="docutils literal notranslate"><span class="pre">cv2.CV_8U,</span> <span class="pre">cv2.CV_16U,</span> <span class="pre">cv2.CV_16S,</span> <span class="pre">cv2.CV_32F,</span> <span class="pre">cv2.CV_64F</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernel</span></code>: La <em><strong>matriz de convolución (o filtro)</strong></em> que se aplica a la imagen. En este caso, es <code class="docutils literal notranslate"><span class="pre">np.array([[-1,</span> <span class="pre">-1,</span> <span class="pre">-1],</span> <span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">2],</span> <span class="pre">[-1,</span> <span class="pre">-1,</span> <span class="pre">-1]])</span></code>.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>A la <em><strong>izquierda se encuentra la imagen de entrada</strong></em> y a la <em><strong>derecha la imagen obtenida aplicando un kernel horizontal</strong></em>. Un <em><strong>kernel horizontal detecta únicamente los bordes horizontales</strong></em>, visibles como líneas blancas horizontales. La operación de <em><strong>filtrado se clasifica en</strong></em> tres categorías: <em><strong>suavizado de imagen, gradiente y afilado</strong></em>.</p></li>
</ul>
</section>
<section id="suavizado-de-imagen">
<h2>Suavizado de imagen<a class="headerlink" href="#suavizado-de-imagen" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>El <em><strong>suavizado de imágenes</strong></em> se emplea para <em><strong>eliminar el ruido de alta frecuencia mediante</strong></em> filtros de paso bajo, tales como:</p>
<ul>
<li><p>Filtro de la media</p></li>
<li><p>Filtro de la mediana</p></li>
<li><p>Filtro gaussiano</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>La principal diferencia entre filtros y operaciones puntuales radica en que <em><strong>los filtros suelen utilizar múltiples píxeles de la imagen original para calcular cada nuevo valor de píxel</strong></em>.</p></li>
</ul>
<ul class="simple">
<li><p><em><strong><code class="docutils literal notranslate"><span class="pre">Filtro</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">media</span></code></strong></em>: Una estrategia inicial para suavizar una imagen consiste en <em><strong>reemplazar cada píxel por el promedio de los píxeles circundantes</strong></em>. Para calcular el nuevo valor del píxel en la imagen suavizada <span class="math notranslate nohighlight">\(I'(u, v)\)</span>, <em><strong>se toma el píxel original</strong></em> <span class="math notranslate nohighlight">\(I(u, v) = p_0\)</span> <em><strong>en la misma posición junto con sus ocho píxeles vecinos</strong></em> <span class="math notranslate nohighlight">\(p_1, p_2, \ldots, p_8\)</span> para obtener la <em><strong>media aritmética</strong></em> de estos nueve valores</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
I'(u, v)\longleftarrow\frac{p_{0}+p_{1}+p_{2}+p_{3}+p_{4}+p_{5}+p_{6}+p_{7}+p_{8}}{9}
\]</div>
<ul class="simple">
<li><p>Expresado en <em><strong>coordenadas relativas de la imagen</strong></em>, esto es</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-mean-linear-filter">
<span class="eqno">(72)<a class="headerlink" href="#equation-mean-linear-filter" title="Link to this equation">#</a></span>\[\begin{split}
\begin{align*}
I'(u, v)\longleftarrow\frac{1}{9}\cdot&amp;\left[I(u-1, v-1)+I(u, v-1)+I(u+1, v-1)\right.\\
&amp;~I(u-1, v)+I(u, v)+I(u+1, v)\\[2mm]
&amp;~\left.I(u-1, v+1)+I(u, v+1)+I(u+1, v+1)\right]
\end{align*}
\end{split}\]</div>
<ul class="simple">
<li><p>Podemos expresarlo de <em><strong>manera más compacta en la forma</strong></em></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-kernel3x3-meanfilter">
<span class="eqno">(73)<a class="headerlink" href="#equation-kernel3x3-meanfilter" title="Link to this equation">#</a></span>\[
I'(u, v)\longleftarrow\frac{1}{9}\sum_{j=-1}^{1}\sum_{i=-1}^{1}I(u+i, v+j).
\]</div>
<ul class="simple">
<li><p>Este promedio local simple ya presenta todos los elementos fundamentales de un filtro típico. <em><strong>En particular, se trata de un filtro lineal, una clase muy relevante de filtros</strong></em>.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>El <em><strong>tamaño de la región del filtro</strong></em> es un parámetro crucial, ya que <em><strong>define la cantidad de píxeles originales que influyen en el valor de cada píxel resultante</strong></em>, determinando así la extensión espacial del filtro.</p></li>
<li><p>Por ejemplo, el filtro de suavizado descrito en la Ecuación <a class="reference internal" href="#equation-mean-linear-filter">(72)</a> utiliza una región de <span class="math notranslate nohighlight">\(3\times 3\)</span> <em><strong>píxeles centrada en la coordenada actual</strong></em> <span class="math notranslate nohighlight">\((u, v)\)</span>. Filtros similares con soporte mayor, como <span class="math notranslate nohighlight">\(5\times 5\)</span>, <span class="math notranslate nohighlight">\(7\times 7\)</span> o incluso <span class="math notranslate nohighlight">\(21\times 21\)</span> píxeles, tendrían <em><strong>efectos de suavizado más pronunciados</strong></em>.</p></li>
</ul>
</div>
</section>
<section id="filtros-lineales">
<h2>Filtros Lineales<a class="headerlink" href="#filtros-lineales" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los <em><strong>filtros lineales</strong></em> reciben su nombre porque <em><strong>combinan los valores de los píxeles en la región de soporte de manera lineal</strong></em>, es decir, mediante una <em><strong>suma ponderada</strong></em>. El proceso de promediado local, descrito inicialmente (Ecuación <a class="reference internal" href="#equation-kernel3x3-meanfilter">(73)</a>), es un caso particular, donde los <em><strong>nueve píxeles en la región de soporte 3 × 3 se suman con pesos idénticos (1/9)</strong></em>. Utilizando el mismo mecanismo, se pueden definir diversos filtros con diferentes características simplemente <em><strong>modificando la distribución de los pesos individuales</strong></em></p></li>
</ul>
</section>
<section id="el-filtro-kernel">
<h2>El filtro Kernel<a class="headerlink" href="#el-filtro-kernel" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para cualquier filtro lineal, el <em><strong>tamaño y la forma de la región de soporte, así como los pesos individuales de los píxeles, están determinados por el “kernel del filtro”</strong></em> o “matriz de filtro” <span class="math notranslate nohighlight">\(H(i, j)\)</span>. El tamaño del núcleo <span class="math notranslate nohighlight">\(H\)</span> coincide con el tamaño de la región del filtro, y cada elemento <span class="math notranslate nohighlight">\(H(i, j)\)</span> especifica el peso del píxel correspondiente en la suma. Por ejemplo, para un filtro de suavizado 3 × 3, el núcleo del filtro es:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
H = \frac{1}{9} \begin{bmatrix} 1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; 1 \end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>En principio, el kernel del filtro <span class="math notranslate nohighlight">\(H(i, j)\)</span> es, al igual que la imagen misma, una <em><strong>función discreta bidimensional de valores reales</strong></em>, <span class="math notranslate nohighlight">\(H:\mathbb{Z}\times\mathbb{Z} \longrightarrow\mathbb{R}\)</span>. El filtro posee su propio sistema de coordenadas con el origen—frecuentemente llamado “hot spot” que generalmente se encuentra en el centro, aunque no necesariamente. Por lo tanto, las <em><strong>coordenadas del filtro son generalmente positivas y negativas</strong></em>. La <em><strong>función del filtro</strong></em> se extiende infinitamente y <em><strong>se considera cero fuera de la región definida por la matriz</strong></em> <span class="math notranslate nohighlight">\(H\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/bridge_noisy.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">mean_filtered_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">image_arr</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
H = \frac{1}{9} \begin{bmatrix} 1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; 1 \end{bmatrix}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Ruidosa&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_arr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen con Filtro de Media&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mean_filtered_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3700a99735f45f61c6d0be6a9968fd0f631a723722a3670fe98a3b73d01c4cdf.png" src="_images/3700a99735f45f61c6d0be6a9968fd0f631a723722a3670fe98a3b73d01c4cdf.png" />
</div>
</div>
</section>
<section id="aplicacion-del-filtro">
<h2>Aplicación del Filtro<a class="headerlink" href="#aplicacion-del-filtro" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para un <em><strong>filtro lineal, el resultado se define claramente por los coeficientes de la matriz del filtro</strong></em>. Aplicar el filtro a una imagen es un proceso sencillo, como se ilustra en la <a class="reference internal" href="#filter2d-operation-hotspot-fig"><span class="std std-numref">Fig. 75</span></a>. Los siguientes pasos se realizan en cada posición de la imagen <span class="math notranslate nohighlight">\((u, v)\)</span></p>
<ol class="arabic simple">
<li><p>El filtro kernel <span class="math notranslate nohighlight">\(H\)</span> <em><strong>se desplaza sobre la imagen original</strong></em> <span class="math notranslate nohighlight">\(I\)</span>, de manera que <em><strong>su origen</strong></em> <span class="math notranslate nohighlight">\(H(0, 0)\)</span> <em><strong>coincida con la posición actual de la imagen</strong></em> <span class="math notranslate nohighlight">\((u, v)\)</span>.</p></li>
<li><p>Todos los <em><strong>coeficientes del filtro</strong></em> <span class="math notranslate nohighlight">\(H(i, j)\)</span> <em><strong>se multiplican por el elemento de la imagen correspondiente</strong></em> <span class="math notranslate nohighlight">\(I(u+i, v+j)\)</span>, y <em><strong>se suman los resultados</strong></em>.</p></li>
<li><p>Finalmente, <em><strong>la suma resultante se almacena en la posición actual de la nueva imagen</strong></em> <span class="math notranslate nohighlight">\(I'(u, v)\)</span>.</p></li>
</ol>
</li>
</ul>
<figure class="align-center" id="filter2d-operation-hotspot-fig">
<img alt="_images/filter2D_operation_hotspot.png" src="_images/filter2D_operation_hotspot.png" />
<figcaption>
<p><span class="caption-number">Fig. 75 </span><span class="caption-text">Operación de filtro lineal. El kernel <span class="math notranslate nohighlight">\(H\)</span> se coloca con su origen en la posición <span class="math notranslate nohighlight">\((u, v)\)</span> sobre la imagen <span class="math notranslate nohighlight">\(I\)</span>.</span><a class="headerlink" href="#filter2d-operation-hotspot-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul>
<li><p>Describiendo formalmente, <em><strong>los valores de los píxeles de la nueva imagen</strong></em> <span class="math notranslate nohighlight">\(I'(u, v)\)</span> <em><strong>se calculan mediante la operación</strong></em></p>
<div class="math notranslate nohighlight">
\[
  I'(u, v)\longleftarrow\sum_{(i, j)\in R_{H}}I(u+i, v+j)H(i, j),
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(R_{H}\)</span> denota el conjunto de <em><strong>coordenadas cubiertas por el filtro</strong></em> <span class="math notranslate nohighlight">\(H\)</span>. Para un filtro típico de <span class="math notranslate nohighlight">\(3\times 3\)</span> con origen centrado, esto es</p>
<div class="math notranslate nohighlight">
\[
  I'(u, v)\longleftarrow\sum_{i=-1}^{1}\sum_{j=-1}^{1}I(u+i, v+j)H(i, j),
  \]</div>
<p>para todas las coordenadas de la imagen <span class="math notranslate nohighlight">\((u, v)\)</span>. No exactamente para todas las coordenadas.</p>
</li>
</ul>
<ul class="simple">
<li><p>Existe un problema evidente en los <em><strong>bordes de la imagen, donde el filtro se extiende más allá de los límites de la imagen y no encuentra valores de píxeles correspondientes para calcular un resultado</strong></em> (ver <em>Handling Image Borders</em> <span id="id1">[<a class="reference internal" href="biblio.html#id58" title="W. Burger and M.J. Burge. Digital Image Processing: An Algorithmic Introduction Using Java. Texts in Computer Science. Springer London, 2016. ISBN 9781447166849. URL: https://books.google.com.co/books?id=YpzWCwAAQBAJ.">Burger and Burge, 2016</a>]</span>)</p></li>
</ul>
</section>
<section id="filtro-gaussiano">
<h2>Filtro Gaussiano<a class="headerlink" href="#filtro-gaussiano" title="Link to this heading">#</a></h2>
<ul>
<li><p>La matriz de este <em><strong>filtro de suavizado</strong></em> corresponde a una <em><strong>función Gaussiana</strong></em> en 2D</p>
<div class="math notranslate nohighlight">
\[
  H^{G, \sigma}(x, y)=e^{-(x^{2}+y^{2})/2\sigma^{2}}
  \]</div>
<p>donde <span class="math notranslate nohighlight">\(\sigma\)</span> denota el ancho (<em>desviación estándar</em>) de la función en forma de campana (<em>distribución normal</em>) y <span class="math notranslate nohighlight">\(r\)</span> representa la distancia (radio) desde el centro.</p>
</li>
</ul>
<figure class="align-center" id="gaussian-filter-image-fig">
<a class="reference internal image-reference" href="_images/gaussian_filter_image.png"><img alt="_images/gaussian_filter_image.png" src="_images/gaussian_filter_image.png" style="width: 183.0px; height: 224.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 76 </span><span class="caption-text">Filtro de suavización Gausiano, con cada uno de su coeficientes positivos.</span><a class="headerlink" href="#gaussian-filter-image-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>El <em><strong>píxel en el centro recibe el peso máximo</strong></em> (1.0, escalado al valor entero 9 en la matriz mostrada en la <a class="reference internal" href="#gaussian-filter-image-fig"><span class="std std-numref">Fig. 76</span></a>), y <em><strong>los coeficientes restantes disminuyen suavemente con la distancia del centro</strong></em>. Como filtro de paso bajo, el Gaussiano es “bien comportado” en el espacio de frecuencias. El <em><strong>filtro Gaussiano en 2D es separable en un par de filtros en 1D</strong></em>, lo que facilita su implementación eficiente.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/fishing_boat_noisy.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">blurred_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Original&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Filtrada con Filtro Gaussiano&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">blurred_image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf6c2e106656bcd4cac81ab0dacfb5f09d5344371a63359cdea6bdab2f5c2a01.png" src="_images/cf6c2e106656bcd4cac81ab0dacfb5f09d5344371a63359cdea6bdab2f5c2a01.png" />
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cv2.GaussianBlur</span></code>: Aplica un <em><strong>filtro Gaussiano a la imagen para suavizarla</strong></em>. El filtro Gaussiano es un tipo de filtro de paso bajo que reduce el ruido y las irregularidades en la imagen.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(5,</span> <span class="pre">5)</span></code>: Especifica el <em><strong>tamaño del kernel del filtro Gaussiano</strong></em>. Los valores en el kernel se generan según la función Gaussiana, y la imagen se suaviza con base en estos valores. Un tamaño de kernel más grande generalmente proporciona un mayor suavizado.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code>: Especifica el valor de la <em><strong>desviación estándar</strong></em> (<span class="math notranslate nohighlight">\(\sigma\)</span>) del filtro Gaussiano. Cuando se establece en 0, <code class="docutils literal notranslate"><span class="pre">OpenCV</span></code> <em><strong>calcula el sigma basado en el tamaño del kernel proporcionado</strong></em>. Un sigma más grande implica un mayor grado de suavizado. Si se proporciona un valor específico en lugar de 0, se usaría ese sigma para el filtro.</p></li>
</ul>
</section>
<section id="filtro-de-la-mediana">
<h2>Filtro de la mediana<a class="headerlink" href="#filtro-de-la-mediana" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Es <em><strong>imposible diseñar un filtro que elimine todo el ruido sin afectar las estructuras importantes de la imagen</strong></em>, ya que ningún filtro puede discernir qué contenido es importante para el espectador y cuál no lo es. El popular <em><strong>filtro de la mediana</strong></em> es, al menos, un buen avance en esta dirección. El filtro de mediana <em><strong>reemplaza cada píxel de la imagen por la mediana de los píxeles en la región del filtro actual</strong></em> <span class="math notranslate nohighlight">\(R\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
I'(u, v)=\textsf{median}_{(i, j)\in R}\{I(u+i, v+j)\}.
\]</div>
<ul>
<li><p>La mediana de un conjunto de <span class="math notranslate nohighlight">\(2n+1\)</span> valores <span class="math notranslate nohighlight">\(A = {a_{0}, \dots, a_{2n}}\)</span> o <span class="math notranslate nohighlight">\(2n\)</span> valores <span class="math notranslate nohighlight">\(A = {a_{0}, \dots, a_{2n-1}}\)</span> se define como el <em><strong>valor central an después de ordenar</strong></em> <span class="math notranslate nohighlight">\(A\)</span> <em><strong>en una secuencia</strong></em></p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \begin{align*}
  \textsf{median}(\underbrace{a_{0}, a_{1}, \dots, a_{n-1}}_{n-\text{values}}, a_{n}, \underbrace{a_{n+1}, \dots, a_{2n}}_{n-\text{values}})&amp;=a_{n}\\
  \textsf{median}(\underbrace{a_{0}, a_{1}, \dots, a_{n-1}}_{n-\text{values}}, \underbrace{a_{n}, \dots, a_{2n-1}}_{n-\text{values}})&amp;=\frac{a_{n-1}+a_{n}}{2}
  \end{align*}
  \end{split}\]</div>
<p>donde <span class="math notranslate nohighlight">\(a_{i}\leq a_{i+1}\)</span>.</p>
</li>
</ul>
<figure class="align-center" id="median-filter-example-fig">
<a class="reference internal image-reference" href="_images/median_filter_example.jpg"><img alt="_images/median_filter_example.jpg" src="_images/median_filter_example.jpg" style="width: 755.3px; height: 273.7px;" /></a>
</figure>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/fishing_boat_noisy.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">class</span> <span class="nc">FilterMedian</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">radius</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pixels</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pixels</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">pixels</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">filtered_pixels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pixels</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">pixels</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">pixels</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">filtered_pixels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">pixels</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported image format&quot;</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">M</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">pixels</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                            <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">u</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span>
                            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">A</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                    <span class="n">filtered_pixels</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">pixels</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                                <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">u</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
                                <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">C</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
                        <span class="n">A</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                        <span class="n">filtered_pixels</span><span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>

        <span class="n">filtered_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">filtered_pixels</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">filtered_img</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    
    <span class="n">filter_median</span> <span class="o">=</span> <span class="n">FilterMedian</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">filtered_img</span> <span class="o">=</span> <span class="n">filter_median</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Original&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Imagen Filtrada con Filtro Gaussiano&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">filtered_img</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/608df7da2ca29244a7894d26e5e1cee492ec930ffb6c02303a30669ec1fd0b0a.png" src="_images/608df7da2ca29244a7894d26e5e1cee492ec930ffb6c02303a30669ec1fd0b0a.png" />
</div>
</div>
</section>
<section id="filtrado-de-imagenes-con-opencv">
<h2>Filtrado de imágenes con OpenCV<a class="headerlink" href="#filtrado-de-imagenes-con-opencv" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Para comprender mejor los conceptos de filtrado de imágenes, se puede aplicar un filtro a una imagen real usando un método proporcionado por <code class="docutils literal notranslate"><span class="pre">OpenCV</span></code>. El código relevante se muestra a continuación. Tras <em><strong>importar la imagen, añadimos ruido</strong></em>, ya que sin él, el efecto del filtrado no se visualiza adecuadamente.</p></li>
<li><p>Luego, debemos guardar la imagen. Aunque esto no es necesario para los filtros de media y Gaussiano, si no guardamos la imagen con el filtro de mediana e intentamos importarla nuevamente, <code class="docutils literal notranslate"><span class="pre">Python</span></code> muestra un error. Después de esto, aplicamos los filtros <code class="docutils literal notranslate"><span class="pre">blur,</span> <span class="pre">medianBlur</span></code> y <code class="docutils literal notranslate"><span class="pre">GaussianBlur</span></code> para transformar la imagen.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">skimage.util</span> <span class="kn">import</span> <span class="n">random_noise</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/house.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imgnoise</span> <span class="o">=</span> <span class="n">random_noise</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;s&amp;p&#39;</span><span class="p">,</span> <span class="n">amount</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imsave</span><span class="p">(</span><span class="s2">&quot;car2.jpg&quot;</span><span class="p">,</span> <span class="n">imgnoise</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imgnew</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;car2.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meanimg</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">imgnew</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">medianimg</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">imgnew</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">gaussianimg</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">imgnew</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">imgnew</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen con Ruido&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">meanimg</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtro Media&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">medianimg</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtro Mediana&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">gaussianimg</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Filtro Gaussiano&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f975a078aebceb0c50394133877cb22d3932b9f97e1fd898d405b4306a2617fc.png" src="_images/f975a078aebceb0c50394133877cb22d3932b9f97e1fd898d405b4306a2617fc.png" />
</div>
</div>
</section>
<section id="deteccion-de-bordes-basada-en-gradientes">
<h2>Detección de bordes basada en gradientes<a class="headerlink" href="#deteccion-de-bordes-basada-en-gradientes" title="Link to this heading">#</a></h2>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>Los <em><strong>bordes se describen como posiciones en una imagen donde la intensidad local varía significativamente en una orientación específica</strong></em>. A mayor cambio en la intensidad local, mayor es la evidencia de un borde en esa posición. Matemáticamente, <em><strong>la cantidad de cambio en relación con la distancia espacial se conoce como la primera derivada de una función</strong></em>, y a partir de este concepto se desarrolla el primer detector de bordes simple.</p></li>
</ul>
</div>
<ul>
<li><p>Para simplificar, primero <em><strong>investigamos la situación en una sola dimensión</strong></em>, asumiendo que la imagen contiene una <em><strong>región brillante en el centro rodeada de un fondo oscuro</strong></em> (<a class="reference internal" href="#gradient-edge-detection-fig"><span class="std std-numref">Fig. 77</span></a>(a)). En este caso, el perfil de intensidad a lo largo de una línea de la imagen se asemejaría a la función unidimensional <span class="math notranslate nohighlight">\(f(x)\)</span>, como se muestra en la <a class="reference internal" href="#gradient-edge-detection-fig"><span class="std std-numref">Fig. 77</span></a>(b). Al tomar la primera derivada de la función <span class="math notranslate nohighlight">\(f\)</span></p>
<div class="math notranslate nohighlight">
\[
  f'(x)=\frac{df}{dx}(x)
  \]</div>
<p>resulta en un <em><strong>aumento positivo en las posiciones donde la intensidad crece</strong></em> y una <em><strong>disminución negativa donde la función disminuye</strong></em> (<a class="reference internal" href="#gradient-edge-detection-fig"><span class="std std-numref">Fig. 77</span></a>(c)).</p>
</li>
</ul>
<figure class="align-center" id="gradient-edge-detection-fig">
<a class="reference internal image-reference" href="_images/gradient_edge_detection.png"><img alt="_images/gradient_edge_detection.png" src="_images/gradient_edge_detection.png" style="width: 672.0px; height: 267.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 77 </span><span class="caption-text">Imagen de muestra y primera derivada en una dimensión.</span><a class="headerlink" href="#gradient-edge-detection-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul>
<li><p>A diferencia del caso continuo, <em><strong>la primera derivada no está definida para una función discreta</strong></em> <span class="math notranslate nohighlight">\(f(u)\)</span> (como el perfil de línea de una imagen real), por lo que se requiere un método para estimarla. En la <a class="reference internal" href="#first-derivate-estimation-fig"><span class="std std-numref">Fig. 78</span></a> se muestra la idea básica para el caso unidimensional: la primera derivada de una función continua en la posición <span class="math notranslate nohighlight">\(x\)</span> se puede interpretar como la <em><strong>pendiente de la tangente en ese punto</strong></em>.</p></li>
<li><p>Un método simple para <em><strong>aproximar la pendiente de la tangente en una función discreta</strong></em> <span class="math notranslate nohighlight">\(f(u)\)</span> es <em><strong>ajustar una línea recta a través de los valores vecinos</strong></em> <span class="math notranslate nohighlight">\(f(u-1)\)</span> y <span class="math notranslate nohighlight">\(f(u+1)\)</span></p>
<div class="math notranslate nohighlight">
\[
  \frac{df}{dx}(u)\approx\frac{f(u+1)-f(u-1)}{(u+1)-(u-1)}=\frac{f(u+1)-f(u-1)}{2}.
  \]</div>
</li>
</ul>
<ul class="simple">
<li><p>Por supuesto, el mismo método puede aplicarse en la <em><strong>dirección vertical</strong></em> para <em><strong>estimar la primera derivada a lo largo del eje</strong></em> <span class="math notranslate nohighlight">\(y\)</span>, es decir, a lo largo de las columnas de la imagen.</p></li>
</ul>
<figure class="align-center" id="first-derivate-estimation-fig">
<a class="reference internal image-reference" href="_images/first_derivate_estimation.png"><img alt="_images/first_derivate_estimation.png" src="_images/first_derivate_estimation.png" style="width: 658.1999999999999px; height: 256.8px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 78 </span><span class="caption-text">Estimación de la primera derivada de una función discreta.</span><a class="headerlink" href="#first-derivate-estimation-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="derivadas-parciales-y-el-gradiente">
<h2>Derivadas Parciales y el Gradiente<a class="headerlink" href="#derivadas-parciales-y-el-gradiente" title="Link to this heading">#</a></h2>
<ul>
<li><p>Una derivada de una función multidimensional calculada a lo largo de uno de sus ejes coordenados se denomina derivada parcial. Por ejemplo,</p>
<div class="math notranslate nohighlight">
\[
  I_{x}=\frac{\partial I}{\partial x}(u, v)~\text{and}~I_{y}=\frac{\partial I}{\partial y}(u, v)
  \]</div>
<p>las <em><strong>derivadas parciales de la función de imagen</strong></em> <span class="math notranslate nohighlight">\(2D\)</span> <span class="math notranslate nohighlight">\(I(u, v)\)</span> respecto a los ejes <span class="math notranslate nohighlight">\(u\)</span> y <span class="math notranslate nohighlight">\(v\)</span> son, respectivamente, las <em><strong>derivadas parciales a lo largo de dichos ejes</strong></em>. El vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \nabla I(u, v)=
  \begin{bmatrix}
  I_{x}(u, v)\\
  I_{y}(u, v)
  \end{bmatrix}=
  \begin{bmatrix}
  \displaystyle{\frac{\partial I}{\partial x}}(u, v)\\
  \displaystyle{\frac{\partial I}{\partial y}}(u, v)
  \end{bmatrix}
  \end{split}\]</div>
<p>se denomina <em><strong>gradiente de la función</strong></em> <span class="math notranslate nohighlight">\(I\)</span> en la posición <span class="math notranslate nohighlight">\((u, v)\)</span>. La <em><strong>magnitud del gradiente</strong></em>,</p>
<div class="math notranslate nohighlight" id="equation-gradient-magnitude-def">
<span class="eqno">(74)<a class="headerlink" href="#equation-gradient-magnitude-def" title="Link to this equation">#</a></span>\[
  |\nabla I|=\sqrt{I_{x}^{2}+I_{y}^{2}},
  \]</div>
<p>es <em><strong>invariante a la rotación de la imagen</strong></em>, lo que la hace independiente de la orientación de las estructuras subyacentes. Esta característica es <em><strong>crucial para la localización isotrópica de bordes</strong></em>, y por ello, <span class="math notranslate nohighlight">\(|\nabla I|\)</span> es <em><strong>fundamental en numerosos métodos prácticos de detección de bordes</strong></em>.</p>
</li>
<li><p>La dirección del vector gradiente está dada por el angulo</p>
<div class="math notranslate nohighlight">
\[
  \alpha(u, v)=\tan^{-1}\left[\frac{I_{y}}{I_{x}}\right]
  \]</div>
<p>medido con respecto al eje <span class="math notranslate nohighlight">\(u\)</span>.</p>
</li>
</ul>
</section>
<section id="derivadas-direccionales-y-mascaras-2d">
<h2>Derivadas Direccionales y Máscaras 2D<a class="headerlink" href="#derivadas-direccionales-y-mascaras-2d" title="Link to this heading">#</a></h2>
<ul>
<li><p>La <a class="reference internal" href="#gradient-vector-edge-dir-fig"><span class="std std-numref">Fig. 79</span></a>(a) muestra una <em><strong>sección ampliada de una imagen con un segmento de borde recto</strong></em>. Cada cuadrado representa un píxel; los píxeles <em><strong>grises tienen valor 0 y los blancos, valor 1</strong></em>. Estamos interesados en <em><strong>determinar la intensidad y dirección del borde en el punto destacado con un recuadro</strong></em>.</p></li>
<li><p>Un método para calcular las derivadas en las direcciones <span class="math notranslate nohighlight">\(u\)</span> y <span class="math notranslate nohighlight">\(v\)</span> en un vecindario de <span class="math notranslate nohighlight">\(3\times 3\)</span> centrado en un punto es simplemente <em><strong>restar los píxeles de la fila superior de los de la fila inferior</strong></em> para obtener la derivada parcial en la dirección <span class="math notranslate nohighlight">\(u\)</span>. De manera similar, se <em><strong>restan los píxeles de la columna izquierda de los de la columna derecha para obtener la derivada parcial en la dirección</strong></em> <span class="math notranslate nohighlight">\(v\)</span>. Entonces</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \nabla I=
  \begin{bmatrix}
  I_{x}(u, v)\\
  I_{y}(u, v)
  \end{bmatrix}=
  \begin{bmatrix}
  \displaystyle{\frac{\partial I}{\partial x}}(u, v)\\
  \displaystyle{\frac{\partial I}{\partial y}}(u, v)
  \end{bmatrix}=
  \begin{bmatrix}
  -2\\
  2
  \end{bmatrix}
  \end{split}\]</div>
<p>además, obtenemos <span class="math notranslate nohighlight">\(|\nabla I(u, v)| = 2\sqrt{2}\)</span> en ese punto. De manera similar, la <em><strong>dirección del vector gradiente</strong></em> en el mismo punto es <span class="math notranslate nohighlight">\(\alpha(u, v) = \tan^{-1}(I_{v}/I_{u}) = -45^{\circ}\)</span>, lo cual equivale a <span class="math notranslate nohighlight">\(135^{\circ}\)</span> medidos en dirección positiva con respecto al eje <span class="math notranslate nohighlight">\(u\)</span>.</p>
</li>
</ul>
<figure class="align-center" id="gradient-vector-edge-dir-fig">
<a class="reference internal image-reference" href="_images/gradient_vector_edge_dir.png"><img alt="_images/gradient_vector_edge_dir.png" src="_images/gradient_vector_edge_dir.png" style="width: 600.0px; height: 214.20000000000002px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 79 </span><span class="caption-text">Uso del gradiente para determinar la <em><strong>intensidad</strong></em> y <em><strong>dirección del borde</strong></em> en un punto.</span><a class="headerlink" href="#gradient-vector-edge-dir-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul>
<li><p>Para obtener el <em><strong>gradiente de una imagen</strong></em>, es necesario <em><strong>calcular las derivadas parciales</strong></em> <span class="math notranslate nohighlight">\(\partial f/\partial x\)</span> y <span class="math notranslate nohighlight">\(\partial f/\partial y\)</span> <em><strong>en cada píxel</strong></em>. Como trabajamos con datos digitales, se requiere una <em><strong>aproximación digital de estas derivadas en el entorno de un punto</strong></em>. Sabemos de los cursos de Cálculo que</p>
<div class="math notranslate nohighlight" id="equation-digital-derivat-respu">
<span class="eqno">(75)<a class="headerlink" href="#equation-digital-derivat-respu" title="Link to this equation">#</a></span>\[
  I_{x}=\frac{\partial I(u, v)}{\partial u}=I(u+1, v)-I(u, v)
  \]</div>
<div class="math notranslate nohighlight" id="equation-digital-derivat-respv">
<span class="eqno">(76)<a class="headerlink" href="#equation-digital-derivat-respv" title="Link to this equation">#</a></span>\[
  I_{x}=\frac{\partial I(u, v)}{\partial v}=I(u, v+1)-I(u, v)
  \]</div>
</li>
</ul>
<figure class="align-center" id="masks-first-derivate-1d-fig">
<a class="reference internal image-reference" href="_images/masks_first_derivate_1D.png"><img alt="_images/masks_first_derivate_1D.png" src="_images/masks_first_derivate_1D.png" style="width: 184.8px; height: 93.2px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 80 </span><span class="caption-text">Máscaras unidimensionales utilizadas para implementar las Ecuaciones <a class="reference internal" href="#equation-digital-derivat-respu">(75)</a> y <a class="reference internal" href="#equation-digital-derivat-respu">(75)</a>.</span><a class="headerlink" href="#masks-first-derivate-1d-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul>
<li><p>Cuando se requiere <em><strong>detectar direcciones de borde diagonal</strong></em>, es necesario utilizar una <em><strong>máscara 2D</strong></em>. Los operadores de <em><strong>gradiente cruzado de Roberts</strong></em> <span id="id2">[<a class="reference internal" href="biblio.html#id59" title="PHILOSO EPHY DO CT OR OF. MACHINE PERCEPTION OF THREE-DIMENSIONAL, SO LIDS. PhD thesis, MASSACHUSETTS INSTITUTE OF TECHNOLOGY, 1961.">DO CT OR OF, 1961</a>]</span> fueron uno de los primeros intentos de emplear máscaras 2D con preferencia diagonal. Considere la región <span class="math notranslate nohighlight">\(3\times 3\)</span> en la <a class="reference internal" href="#robert-prewitt-sobel-masks-fig"><span class="std std-numref">Fig. 81</span></a>. Los <em><strong>operadores de Roberts se basan en calcular diferencias diagonales</strong></em></p>
<div class="math notranslate nohighlight">
\[
  I_{x}=\frac{\partial I}{\partial x}=(z_{9}-z_{5})
  \]</div>
<div class="math notranslate nohighlight">
\[
  I_{y}=\frac{\partial I}{\partial y}=(z_{8}-z_{6})
  \]</div>
</li>
</ul>
<figure class="align-center" id="robert-prewitt-sobel-masks-fig">
<img alt="_images/robert_prewitt_sobel_masks.png" src="_images/robert_prewitt_sobel_masks.png" />
<figcaption>
<p><span class="caption-number">Fig. 81 </span><span class="caption-text">Región <span class="math notranslate nohighlight">\(3\times 3\)</span> de una imagen (donde las <span class="math notranslate nohighlight">\(z\)</span> representan <em><strong>valores de intensidad</strong></em>) y <em><strong>diferentes máscaras utilizadas para calcular el gradiente</strong></em> en el punto etiquetado como <span class="math notranslate nohighlight">\(z_5\)</span>.</span><a class="headerlink" href="#robert-prewitt-sobel-masks-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Estas derivadas pueden obtenerse aplicando un <em><strong>filtro a la imagen con las máscaras mostradas en</strong></em> <a class="reference internal" href="#robert-prewitt-sobel-masks-fig"><span class="std std-numref">Fig. 81</span></a>-Roberts. El punto central, <span class="math notranslate nohighlight">\(z_{5}\)</span>, representa <span class="math notranslate nohighlight">\(I(u, v)\)</span> en una ubicación arbitraria <span class="math notranslate nohighlight">\((u, v)\)</span>; <span class="math notranslate nohighlight">\(z_{1}\)</span> representa <span class="math notranslate nohighlight">\(I(u - 1, v - 1)\)</span>; y así sucesivamente, utilizando la notación previamente introducida en <a class="reference internal" href="#robert-prewitt-sobel-masks-fig"><span class="std std-numref">Fig. 81</span></a></p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Las <em><strong>máscaras de tamaño <span class="math notranslate nohighlight">\(2\times 2\)</span> son conceptualmente simples</strong></em>, pero <em><strong>no son tan útiles para calcular la dirección de los bordes como las máscaras simétricas respecto al punto central, las más pequeñas de las cuales son de tamaño</strong></em> <span class="math notranslate nohighlight">\(3\times 3\)</span>. Estas últimas consideran la naturaleza de los datos en los lados opuestos del punto central, aportando así más información sobre la dirección de un borde.</p></li>
</ul>
</div>
<ul>
<li><p>Las aproximaciones digitales más simples a las <em><strong>derivadas parciales utilizando máscaras de tamaño</strong></em> <span class="math notranslate nohighlight">\(3\times 3\)</span> son proporcionadas por</p>
<div class="math notranslate nohighlight" id="equation-prewitt-masks-derivates">
<span class="eqno">(77)<a class="headerlink" href="#equation-prewitt-masks-derivates" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  I_{x} &amp;= \frac{\partial I}{\partial x}=(z_{7}+z_{8}+z_{9})-(z_{1}+z_{2}+z_{3})\\[2mm]
  I_{y} &amp;= \frac{\partial I}{\partial y}=(z_{3}+z_{6}+z_{9})-(z_{1}+z_{4}+z_{7})
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>En estas formulaciones, la <em><strong>diferencia entre la tercera y la primera fila de la región de</strong></em> <span class="math notranslate nohighlight">\(3\times 3\)</span> <em><strong>aproxima la derivada en la dirección</strong></em> <span class="math notranslate nohighlight">\(x\)</span>, y la diferencia entre la tercera y la primera columna aproxima la derivada en la dirección <span class="math notranslate nohighlight">\(y\)</span>. Intuitivamente, se espera que estas aproximaciones sean <em><strong>más precisas que las obtenidas con los operadores de Roberts</strong></em>. Las Ecuaciones <a class="reference internal" href="#equation-prewitt-masks-derivates">(77)</a> pueden aplicarse a toda la imagen filtrando <span class="math notranslate nohighlight">\(f\)</span> con las dos máscaras mostradas en las <a class="reference internal" href="#robert-prewitt-sobel-masks-fig"><span class="std std-numref">Fig. 81</span></a>-Prewitt. <em><strong>Estas máscaras se conocen como operadores de Prewitt</strong></em> <span id="id3">[<a class="reference internal" href="biblio.html#id60" title="Judith MS Prewitt and others. Object enhancement and extraction. Picture processing and Psychopictorics, 10(1):15–19, 1970.">Prewitt and others, 1970</a>]</span>.</p></li>
</ul>
<ul>
<li><p>Una ligera variación de las dos ecuaciones anteriores utiliza un coeficiente central con un peso de 2</p>
<div class="math notranslate nohighlight" id="equation-sobel-masks-derivates">
<span class="eqno">(78)<a class="headerlink" href="#equation-sobel-masks-derivates" title="Link to this equation">#</a></span>\[\begin{split}
  \begin{align*}
  I_{x} &amp;= \frac{\partial I}{\partial x}=(z_{7}+2z_{8}+z_{9})-(z_{1}+2z_{2}+z_{3})\\[2mm]
  I_{y} &amp;= \frac{\partial I}{\partial y}=(z_{3}+2z_{6}+z_{9})-(z_{1}+2z_{4}+z_{7})
  \end{align*}
  \end{split}\]</div>
</li>
</ul>
<ul class="simple">
<li><p>Estas máscaras se denominan <em><strong>operadores de Sobel</strong></em> <span id="id4">[<a class="reference internal" href="biblio.html#id61" title="Irwin Edward Sobel. Camera models and machine perception. stanford university, 1970.">Sobel, 1970</a>]</span>. Las máscaras de Prewitt son más simples de implementar que las de Sobel, pero la diferencia computacional entre ellas generalmente no es significativa. <em><strong>Las máscaras de Sobel son preferibles debido a sus mejores características de supresión de ruido</strong></em>, lo cual es crucial al trabajar con derivadas. Cabe destacar que los coeficientes de todas las máscaras en la <a class="reference internal" href="#robert-prewitt-sobel-masks-fig"><span class="std std-numref">Fig. 81</span></a>-Sobel suman cero, produciendo una respuesta nula en áreas de intensidad constante, como se espera de un operador derivativo.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Las máscaras mencionadas se utilizan para obtener los <em><strong>componentes del gradiente</strong></em> <span class="math notranslate nohighlight">\(I_x\)</span> y <span class="math notranslate nohighlight">\(I_y\)</span> <em><strong>en cada píxel de una imagen</strong></em>. Estos dos derivados parciales se emplean para <em><strong>estimar la fuerza y la dirección de los bordes</strong></em>. Calcular la magnitud del gradiente requiere combinar <span class="math notranslate nohighlight">\(I_x\)</span> y <span class="math notranslate nohighlight">\(I_y\)</span> como se muestra en la Ecuación <a class="reference internal" href="#equation-gradient-magnitude-def">(74)</a></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
M(x, y)=|\nabla I|\approx|I_{x}|+|I_{y}|.
\]</div>
</div>
<ul class="simple">
<li><p>Esta ecuación es computacionalmente más atractiva y <em><strong>conserva los cambios relativos en los niveles de intensidad</strong></em>. El costo de esta ventaja es que los filtros resultantes no serán isotrópicos (invariantes a la rotación) en general. Sin embargo, esto no es un problema cuando se utilizan máscaras como las de <em>Prewitt</em> y <em>Sobel</em> para calcular <span class="math notranslate nohighlight">\(I_{x}\)</span> e <span class="math notranslate nohighlight">\(I_{y}\)</span>, ya que <em><strong>estas máscaras solo producen resultados isotrópicos para bordes verticales y horizontales</strong></em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span> <span class="nn">skimage.util</span> <span class="kn">import</span> <span class="n">random_noise</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/house.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
<span class="n">gray</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sobelx</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">Sobel</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_64F</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> 
<span class="n">sobely</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">Sobel</span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CV_64F</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  

<span class="n">sobel_combined</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">magnitude</span><span class="p">(</span><span class="n">sobelx</span><span class="p">,</span> <span class="n">sobely</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sobel_combined</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">sobel_combined</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">NORM_MINMAX</span><span class="p">)</span>
<span class="n">sobel_combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">sobel_combined</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original Image&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sobel $x$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sobelx</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sobel $y$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sobely</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sobel Combined&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sobel_combined</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4f05f48b778b64a537e139a00f18e0487b1bde4e10a15cd06bdf12197f1b9fc1.png" src="_images/4f05f48b778b64a537e139a00f18e0487b1bde4e10a15cd06bdf12197f1b9fc1.png" />
</div>
</div>
</section>
<section id="extraccion-de-caracteristicas-de-una-imagen">
<h2>Extracción de características de una imagen<a class="headerlink" href="#extraccion-de-caracteristicas-de-una-imagen" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Tras aprender a detectar bordes, el siguiente paso es <em><strong>identificar características</strong></em>. Varios bordes forman características. La extracción de características consiste en <em><strong>reconocer patrones visuales en una imagen y extraer características locales discriminantes que coincidan con la imagen de un objeto desconocido</strong></em>.</p></li>
<li><p>Antes de realizar la extracción de características, es crucial comprender el <em><strong>histograma de la imagen</strong></em>, que es la <em><strong>distribución de la intensidad del color de la imagen</strong></em>. Una característica de la imagen coincide con la imagen de prueba si los histogramas son similares. El siguiente es el código es utilizado para <em><strong>crear un histograma de imagen</strong></em></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># L mode for grayscale, 0 for black</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">square_size</span> <span class="o">=</span> <span class="mi">40</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">width</span> <span class="o">-</span> <span class="n">square_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">square_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="n">height</span> <span class="o">-</span> <span class="n">square_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="n">height</span> <span class="o">+</span> <span class="n">square_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>  <span class="c1"># 255 for white</span>

<span class="n">histogram</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">histogram</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span> <span class="n">histogram</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histograma de píxeles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f81e84212d3ccd100150df0e761d01b40609bf64ba6f35f4a2d9316f18f3ce3.png" src="_images/1f81e84212d3ccd100150df0e761d01b40609bf64ba6f35f4a2d9316f18f3ce3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
<span class="n">pixels</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">red</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">green</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">blue</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>

<span class="n">square_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">square_size</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">square_size</span><span class="p">):</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[(</span><span class="n">i</span> <span class="o">//</span> <span class="n">square_size</span> <span class="o">+</span> <span class="n">j</span> <span class="o">//</span> <span class="n">square_size</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">square_size</span><span class="p">,</span> <span class="n">width</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">square_size</span><span class="p">,</span> <span class="n">height</span><span class="p">)):</span>
                <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>

<span class="n">histogram</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># Histograma para RGB, 256 niveles de cada color</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">pixels</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
        <span class="n">histogram</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">histogram</span><span class="p">[</span><span class="mi">256</span> <span class="o">+</span> <span class="n">g</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">histogram</span><span class="p">[</span><span class="mi">512</span> <span class="o">+</span> <span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># No mostrar ejes</span>

<span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">histogram</span><span class="p">[:</span><span class="mi">256</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rojo&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">histogram</span><span class="p">[</span><span class="mi">256</span><span class="p">:</span><span class="mi">512</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Verde&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">histogram</span><span class="p">[</span><span class="mi">512</span><span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Azul&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histograma de píxeles&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b65970e1de83a9e90ef5c7545db9b989a54c155b8d8a85d35f9da1d85a67b63b.png" src="_images/b65970e1de83a9e90ef5c7545db9b989a54c155b8d8a85d35f9da1d85a67b63b.png" />
</div>
</div>
<ul class="simple">
<li><p>El gráfico <em><strong>muestra barras en 0 y 255 porque todos los píxeles de la imagen son completamente rojos, verdes o azules, sin ningún valor intermedio</strong></em>. En otras palabras, <em><strong>cada canal de color (rojo, verde, azul) tiene solo valores extremos (0 o 255)</strong></em>. Para entender mejor, aquí está el desglose:</p>
<ul>
<li><p><em><strong>Valores en 0</strong></em>: Estos corresponden a los <em><strong>canales que no están activos en un píxel determinado</strong></em>. Por ejemplo, en <em><strong>un píxel rojo (255, 0, 0), los valores del canal verde y azul son 0</strong></em>.</p></li>
<li><p><em><strong>Valores en 255</strong></em>: Estos corresponden a los <em><strong>canales que están completamente activos</strong></em>. Por ejemplo, en <em><strong>un píxel rojo (255, 0, 0), el valor del canal rojo es 255</strong></em>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/fishing_boat.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>
<span class="n">gray_histogram</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">calcHist</span><span class="p">([</span><span class="n">gray_image</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>  <span class="c1"># Convertir de BGR a RGB para visualización</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen Original&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># No mostrar ejes</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gray_histogram</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histograma de Escala de Grises&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de Píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d0f1acece7b0a5f501d3c4f662edc442080c2ea316c362105e29a224647f26e2.png" src="_images/d0f1acece7b0a5f501d3c4f662edc442080c2ea316c362105e29a224647f26e2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/lihkir/Data/main/gt3rs.jpg&#39;</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>
<span class="n">image_bytes</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">image_bytes</span><span class="o">.</span><span class="n">read</span><span class="p">()),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">color_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imdecode</span><span class="p">(</span><span class="n">image_array</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_COLOR</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_histograms</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)):</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">calcHist</span><span class="p">([</span><span class="n">color_image</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">])</span>
    <span class="n">color_histograms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">color_image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen Original&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">color_histograms</span><span class="p">,</span> <span class="n">colors</span><span class="p">)):</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Canal </span><span class="si">{</span><span class="n">color</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogramas de Canales de Color&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de Píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aac3e9537fd3509408ac8a05f6ad2b5d27d52a0d04bc96929aceac1c14ec0394.png" src="_images/aac3e9537fd3509408ac8a05f6ad2b5d27d52a0d04bc96929aceac1c14ec0394.png" />
</div>
</div>
<ul class="simple">
<li><p>El gráfico anterior muestra el histograma de la imagen del coche. El eje <span class="math notranslate nohighlight">\(x\)</span> <em><strong>representa los valores de intensidad de color</strong></em>, que van de 0-255, mientras que el eje <span class="math notranslate nohighlight">\(y\)</span> <em><strong>muestra la frecuencia de aparición</strong></em>. El histograma revela que <em><strong>la intensidad de color máxima para los canales R, G y B se encuentra alrededor de 20, con un segundo pico cerca de 80</strong></em>.</p></li>
<li><p>La intensidad máxima lograda en torno a 20, está relacionada con el <em><strong>fondo de la imagen del auto, el cual es de tonos grises oscuros, muy cercanos en algunos casos a negro</strong></em>. Los otros valores máximos de los canales, alcanzados <em><strong>en torno a 80, indican que el color promedio del coche es gris</strong></em>.</p></li>
<li><p>Aquellos píxeles en torno a 150 logran alcanzar valores que sobresalen en el canal rojo en comparación con los otros canales, esto indica el <em><strong>color en salmón que aparecen en la puerta del GT3 RS y además en los rines</strong></em>.</p></li>
</ul>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">Color</span> <span class="pre">Gris</span> <span class="pre">en</span> <span class="pre">el</span> <span class="pre">Espacio</span> <span class="pre">RGB</span></code></strong></em></p>
<ul class="simple">
<li><p>En el espacio de color RGB, un <em><strong>color gris tiene valores iguales o muy similares en los tres canales (rojo, verde y azul)</strong></em>. Por ejemplo:</p>
<ul>
<li><p>Un <em><strong>gris medio</strong></em> puede ser representado como <em><strong>(128, 128, 128)</strong></em>.</p></li>
<li><p>Un <em><strong>gris claro</strong></em> podría ser <em><strong>(192, 192, 192)</strong></em>.</p></li>
<li><p>Un <em><strong>gris oscuro</strong></em> podría ser <em><strong>(64, 64, 64)</strong></em>.</p></li>
</ul>
</li>
</ul>
<p><em><strong><code class="docutils literal notranslate"><span class="pre">Representación</span> <span class="pre">del</span> <span class="pre">Color</span> <span class="pre">Salmón</span> <span class="pre">en</span> <span class="pre">RGB</span></code></strong></em></p>
<ul class="simple">
<li><p>Un ejemplo de valores RGB para el color salmón podría ser:</p>
<ul>
<li><p><em><strong>Salmón Claro</strong></em>: (255, 160, 122)</p></li>
<li><p><em><strong>Salmón Oscuro</strong></em>: (233, 150, 122)</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="deteccion-facial-con-opencv-y-cnn">
<h1>Detección Facial con OpenCV y CNN<a class="headerlink" href="#deteccion-facial-con-opencv-y-cnn" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>La <em><strong>detección facial</strong></em>, crucial en la visión por computadora, ha crecido notablemente recientemente. Este capítulo comienza con la <em><strong>detección facial y de características clave de Viola-Jones</strong></em>, avanzando hacia la <em><strong>detección avanzada de puntos clave y expresiones faciales mediante redes neuronales</strong></em>. Finaliza con la detección facial en 3D.</p></li>
<li><p>Temas del capítulo:</p>
<ul>
<li><p>Uso de <em><strong>AdaBoost de Viola-Jones</strong></em> y el <em><strong>clasificador Haar</strong></em> en cascada para <em><strong>reconocimiento facial</strong></em></p></li>
<li><p><em><strong>Predicción de puntos clave faciales</strong></em> con redes neuronales profundas</p></li>
<li><p><em><strong>Predicción de expresiones faciales</strong></em> con CNN</p></li>
<li><p><em><strong>Introducción a la detección facial en 3D</strong></em></p></li>
</ul>
</li>
</ul>
<section id="adaboost-de-viola-jones-y-clasificador-haar-cascade-para-el-reconocimiento-facial">
<h2>AdaBoost de Viola-Jones y clasificador Haar Cascade para el reconocimiento facial<a class="headerlink" href="#adaboost-de-viola-jones-y-clasificador-haar-cascade-para-el-reconocimiento-facial" title="Link to this heading">#</a></h2>
<div class="admonition-introduccion admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>En 2001, <em><strong>Paul Viola de Microsoft Research</strong></em> y <em><strong>Michael Jones de Mitsubishi Electric</strong></em> desarrollaron un innovador método para <em><strong>detectar rostros en imágenes, conocido como clasificador</strong></em> <a class="reference external" href="https://www.face-rec.org/algorithms/Boosting-Ensemble/16981346.pdf">Haar Cascade</a>. Este clasificador utiliza <em><strong>características de Haar, basadas en la diferencia de valores de píxeles en regiones rectangulares</strong></em>, para identificar partes específicas del rostro como la nariz y los ojos.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>El detector final incluye <em><strong>38 clasificadores en cascada con 6,060 características, entrenado con aproximadamente 4,916 imágenes de rostros y 9,500 imágenes sin rostros</strong></em>. Aunque el <em><strong>entrenamiento tomó varios meses, la detección es extremadamente rápida</strong></em>. Inicialmente, la imagen se convierte a <em><strong>escala de grises y se aplican técnicas de filtrado y segmentación para facilitar la detección</strong></em>. Las siguientes secciones explican cómo construir el clasificador Haar Cascade</p></li>
</ul>
</section>
<section id="full-code">
<h2>Full code<a class="headerlink" href="#full-code" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">haarcascade_path</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">haarcascades</span> <span class="o">+</span> <span class="s2">&quot;haarcascade_frontalface_default.xml&quot;</span>
<span class="n">eye_cascade_path</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">haarcascades</span> <span class="o">+</span> <span class="s2">&quot;haarcascade_eye.xml&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ruta del archivo haarcascade_frontalface_default.xml:&quot;</span><span class="p">,</span> <span class="n">haarcascade_path</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ruta del archivo haarcascade_eye.xml:&quot;</span><span class="p">,</span> <span class="n">eye_cascade_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ruta del archivo haarcascade_frontalface_default.xml: C:\Users\USER\miniconda3\envs\ml_tf\lib\site-packages\cv2\data\haarcascade_frontalface_default.xml
Ruta del archivo haarcascade_eye.xml: C:\Users\USER\miniconda3\envs\ml_tf\lib\site-packages\cv2\data\haarcascade_eye.xml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">face_cascade</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="n">haarcascade_path</span><span class="p">)</span>
<span class="n">eye_cascade</span>  <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CascadeClassifier</span><span class="p">(</span><span class="n">eye_cascade_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">detect_face</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    <span class="n">face_img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
  <span class="c1">#  face_rects = face_cascade.detectMultiScale(face_img)</span>
    <span class="n">face_rects</span> <span class="o">=</span> <span class="n">face_cascade</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">face_img</span><span class="p">,</span><span class="n">scaleFactor</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span><span class="n">minNeighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">face_rects</span><span class="p">:</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">face_img</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">face_img</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">detect_eye</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
    
    <span class="n">face_img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">eyes_rects</span> <span class="o">=</span> <span class="n">eye_cascade</span><span class="o">.</span><span class="n">detectMultiScale</span><span class="p">(</span><span class="n">face_img</span><span class="p">,</span><span class="n">scaleFactor</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span><span class="n">minNeighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">)</span> <span class="ow">in</span> <span class="n">eyes_rects</span><span class="p">:</span>
        <span class="n">cv2</span><span class="o">.</span><span class="n">rectangle</span><span class="p">(</span><span class="n">face_img</span><span class="p">,(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),(</span><span class="n">x</span><span class="o">+</span><span class="n">w</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">h</span><span class="p">),(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">face_img</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">ret</span><span class="p">,</span><span class="n">frame</span> <span class="o">=</span> <span class="n">cap</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">detect_face</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">detect_eye</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
   <span class="c1"># gray = cv2.cvtColor(frame,cv2.COLOR_BGR2GRAY)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="s1">&#39;video face detect&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">waitKey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">):</span>
        <span class="k">break</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cap</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
<span class="n">cv2</span><span class="o">.</span><span class="n">destroyAllWindows</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-center">
<img alt="_images/video_face_detect_withno_glasses.png" src="_images/video_face_detect_withno_glasses.png" />
</figure>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="aprendizaje-profundo-en-imagenes">
<h1>Aprendizaje Profundo en Imágenes<a class="headerlink" href="#aprendizaje-profundo-en-imagenes" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Introducción</p>
<ul class="simple">
<li><p>En este capítulo, se estudiará cómo la <em><strong>detección de bordes</strong></em> se utiliza para <em><strong>crear operaciones de convolución sobre volumen</strong></em> y cómo diferentes <em><strong>parámetros de convolución</strong></em>, tales como el tamaño del filtro, las dimensiones y el tipo de operación (convolución versus agrupación) <em><strong>afectan el volumen de convolución</strong></em> (ancho versus profundidad).</p></li>
<li><p>Este capítulo proporcionará una visión detallada de <em><strong>cómo una red neuronal interpreta una imagen</strong></em> y <em><strong>cómo utiliza esa visualización para clasificar imágenes</strong></em>. Comenzará construyendo su primera red neuronal y luego <em><strong>visualizará una imagen a medida que atraviesa sus diferentes capas</strong></em>. Después, comparará la <em><strong>precisión y visualización del modelo de red con una red avanzada como VGG 16 o Inception</strong></em>.</p></li>
<li><p>En este capítulo, se cubrirámn los siguientes temas:</p>
<ul>
<li><p>Comprender las CNN y sus parámetros</p></li>
<li><p>Optimización de parámetros de las CNN</p></li>
<li><p>Visualización de las capas de una red neuronal</p></li>
</ul>
</li>
</ul>
</div>
<section id="comprendiendo-las-redes-neuronales-convolucionales-cnn-y-sus-parametros">
<h2>Comprendiendo las Redes Neuronales Convolucionales (CNN) y sus Parámetros<a class="headerlink" href="#comprendiendo-las-redes-neuronales-convolucionales-cnn-y-sus-parametros" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Una <em><strong>Red Neuronal Convolucional (CNN)</strong></em> es una <em><strong>red autoaprendizaje que clasifica imágenes de manera similar a cómo nuestro cerebro aprende</strong></em>, observando imágenes de distintas clases. Las CNNs <em><strong>comprenden el contenido de una imagen aplicando filtrado de imágenes</strong></em> y procesando métodos con distintos tamaños de filtro, cantidad y operaciones no lineales. Estos <em><strong>filtros y operaciones se aplican a través de muchas capas</strong></em>, de modo que las <em><strong>dimensiones espaciales de cada capa subsecuente disminuyen mientras que sus profundidades aumentan</strong></em> durante el proceso de transformación de la imagen.</p></li>
</ul>
<ul>
<li><p>Para cada aplicación de filtrado, la profundidad del contenido aprendido aumenta. <em><strong>Este proceso comienza con la detección de bordes</strong></em>, seguido del <em><strong>reconocimiento de formas</strong></em>, y luego una <em><strong>colección de formas llamadas características</strong></em>, y así sucesivamente. Esto es análogo al cerebro humano en cuanto a cómo comprendemos la información. Por ejemplo, <em><strong>durante una prueba de comprensión lectora donde necesitamos responder catorce preguntas sobre un pasaje, cada pregunta puede considerarse como una clase que requiere información específica del pasaje</strong></em>:</p>
<figure class="align-center" id="ielts-reading-fig">
<a class="reference internal image-reference" href="_images/ielts_reading.jpg"><img alt="_images/ielts_reading.jpg" src="_images/ielts_reading.jpg" style="width: 400.0px; height: 502.8px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 82 </span><span class="caption-text">Fuente: IELTS reading test.</span><a class="headerlink" href="#ielts-reading-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Primero, <em><strong>leemos por encima todo el pasaje</strong></em>, es decir, <em><strong>la dimensión espacial es el pasaje completo y la profundidad (nuestra comprensión del pasaje) es baja, ya que solo lo hemos leído superficialmente</strong></em>.</p></li>
<li><p>Luego, <em><strong>leemos las preguntas para entender las características de cada clase (preguntas)</strong></em>, es decir, <em>lo que se debe buscar en el pasaje</em>. En una <em><strong>CNN, esto equivale a pensar en qué convoluciones y operaciones de <code class="docutils literal notranslate"><span class="pre">pooling</span></code> usar para extraer las características</strong></em>.</p></li>
<li><p>Después, <em><strong>leemos secciones específicas del pasaje para encontrar contenido similar a la clase y profundizamos en esas secciones</strong></em>. Aquí, la <em>dimensión espacial es baja, pero la profundidad es alta</em>. Repetimos este proceso dos o tres veces para responder todas las preguntas, <em>aumentando nuestra comprensión y enfocándonos en áreas específicas (reduciendo la dimensión) hasta tener una buena comprensión</em>. En una <em><strong>CNN, esto es equivalente a aumentar gradualmente la profundidad y reducir las dimensiones</strong></em>: la operación de <em>convolución cambia la profundidad</em> modificando el número de filtros; el <em><code class="docutils literal notranslate"><span class="pre">pooling</span></code> reduce las dimensiones</em>.</p></li>
<li><p>Para ahorrar tiempo, tendemos a <em><strong>omitir párrafos para encontrar pasajes relevantes que coincidan con la respuesta</strong></em>. En una <em><strong>CNN, esto es equivalente al <code class="docutils literal notranslate"><span class="pre">stride</span></code>, que reduce la dimensión, pero no cambia la profundidad</strong></em>.</p></li>
<li><p>El siguiente proceso es <em><strong>alinear mentalmente las respuestas con las preguntas</strong></em>. Aquí no profundizamos más; simplemente <em><strong>colocamos las preguntas y respuestas una junto a la otra para emparejarlas</strong></em>. En una <em><strong>CNN, esto equivale a aplanar y usar una capa completamente conectada</strong></em>.</p></li>
<li><p>Puede que tengamos <em><strong>información excesiva durante este proceso, que descartamos para quedarnos solo con la información relevante</strong></em> para las preguntas. En una <em><strong>CNN, esto equivale a <code class="docutils literal notranslate"><span class="pre">dropout</span></code></strong></em>.</p></li>
<li><p>La última fase es <em><strong>realizar el ejercicio de emparejar para responder las preguntas</strong></em>. En una <em><strong>CNN, esto equivale a la operación <code class="docutils literal notranslate"><span class="pre">softmax</span></code></strong></em>.|</p></li>
</ul>
</li>
</ul>
<div class="stretched-link admonition">
<p class="admonition-title">Filtrado y Procesamiento de Imagenes</p>
<ul class="simple">
<li><p>El método de <em><strong>filtrado y procesamiento de imágenes</strong></em> en una CNN consiste en <em><strong>realizar una variedad de tareas, todas llevadas a cabo mediante el uso de los siguientes componentes</strong></em>:</p>
<ul>
<li><p><em><strong>Convolución (Conv2D)</strong></em></p></li>
<li><p><em><strong>Convolución sobre volumen – filtro de 3 x 3</strong></em></p></li>
<li><p><em><strong>Convolución sobre volumen – filtro de 1 x 1</strong></em></p></li>
<li><p><em><strong>Pooling</strong></em></p></li>
<li><p><em><strong>Padding</strong></em></p></li>
<li><p><em><strong>Stride</strong></em></p></li>
<li><p><em><strong>Activación</strong></em></p></li>
<li><p><em><strong>Capa completamente conectada</strong></em></p></li>
<li><p><em><strong>Regularización</strong></em></p></li>
<li><p><em><strong>Dropout</strong></em></p></li>
<li><p><em><strong>Cambio de covarianza interno y normalización por lotes</strong></em></p></li>
<li><p><em><strong>Softmax</strong></em></p></li>
</ul>
</li>
<li><p>El siguiente diagrama ilustra una <em><strong>CNN y sus componentes</strong></em></p></li>
</ul>
</div>
<figure class="align-center" id="cnn-components-48x48x1img-fig">
<img alt="_images/cnn_components_48x48x1img.jpg" src="_images/cnn_components_48x48x1img.jpg" />
</figure>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<ul class="simple">
<li><p>Podemos interpretar la figura de la siguiente manera:</p>
<ul>
<li><p>Operación de <code class="docutils literal notranslate"><span class="pre">convolución</span></code> de 64 filtros de dimensión (5, 5) es aplicada a una imagen en escala de grises de ancho 48 y altura 48 para producir una salida de dimensiones 44x44x64</p></li>
<li><p>Operación <code class="docutils literal notranslate"><span class="pre">maxpooling</span></code> de filtros de dimensión (5, 5) con <code class="docutils literal notranslate"><span class="pre">stride</span></code> 2 es aplicada al input de dimensiones 44x44x64. Esto resulta en una reducción de la dimensión del output a 20x20x64</p></li>
<li><p>Una función de activación no lineal <code class="docutils literal notranslate"><span class="pre">ReLU</span></code> es aplicada después de la primera operación <code class="docutils literal notranslate"><span class="pre">Conv2D</span></code> y continua después de cada operación hasta la última capa <code class="docutils literal notranslate"><span class="pre">Dense</span></code></p></li>
</ul>
</li>
</ul>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "ml_tf"
        },
        kernelOptions: {
            name: "ml_tf",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ml_tf'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ann_model.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Redes Neuronales y Deep Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="practical_pca.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Análisis de Componentes Principales</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Deep Learning para Visión por Computadora</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion">Clasificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-o-localizacion-y-segmentacion">Detección o localización y segmentación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aprendizaje-de-similitud">Aprendizaje de Similitud</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#etiquetado-de-imagenes">Etiquetado de imágenes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-generativos">Modelos Generativos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-video">Análisis de Video</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#la-instalacion-de-paquetes-de-software">La instalación de paquetes de software</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-imagenes">Clasificación de imagenes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-del-modelo-mnist-en-tensorflow">Entrenamiento del modelo <code class="docutils literal notranslate"><span class="pre">MNIST</span></code> en <code class="docutils literal notranslate"><span class="pre">TensorFlow</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#las-bases-de-datos-mnist">Las bases de datos <code class="docutils literal notranslate"><span class="pre">MNIST</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-los-datos-mnist">Carga de los datos <code class="docutils literal notranslate"><span class="pre">MNIST</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamentos-de-vision-por-computadora">Fundamentos de Visión por Computadora</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-bordes-mediante-el-uso-de-hashing-de-imagenes-y-filtrado">Detección de bordes mediante el uso de hashing de imágenes y filtrado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-uso-de-un-filtro-bayer-para-la-formacion-de-patrones-de-color">El uso de un filtro Bayer para la formación de patrones de color</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creando-vector-de-imagen">Creando Vector de Imagen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformaciones-geometricas">Transformaciones geométricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#traslacion">Traslación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#escalado">Escalado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rotacion">Rotación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-homogenea">Transformación Homogénea</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convolucion-2d-y-filtro-lineal">Convolución 2D y Filtro Lineal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#suavizado-de-imagen">Suavizado de imagen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtros-lineales">Filtros Lineales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#el-filtro-kernel">El filtro Kernel</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-del-filtro">Aplicación del Filtro</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-gaussiano">Filtro Gaussiano</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-de-la-mediana">Filtro de la mediana</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtrado-de-imagenes-con-opencv">Filtrado de imágenes con OpenCV</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-bordes-basada-en-gradientes">Detección de bordes basada en gradientes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivadas-parciales-y-el-gradiente">Derivadas Parciales y el Gradiente</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derivadas-direccionales-y-mascaras-2d">Derivadas Direccionales y Máscaras 2D</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extraccion-de-caracteristicas-de-una-imagen">Extracción de características de una imagen</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-facial-con-opencv-y-cnn">Detección Facial con OpenCV y CNN</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaboost-de-viola-jones-y-clasificador-haar-cascade-para-el-reconocimiento-facial">AdaBoost de Viola-Jones y clasificador Haar Cascade para el reconocimiento facial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-code">Full code</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#aprendizaje-profundo-en-imagenes">Aprendizaje Profundo en Imágenes</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comprendiendo-las-redes-neuronales-convolucionales-cnn-y-sus-parametros">Comprendiendo las Redes Neuronales Convolucionales (CNN) y sus Parámetros</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Lihki Rubio, Ph.D.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>Lihki Rubio, Ph.D. All rights reserved.</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>